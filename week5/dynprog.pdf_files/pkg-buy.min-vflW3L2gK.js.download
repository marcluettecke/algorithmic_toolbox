define("modules/clean/react/payments/buy/components/buy_component",["require","exports","tslib","classnames","modules/core/notify","react","classnames","modules/core/browser","modules/core/i18n","modules/clean/react/payments/buy/components/plan/buy_plan","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/types/types","modules/clean/viewer","modules/clean/react/payments/buy/components/headline","modules/clean/react/payments/buy/components/navigation","modules/clean/react/payments/buy/components/footer"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),o=a.__importDefault(o),i=a.__importDefault(i),s=a.__importStar(s);var S,P=l.Loadable({loader:function(){return p.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/payments/buy/components/payments/sox_compliance_warning"],t,a)})).then(a.__importStar).then((function(e){return e.SOXComplianceBanner}))}))}});(function(e){e.Professional="PROFESSIONAL",e.Plus="PLUS"})(S||(S={}));var v=(function(t){function l(r){var i=t.call(this,r)||this;return i.renderCustomizedMsg=!1,i.logExperiments=function(){var e=i.props,t=e.experiments,a=e.currentStep,r=e.suggestedUser;1===a?(d.logVariantExposure("subgrowth_pro_buy_step1_cta_copy",t.subgrowthProBuyStep1CtaCopy),d.logVariantExposure("subgrowth_pro_buy_step_one_trial_messaging",t.subgrowthProBuyStepOneTrialMessaging)):2===a&&(d.logVariantExposure("subgrowth_pro_buy_step2_pricing_messaging",t.subgrowthProBuyStep2PricingMessaging),r&&d.logVariantExposure("subgrowth_buy_universal_preauth",t.subgrowthBuyUniversalPreauth))},i.redirectToPromo=function(){s.redirect(i.props.promoRedirect),n.Notify.success(u._("Great news! You’re eligible for a discount"))},i.redirectToTrial=function(e){return function(){s.redirect(e)}},i.headline=o.default.createRef(),i.checkIsSmartSyncUpsell(["V1","V2","V3"])?(i.renderCustomizedMsg=!0,p.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var t=e.SmartSyncUpsellTracker;i.tracker=new t(_.Viewer.get_viewer().get_users()[0].id)}))}))):"stsp"===s.get_uri().getQuery().oqa&&(i.renderCustomizedMsg=!0),i}return a.__extends(l,t),l.prototype.componentDidMount=function(){p.mark_time_to_interactive(),this.logExperiments()},l.prototype.componentDidUpdate=function(e,t){e.currentStep!==this.props.currentStep&&this.logExperiments()},Object.defineProperty(l.prototype,"ujProfessionalTrial",{get:function(){return"ON"===this.props.experiments.ujProfessionalTrial},enumerable:!0,configurable:!0}),l.prototype.renderHeadline=function(){var e=this.props,t=e.content,a=e.currentStep,r=e.productPlanType,n=e.showTrialVersion,i=e.showPlusTryRedesign,s=y.getPlanContentFromMap(t,r),c=n?s.trySubheadline:s.buySubheadline;this.renderCustomizedMsg&&(c=u._("You’re one step away from freeing up hard drive space with Smart Sync"));var l=t.purchaseHeadline;return i&&(l=t.trialHeadline),o.default.createElement(f.DropboxBuyHeadlineWeb,{expIsSimplifiedPlansOn:this.renderCustomizedMsg,forwardRef:this.headline,headlineText:1===a?t.chooseHeadline:l,subheadlineText:c})},l.prototype.checkIsSmartSyncUpsell=function(e){return"getSmartSync"===s.get_uri().getQuery().referrer&&e.includes(String(this.props.experiments.ujGetSmartSync))},l.prototype.hideSteps=function(){var e=this.props,t=e.currentStep,a=e.experiments,r=e.defaultPlan,n=e.showTrialVersion,o=e.showPlusTryRedesign,i=s.get_uri().getQuery();return!!("V1"===a.expMontanaOptimizationReroute||o||"V1"===a.proBizMve&&"1"===i.hs&&2===t&&"professional"===r&&n)||"one-license"===i._tk&&"ON"===a.ujOneLicense&&"ON"===a.ujProfessionalTrial&&"professional"===r&&n},l.prototype.currentStep=function(){var e=this.props,t=e.currentStep,a=e.experiments,r=e.stepClick;return o.default.createElement(g.DropboxBuyNavigationWeb,{currentStep:t,hideSteps:this.hideSteps()||!1,onStepClick:r,expIsSimplifiedPlansOn:this.renderCustomizedMsg,tracker:this.tracker,expUjOneLicense:a.ujOneLicense||""})},l.prototype.renderPlans=function(){var e=this,t=this.props,a=t.content,n=t.currentPlan,s=t.experiments,u=t.formData,l=t.hasPromo,p=t.planClick,d={Professional:y.getPlanContentFromMap(a,m.ProductPlanType.PROFESSIONAL),Plus:y.getPlanContentFromMap(a,m.ProductPlanType.PLUS)},_="professional"===n,f="plus"===n,g=function(t){var a=t.productPlanKey,r=t.showTrialVersion,n=m.ProductPlanType[a];return function(){return p(n,Boolean(r),e.headline.current||void 0)}},h="ON"===s.subgrowthProBuyFeaturesMobile,P="ON"===s.expMontanaMasterSwitch,v=r.default({"DropboxBuyPage-plansAndReasons":!0,grid__item:!0,"grid__item--medium--5-12":!0,"grid__item--large--1-3":!0,"DropboxBuyPage-plansAndReasons--showReasonsOnMobile":h}),b=r.default("buy-plan",{"buy-plan--montana":P}),C=function(e){var t=e.plan,a=e.onClick,r=e.secondaryClick,n=e.disabled,u=e.href,l=e.trialEndDate,p=e.boldFirstReason;return o.default.createElement("div",{className:v},o.default.createElement(c.BuyPlan,{plan:t,onClick:a,secondaryClick:r,classname:b,disabled:n,href:u,experiments:s,trialEndDate:l}),o.default.createElement("span",{className:"ax-visually-hidden"},t.included.title),o.default.createElement("ul",{className:"DropboxBuyPage__reasons",role:"list"},t.reasons.map((function(e,t){var a;return o.default.createElement("li",{className:i.default("DropboxBuyPage__reason",(a={},a["DropboxBuyPage__reason--bold"]=p&&0===t,a)),key:"reason-"+t},e.text)}))))};return o.default.createElement("section",{className:"DropboxBuyPage__plans grid__container"},o.default.createElement(C,{plan:d.Plus,onClick:l?this.redirectToPromo:g({productPlanKey:S.Plus}),disabled:!_&&f}),o.default.createElement("div",{className:"spacer grid__item--medium--1-24"}),f?o.default.createElement(C,{plan:d.Professional,href:"/account/plan?modal=plan&option=pro"}):this.ujProfessionalTrial?o.default.createElement(C,{plan:d.Professional,onClick:this.props.useRevenueApi?this.redirectToTrial(d.Professional.cta.trial_link):g({productPlanKey:S.Professional,showTrialVersion:!0}),secondaryClick:g({productPlanKey:S.Professional}),disabled:_,trialEndDate:u.trialEndDate.rawValue}):o.default.createElement(C,{plan:d.Professional,onClick:g({productPlanKey:S.Professional}),disabled:_}))},l.prototype.renderCheckOutForm=function(){var e=this.props,t=e.actions,a=e.checkoutFormProps,r=e.content,n=e.experiments,i=e.formData,s=e.pageState,u=e.pricingState,c=e.productPlanType,l=e.PurchaseFormComponent,p=e.showTrialVersion,d=e.updateHistory,_=e.useAUTaxInclusivePricing,f=e.showPlusTryRedesign,g=y.getPlanContentFromMap(r,c),h={monthlyPrice:g.priceMonthly.price,annualPriceAsMonthly:g.priceAnnual.priceAsMonthly,yearlyPrice:g.priceAnnual.price,yearlyWithoutSavings:g.priceAnnual.withoutSavings,yearlySavings:g.priceAnnual.savings},S=y.getPlanContentFromMap(r,m.ProductPlanType.PLUS),P=y.getPlanContentFromMap(r,m.ProductPlanType.PROFESSIONAL),v={plus:S.quota,professional:P.quota};return o.default.createElement(l,{actions:t,braintreeClientToken:a.braintreeClientToken,buyLink:g.cta.link,ccIframeUrl:a.ccIframeUrl,continueURI:a.continueURI,countryList:a.countryList,currencyToFormatMap:a.currencyToFormatMap,experiments:n,formData:i,idealBanks:a.idealBanks,iframeExperiments:a.iframeExperiments,includedFeaturesContent:g.included,locale:a.locale,localeNumberFormat:a.localeNumberFormat,pageState:s,paymentMethodMapper:a.paymentMethodMapper,planName:g.name,plansByType:r.plansByType,planTier:g.tier,planNamePrefixedWithDropbox:g.namePrefixedWithDropbox,productPlanType:c,pricingState:u,initialPricingStrings:u.subChangePlans?void 0:h,quotaStrings:v,updateHistory:d,trialLength:a.trialLength,taxNamesByCountry:a.taxNamesByCountry,userInfo:a.userInfo,showCpf:n.showCpf,showCpfName:n.showCpfName,showTrialVersion:p,useAUTaxInclusivePricing:_,submitFormSuccess:s.submitFormSuccess,showPlusTryRedesign:f})},l.prototype.renderFooter=function(){var e,t=this.props,a=t.currentStep,r=t.pageState.footerLinks;if(r&&r.length){var n=function(e){var t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)};e=r.map((function(e){return{section:n(e.section),links:e.links.filter((function(e){return e.href&&e.label})).map((function(e){return{href:e.href,label:n(e.label)}}))}}))}return o.default.createElement(h.DropboxBuyFooterWeb,{footerLinks:e,currentStep:a})},l.prototype.render=function(){var e=this.props,t=e.currentStep,a=e.SOXComplianceMessage,n=r.default({DropboxBuyPage__content:!0,grid__container:!0,"grid--x-left":!0});return o.default.createElement("main",{className:n},a&&o.default.createElement(P,{message:a}),this.renderHeadline(),this.currentStep(),1===t&&this.renderPlans(),o.default.createElement("section",{className:"DropboxBuyPage__form grid__container"},2===t&&this.renderCheckOutForm()),this.renderFooter())},l})(o.default.Component);t.BuyComponent=v})),define("modules/clean/react/payments/buy/components/dropbox_buy_page",["require","exports","tslib","modules/clean/ajax","modules/core/exception","modules/core/notify","react","modules/clean/analytics","modules/core/browser","modules/core/uri","modules/clean/react/async/loadable","modules/clean/payments/skus/pricing_data","modules/clean/payments/skus/subscription_change_plan","modules/clean/web_timing_logger","modules/clean/stormcrow/stormcrow_exposure_logger","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/web_timing_logger","modules/clean/react/payments/common/adapters/setup_cash","modules/clean/react/payments/buy/state/pro_store_creator","modules/clean/react/payments/buy/actions/buy_actions_creator","modules/clean/react/payments/buy/reducers/reducers","modules/clean/react/payments/buy/types/types","modules/clean/viewer","modules/clean/react/payments/buy/components/buy_component"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h,S,P,v,b,C,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importStar(n),i=a.__importDefault(i),u=a.__importStar(u),g=a.__importStar(g);var F=l.Loadable({loader:function(){return a.__awaiter(void 0,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,a){e(["modules/clean/react/payments/pro/server_view_components/pro_try_server_view"],t,a)})).then(a.__importStar)];case 1:return[2,t.sent().ProTryServerView]}}))}))},loading:i.default.createElement("div",null)}),w=l.Loadable({loader:function(){return m.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/payments/buy/components/buy_purchase_form"],t,a)})).then(a.__importStar).then((function(e){return e.BuyPurchaseForm}))}))}}),E=(function(t){function l(r){var n,o=t.call(this,r)||this;o.isInPlusTryRedesignExp=function(){var e=o.props,t=e.experiments,a=e.showTrialVersion;return o.getProductPlanType()===f.ProductPlanType.PLUS&&!!a&&a&&"V1"===t.actpaPlusTryRedesign},o.planClick=function(e,t,a){void 0===t&&(t=!1);var r={currentStep:2,productPlanType:e,showTrialVersion:t},n=o.getStoreProps(r);Promise.resolve(o.actions.updateState(n)).then((function(){window.scrollTo(0,0),o.updateHistory(2,e,void 0,t),a&&a.focus()})),s.ProEventsLogger.log(s.ProEventNames.BUY_TRY_PAGE_CHECKOUT,{type:"SelectPlan",productPlanType:e,showTrialVersion:t},void 0,o.props.showServerViewVersion)},o.stepClick=function(){Promise.resolve(o.actions.updateCurrentPage(1,o.state.navState.productPlanType,o.state.navState.showTrialVersion)).then((function(){window.scrollTo(0,0),o.updateHistory(1,o.state.navState.productPlanType,void 0,o.state.navState.showTrialVersion)}))},o.updateHistory=function(e,t,a,r){void 0===r&&(r=!1);var n=o.props,i=n.showServerViewVersion,s=n.experiments,l=c.URI.parse(u.get_href()).getQuery(),p="/buy",d="buy";if(2===e){var m=b.getPlanContentFromMap(o.contentForStep,t),y=t===f.ProductPlanType.PLUS?"plus":"professional";r?(p=m.cta.trial_link||"",d="try_"+y):(p=m.cta.link,d="buy_"+y)}i&&(p="/pro/try_server_view",d+="_server_view"),a||_.ProWebActivityLogger.log(d,p,l),a&&"V1"===s.expMontanaOptimizationReroute&&_.ProWebActivityLogger.log(d,p,l),_.UXAnalyticsLogger.log("page_view",{page:d});var g=c.URI.parse(p).setQuery(l).toString();a?window.history.replaceState(o.state,document.title,g):window.history.pushState(o.state,document.title,g)},o.navAction=function(e){if(e.state&&e.state.navState){var t=o.getStoreProps(e.state.navState);o.actions.updateState(t)}};var i=r.checkoutFormProps,l=r.webTimingLoggerServerContext;h.setupCash(i.localeNumberFormat,i.currencyToFormatMap),l&&g.initialize_module(a.__assign({log_time_to_interactive:!0,log_time_to_view:!0,ttv_at_dom_interactive:!0,tti_at_dom_interactive:!0},l));var p=o.getStoreProps();return o.store=S.configureStore(p,v.proBuyReducer),o.state=o.store.getState(),o.store.subscribe((function(){o.setState((function(){return o.store.getState()}))})),o.checkIsSmartSyncUpsell(["V1","V2","V3"])&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var t=e.SmartSyncUpsellTracker;o.tracker=new t(C.Viewer.get_viewer().get_users()[0].id)}))})),(null===(n=o.state.pageState.marketingTracker)||void 0===n?void 0:n.initData)&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/marketing_tracker"],t,a)})).then(a.__importStar).then((function(e){var t,a=e.MarketingTracker;(null===(t=o.state.pageState.marketingTracker)||void 0===t?void 0:t.initData)&&a.push(o.state.pageState.marketingTracker.initData)}))})),o}return a.__extends(l,t),l.prototype.getStoreProps=function(e){var t=this.props,a=t.checkoutFormProps,r=t.requestId,n=t.showTrialVersion,o=t.suggestedUser,i=t.experiments,s=t.preauthUser,u=t.showServerViewVersion,c=t.useRevenueApi,l=t.marketingTracker,p=t.content,d=e?e.productPlanType:this.getProductPlanType(),m=e||{currentStep:this.getCurrentStep(),productPlanType:this.getProductPlanType(),showTrialVersion:!!n},_=!1;return d!==f.ProductPlanType.PLUS||m.showTrialVersion||(i.subgrowthProBuyQuotaSwitchTrial&&["CONTROL","V1"].includes(i.subgrowthProBuyQuotaSwitchTrial)&&y.logVariantExposure("subgrowth_pro_buy_quota_switch_trial",i.subgrowthProBuyQuotaSwitchTrial),"V1"!==i.subgrowthProBuyQuotaSwitchTrial&&"V1"!==i.expMontanaOptimizationReroute||(_=!0)),{autocompleteForm:a.autocompleteForm,countryCode:a.countryCode,vat:a.vat,locale:a.locale,userInfo:a.userInfo,trialLength:a.trialLength,serializedPaymentFormSpec:a.serializedPaymentFormSpec,serializedSubChangePlans:void 0,baseSubChangePlans:this.state?this.state.pricingState.baseSubChangePlans:void 0,productPlanType:d,isServerView:u?"ON":"OFF",navState:m,showTrialVersion:m.showTrialVersion,suggestedUser:o,preauthUser:s,showPlanSwitchRadios:_,footerLinks:this.state?this.state.pageState.footerLinks:void 0,optimizeCpf:"V1"===i.subgrowthProBuyBrCpfCollectionOptimization,requestId:r,paymentFormErrorsExperiment:i.paymentFormErrorsExperiment,showCpf:i.showCpf,psd2AddressFields:i.psd2AddressFields,useRevenueApi:c,marketingTracker:l,plansContent:p.plansByType}},Object.defineProperty(l.prototype,"actions",{get:function(){return P.bindProBuyActions(this.store)},enumerable:!0,configurable:!0}),l.prototype.checkIsSmartSyncUpsell=function(e){return"getSmartSync"===u.get_uri().getQuery().referrer&&e.includes(String(this.props.experiments.ujGetSmartSync))},l.prototype.getCurrentStep=function(){return this.props.defaultPlan?2:1},l.prototype.getProductPlanType=function(){var e=this.props.currentPlan;return"plus"===e||"professional"===e?f.ProductPlanType.PROFESSIONAL:this.props.defaultPlan&&"professional"===this.props.defaultPlan?f.ProductPlanType.PROFESSIONAL:f.ProductPlanType.PLUS},Object.defineProperty(l.prototype,"contentForStep",{get:function(){return 1===this.state.navState.currentStep?this.props.content:a.__assign(a.__assign({},this.props.content),{plansByType:this.state.pageState.plansContent})},enumerable:!0,configurable:!0}),l.prototype.componentDidMount=function(){var t=this,i=this.state.pageState.useRevenueApi;this.updateHistory(this.state.navState.currentStep,this.state.navState.productPlanType,!0,this.state.navState.showTrialVersion),window.addEventListener("popstate",this.navAction);for(var s=document.querySelectorAll(".dws-preloader"),u=0;u<s.length;u++){var c=s[u];c.parentNode&&c.parentNode.removeChild(c)}r.WebRequest({url:"/buy/footer_links",type:"GET",success:function(e){var a=JSON.parse(e);t.actions.setFooterLinks(a)}});var l=this.props.showServerViewVersion?"buy_server_view":"buy";r.SilentBackgroundRequest({url:"/growth/log_visit_ajax",type:"POST",data:a.__assign({endpoint:l,log_preauth:!0,additional_preauth_types:"preauth_pro_upgrade"},this.props.loggingProps)}),i||r.WebRequest({url:"/pro/ajax_fetch_sub_change_plans",type:"POST",success:function(e){var a=JSON.parse(e);if(0===a.length)o.Notify.error(p.PricingDataException.notifyErrorMessagePersonal,20),n.reportException({err:new Error("/pro/ajax_fetch_sub_change_plans returned 0 Subscription Change Plans"),severity:n.SEVERITY.NONCRITICAL});else{var r=a.map((function(e){return d.SubscriptionChangePlan.deserialize(e)}));t.actions.loadSubChangePlans(r)}},error:function(e,t,a){if(0!==e.status){o.Notify.error(p.PricingDataException.notifyErrorMessagePersonal,20);var r="/pro/ajax_fetch_sub_change_plans failed to return Subscription Change Plans (status: "+e.status+")";n.reportException({err:new Error(r),severity:n.SEVERITY.CRITICAL})}}}),this.checkIsSmartSyncUpsell(["V2","V3"])&&m.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var a=e.SmartSyncUpsellActions;t.tracker.track(a.SMARTSYNC_UPSELLS_RENDER_TRY_PRO)}))}))},l.prototype.componentWillUnmount=function(){window.removeEventListener("popstate",this.navAction)},l.prototype.render=function(){var e=this.props,t=e.checkoutFormProps,r=e.content.purchaseHeadline,n=e.currentPlan,o=e.defaultPlan,s=e.experiments,u=e.hasPromo,c=e.promoRedirect,l=e.PurchaseFormComponent,p=e.showServerViewVersion,d=e.SOXComplianceMessage,m=e.suggestedUser,y=e.trademarks,_=e.useAUTaxInclusivePricing,f=this.state,g=f.navState,h=g.currentStep,S=g.productPlanType,P=g.showTrialVersion,v=f.formData,C=f.pageState,w=f.pricingState,E=this.state.pageState,N=E.useRevenueApi,k=E.plansContent,x={actions:this.actions,experiments:s,formData:v,pageState:C,plansByType:k,productPlanType:S,showTrialVersion:P,SOXComplianceMessage:d,useRevenueApi:N};if(p){var A=b.getPlanContentFromMap(this.contentForStep,S),V=a.__assign(a.__assign({},x),{ccIframeUrl:t.ccIframeUrl,continueURI:t.continueURI,countryList:t.countryList,currentPlanContent:A,currentTransitionPrices:w.currentTransitionPrices,displayPrices:w.displayPrices,headlineText:r,idealBanks:t.idealBanks,iframeExperiments:t.iframeExperiments,loadingPrices:w.loadingPrices,locale:t.locale,showCpf:s.showCpf,showCpfName:s.showCpfName,submitFormSuccess:C.submitFormSuccess,taxNamesByCountry:t.taxNamesByCountry,useAUTaxInclusivePricing:_||!1,userInfo:t.userInfo,requestId:this.props.requestId});return i.default.createElement(F,a.__assign({},V))}var U=a.__assign(a.__assign({},x),{checkoutFormProps:t,content:this.contentForStep,currentStep:h,currentPlan:n,defaultPlan:o,hasPromo:u,planClick:this.planClick,pricingState:w,promoRedirect:c,PurchaseFormComponent:l,stepClick:this.stepClick,suggestedUser:m,trademarks:y,updateHistory:this.updateHistory,useAUTaxInclusivePricing:_,showPlusTryRedesign:this.isInPlusTryRedesignExp()});return i.default.createElement(T.BuyComponent,a.__assign({},U))},l.defaultProps={PurchaseFormComponent:w},l})(i.default.Component);t.DropboxBuyPage=E,t.RootComponent=E})),define("modules/clean/react/payments/buy/components/dropbox_buy_checkout",["require","exports","tslib","react","modules/clean/react/payments/buy/components/buy_purchase_form","modules/clean/react/payments/buy/components/dropbox_buy_page"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return r.default.createElement(o.DropboxBuyPage,a.__assign({PurchaseFormComponent:n.BuyPurchaseForm},this.props))},t})((r=a.__importDefault(r)).default.Component);t.DropboxBuyPage=i})),define("modules/clean/react/payments/buy/components/headline",["require","exports","tslib","classnames","react"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),t.DropboxBuyHeadlineWeb=function(e){var t=e.expIsSimplifiedPlansOn,a=e.forwardRef,o=e.headlineText,i=e.subheadlineText,s=r.default({DropboxBuyPage__headline:!0,grid__container:!0,DropboxBuyPage__headline__smartsync:t}),u=r.default({DropboxBuyPage__subheadline:!0,grid__container:!0}),c=i?n.default.createElement("h2",{className:u},i):null;return n.default.createElement(n.default.Fragment,null,n.default.createElement("h1",{className:s,tabIndex:-1,ref:a},o),c)}})),define("modules/clean/react/payments/buy/components/footer",["require","exports","tslib","react","modules/clean/web_timing_logger","modules/clean/react/async/loadable"],(function(e,t,a,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r);var i=o.Loadable({loader:function(){return n.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/rebrand/elements/rebrand_arbor_footer_component"],t,a)})).then(a.__importStar).then((function(e){return e.RebrandArborMinimalFooterComponent}))}))}}),s=o.Loadable({loader:function(){return n.waitForTTI().then((function(){return new Promise((function(t,a){e(["modules/clean/react/rebrand/elements/rebrand_arbor_footer_component"],t,a)})).then(a.__importStar).then((function(e){return e.RebrandArborFooterComponent}))}))}});t.DropboxBuyFooterWeb=function(e){var t=e.footerLinks;return 1!==e.currentStep?r.default.createElement(i,{localeSelectorWithoutCss:!0}):t&&t.length?r.default.createElement(s,{backgroundColor:"white",textColor:"black",content:t,localeSelectorWithoutCss:!0}):null}})),define("modules/clean/react/payments/buy/components/navigation",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/analytics","modules/clean/web_timing_logger"],(function(e,t,a,r,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),t.DropboxBuyNavigationWeb=function(t){var u=[],c=t.currentStep;if(t.expIsSimplifiedPlansOn){return n.default.createElement("a",{href:"/plans",onClick:function(){s.waitForTTI().then((function(){new Promise((function(t,a){e(["modules/clean/growth/smartsync_upsell/smartsync_upsell_tracker"],t,a)})).then(a.__importStar).then((function(e){var a=e.SmartSyncUpsellActions;t.tracker.track(a.SMARTSYNC_UPSELLS_ALL_PLANS)}))}))},className:"DropboxBuyPage__allplans"},o._("See all plans"))}if(t.hideSteps)"ON"===t.expUjOneLicense&&i.IntentLogger.log("pro_try_buy_page_steps_hidden",{module:"one_license",version:"V1"});else{u=[1,2].map((function(e){var a=r.default({DropboxBuyPage__step:!0,"DropboxBuyPage__step--currentStep":e===c,"DropboxBuyPage__step--clickable":1===e&&2===c});return 2===c&&1===e?n.default.createElement("button",{className:a,key:"step-"+e,onClick:t.onStepClick},o.intl.formatMessage(o._("Step %(step)s"),{step:e})):n.default.createElement("span",{className:a,key:"step-"+e},o.intl.formatMessage(o._("Step %(step)s"),{step:e}))}))}var l=r.default({DropboxBuyPage__steps:!0,grid__container:!0}),p=o.intl.formatMessage(o._("Current step is %(current_step)s of 2"),{current_step:c});return n.default.createElement("div",{className:l},n.default.createElement("span",{className:"ax-visually-hidden"},p),n.default.createElement("span",{"aria-hidden":"true"},u))}})),define("modules/clean/react/payments/buy/components/plan/buy_plan",["require","exports","tslib","classnames","react","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/react/css","modules/clean/react/payments/buy/types/types","modules/clean/react/rebrand/elements/rebrand_buttons","modules/clean/react/payments/buy/components/plan/plan_card","modules/clean/react/tooltip","spectrum-arbor/atoms/arbor_copy","spectrum-arbor/atoms/arbor_headline"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),n=a.__importDefault(n),i=a.__importStar(i);var y=(function(e){function t(t){var a=e.call(this,t)||this;return a.state={namespace:"BuyPlan"},a}return a.__extends(t,e),t.prototype.isEligibleForTrialByTier=function(e){var t=this.props.experiments;if(!t)return!1;switch(e){case u.BuyPagePlanTiers.PROFESSIONAL:return"ON"===t.ujProfessionalTrial;default:return!1}},t.prototype.getPricingStrings=function(){var e,t,a,r=this.props.plan,i=r.priceMonthly,s=r.priceAnnual,u=r.gstIncluded;if(u){var c=o._("%(price)s / %(duration)s%(line_break)s(%(tax_string)s)");e=o.intl.formatMessage(c,{price:s.priceAsMonthly,duration:i.duration,tax_string:u,line_break:"\n"}),a=o.intl.formatMessage(c,{price:s.priceAsMonthly,duration:i.duration,tax_string:u,line_break:n.default.createElement("br",null)}),t=o.intl.formatMessage(o._("%(price)s per %(duration)s. %(tax_string)s"),{price:s.priceAsMonthly,duration:i.duration,tax_string:u})}else a=e=o.intl.formatMessage(o._("%(price)s / %(duration)s"),{price:s.priceAsMonthly,duration:i.duration}),t=o.intl.formatMessage(o._("%(price)s per %(duration)s"),{price:s.priceAsMonthly,duration:i.duration});return{primaryPrice:e,primaryPriceRichText:a,primaryPriceAx:t,secondaryPrice:o.intl.formatMessage(o._("%(price)s / %(duration)s (save %(savings)s)"),{price:s.price,duration:s.duration,savings:s.savings}),secondaryPriceAx:o.intl.formatMessage(o._("%(price)s per %(duration)s. Save %(savings)s"),{price:s.price,duration:s.duration,savings:s.savings})}},t.prototype.renderCTA=function(){var e,t,i,s=this.props,u=s.secondaryClick,l=s.plan,p=s.onClick,d=s.disabled,m=s.href,y=this.state.namespace,_={className:y+"__cta",importance:"primary",size:"medium",disabled:d};if(p){var f=d?o.intl.formatMessage(o._("%(plan_name)s is your current plan"),{plan_name:l.name}):o.intl.formatMessage(o._("Select Dropbox %(plan_name)s"),{plan_name:l.name}),g=a.__assign({onClick:p,type:"button",ariaLabel:f},_);t=n.default.createElement(c.RebrandButton,a.__assign({},g),d?o._("Your current plan"):l.cta.text)}else if(m){var h=a.__assign({href:m},_);t=n.default.createElement(c.RebrandButtonAnchor,a.__assign({},h),l.cta.text)}if(this.isEligibleForTrialByTier(l.tier)&&u){var S=r.default(y+"__secondary-cta","button-as-link"),P=o.intl.formatMessage(o._("Or buy %(plan)s now"),{plan:l.namePrefixedWithDropbox});i=n.default.createElement("button",{className:S,onClick:u},P)}var v=r.default(y+"__cta-container",((e={})[y+"__cta-container__extra-padding"]=!i,e));return n.default.createElement("div",{className:v},t,i)},t.prototype.componentDidMount=function(){i.mark_time_to_interactive()},t.prototype.render=function(){var e,t=this.state.namespace,a=this.props,r=a.experiments,i=a.hideDivider,s=a.plan,c=a.showAnnualPrice,y=a.trialEndDate,_=this.getPricingStrings(),f=s.name,g=c?_.secondaryPrice:"",h="blue";if(s.tier===u.BuyPagePlanTiers.PLUS&&(h="black"),r&&"V1"===r.subgrowthProBuyStepOneTrialMessaging&&s.tier===u.BuyPagePlanTiers.PROFESSIONAL&&y){var S=o.intl.formatMessage(o._("Cancel anytime before %(date)s, and you won’t be charged. We’ll remind you via email before then."),{date:y}),P=n.default.createElement(p.Tooltip,{tooltip_classname:"info__tooltip",position:p.TooltipPosition.BOTTOM,tooltip_contents:S,is_focusable:!0},n.default.createElement("button",{className:"info__tooltip-target",tabIndex:-1,"aria-label":o._("More information")}));e=n.default.createElement("div",{className:"plan-card__content__subheader--primary"},n.default.createElement("h4",{className:"plan-card__content__subheader"},n.default.createElement("span",{className:"plan-card__content__subheader--strike","aria-hidden":"true"},_.primaryPriceRichText),n.default.createElement("span",{className:"plan-card__content__subheader--green"},o._("Try FREE"))),P)}else e=n.default.createElement(n.default.Fragment,null,n.default.createElement(m.ArborHeadline,{"aria-hidden":"true",className:"plan-card__content__subheader--primary plan-card__content__subheader--no-margin",tag:"h4"},_.primaryPriceRichText),n.default.createElement("span",{className:"ax-visually-hidden"},_.primaryPrice),n.default.createElement(d.ArborCopy,{tag:"p",size:"small",color:"shark",marginBottomSize:"medium",marginTopSize:"none"},o._("when billed yearly")));return n.default.createElement(l.PlanCard,{classname:t+" "+t+"__"+f+" "+this.props.classname,title:f,planColor:h,hideDivider:i,primarySubheader:e,secondarySubheader:g,description:s.description},this.renderCTA())},t.defaultProps={showAnnualPrice:!1},t})(n.default.Component);t.BuyPlan=s.requireCssWithComponent(y,["/static/css/buy/components/buy_plan-vflYnKeOx.css","/static/js/spectrum-arbor/index.web-vfl1BIK7j.css"])})),define("modules/clean/react/payments/buy/components/plan/plan_card",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","modules/clean/web_timing_logger"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importDefault(r),i=a.__importStar(i);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){i.mark_time_to_interactive()},t.prototype.subheader=function(e,t){if(void 0===e&&(e=""),e)return"string"==typeof e?r.default.createElement("div",null,r.default.createElement("h4",{className:"plan-card__content__subheader"+t,"aria-hidden":"true"},n.intl.formatMessage(e,{line_break:r.default.createElement("br",null)})),r.default.createElement("span",{className:"ax-visually-hidden"},e)):r.default.createElement("div",null,e)},t.prototype.render=function(){var e=this.props,t=e.classname,a=e.planColor,n=e.title,o=e.primarySubheader,i=e.secondarySubheader,s=e.description,u=e.hideDivider;return r.default.createElement("section",{className:t+" plan-card"},r.default.createElement("div",{className:"plan-card__card-top--"+a}),r.default.createElement("article",{className:"plan-card__content"},r.default.createElement("h2",{className:"plan-card__content__title"},n),this.subheader(o,"--primary"),!u&&r.default.createElement("hr",{"aria-hidden":"true",className:"plan-card__content__divider"}),this.subheader(i,"--secondary"),r.default.createElement("p",{className:"plan-card__content__description"},s),this.props.children))},t})(r.default.PureComponent);t.PlanCard=o.requireCssWithComponent(s,["/static/css/growth_pages/plans/plan_card-vflpaOLUr.css"])})),define("modules/clean/react/payments/common/middleware/pro_buy_logger",["require","exports","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proBuyLogger=function(e){var t,o,i,s,u,c=["UpdateFirstName","UpdateLastName","UpdateEmail","UpdatePassword","UpdateZipCode","UpdateAccountHolderName","UpdateIBAN"];return function(l){return function(p){try{var d=l(p),m=p.type,y=e.getState(),_=y.pageState,f=y.pricingState,g=y.formData,h=y.navState,S=void 0;if(-1!==c.indexOf(m)&&o===m)return d;if("UpdateTransitionsStart"===m?t=(new Date).getTime():"UpdateTransitionsSuccess"!==m&&"UpdateTransitionsError"!==m||(S=(((new Date).getTime()-t)/1e3).toFixed(1)),"UpdateSelectedUser"===m||"ToggleNewAccount"===m)return d;var P={type:m,submitButtonState:_.submitting||f.loadingPrices?"disabled":"enabled"};if(void 0!==S&&(P.roundtrip=S),"UpdateSchedule"===m){var v="Unknown";g.scheduleId.rawValue===r.ScheduleId.MONTHLY?v="SelectMonthly":g.scheduleId.rawValue===r.ScheduleId.YEARLY&&(v="SelectYearly"),P.event=v}else if("UpdatePaymentMethod"===m){var b="Unknown";g.paymentMethod.rawValue===n.PaymentMethod.CreditCard?b="SelectCredit":g.paymentMethod.rawValue===n.PaymentMethod.PayPal?b="SelectPaypal":g.paymentMethod.rawValue===n.PaymentMethod.DirectDeposit?b="SelectDebit":g.paymentMethod.rawValue===n.PaymentMethod.Ideal&&(b="SelectIdeal"),P.event=b}else if("UpdateNonce"===m){var C=!1,T=g.nonce,F=T.isCCNValid,w=T.isCCodeValid,E=T.isCCExpValid;if(null!==i&&null!==u&&null!==s&&i===F&&u===w&&s===E&&(C=!0),i=F,u=w,s=E,C)return d;P.UpdateCC=F?"Valid":"Invalid",P.UpdateCVV=w?"Valid":"Invalid",P.UpdateExp=E?"Valid":"Invalid",o=m}return g.productPlanType.rawValue&&(P.productPlanType=g.productPlanType.rawValue,P.showTrialVersion=h&&h.showTrialVersion?"true":"false"),a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT,P,void 0,_.isServerView),-1!==c.indexOf(m)&&(o=m),d}catch(t){_=e.getState().pageState;throw a.ProEventsLogger.log(a.ProEventNames.BUY_TRY_PAGE_CHECKOUT_CRASH,{action:p.type,error:t.stack||t.toString()},void 0,_.isServerView),t}}}}})),define("modules/clean/react/payments/buy/actions/buy_actions_creator",["require","exports","tslib","redux","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importStar(n),o=a.__importStar(o),i=a.__importStar(i),t.bindProBuyActions=function(e){return r.bindActionCreators(a.__assign(a.__assign({},t.SHARED_FORM_ACTIONS),{setFooterLinks:n.setFooterLinks,loadSubChangePlans:n.loadSubChangePlans,toggleExistingAccount:n.toggleSignInModal,updateHistory:n.updateHistory,updateSelectedPlan:n.updateSelectedPlan,updateState:n.updateState,openSurvey:n.openSurvey,cancelSurvey:n.cancelSurvey,submitSurvey:n.submitSurvey}),e.dispatch)},t.SHARED_FORM_ACTIONS={updatePhone:i.updatePhone,blurPhone:i.blurPhone,updateCity:i.updateCity,blurCity:i.blurCity,updateName:i.updateName,blurName:i.blurName,updateAddress:i.updateAddress,blurAddress:i.blurAddress,showFormFieldErrors:i.showFormFieldErrors,submitCaptcha:i.submitCaptcha,submitProBuyForm:o.submitProBuyFormToServer,updateNonce:i.updateNonce,updatePayPalNonce:i.updatePayPalNonce,blurCCField:i.blurCCField,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,toggleNewAccount:o.toggleNewAccount,updateSelectedUser:o.updateSelectedUser,updateCurrentPage:n.updateCurrentPage,updateFirstName:i.updateFirstName,updateLastName:i.updateLastName,updateEmail:i.updateEmail,updatePassword:i.updatePassword,updateSchedule:o.updateSchedule,updateProductPlantype:o.updateProductPlanType,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:o.updateCountryCode,updateZipCode:o.updateZipCode,blurZipCode:i.blurZipCode,updateVat:o.updateVat,blurVat:i.blurVat,updateCpf:i.updateCpf,blurCpf:i.blurCpf,updateCpfName:i.updateCpfName,updateAccountHolderName:i.updateAccountHolderName,blurAccountHolderName:i.blurAccountHolderName,updateIBAN:i.updateIBAN,blurIBAN:i.blurIBAN,updateMandateSigned:i.updateMandateSigned,updateIdealBank:o.updateIdealBank,updateTermsAndService:i.updateTermsAndService,updateEVH:o.updateEVH}})),define("modules/clean/react/payments/buy/actions/buy_form_actions",["require","exports","tslib","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/core/exception","modules/clean/react/payments/buy/actions/pricing_actions","modules/core/notify","modules/clean/web_register_logging_data","modules/clean/payments/skus/pricing_data","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/helpers/preauth","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m){"use strict";function y(e,t,a,r,o,i,s,u,c,l){void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===u&&(u=!0),void 0===c&&(c=!1),void 0===l&&(l="OFF");var p=e.countryCode.formattedValue,d=["scheduleId","paymentMethod","countryCode"];return s||d.push("termsAndService"),c&&(a=!0,d.push("selectedUser")),a||d.push("firstName","lastName","email","password"),t.allow_zip_code_for_country(p)&&d.push("zipCode"),t.should_show_vat_for_country(p)&&""!==e.vat.formattedValue&&d.push("vat"),o&&t.should_require_cpf(p,e.paymentMethod.formattedValue)&&(d.push("cpf"),i&&d.push("cpfName")),t.showPSD2FieldsToUser(e.paymentMethod.formattedValue,p,r)&&d.push("name","city","address"),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(d.push("nonce"),d.push("adyenEncryptedCard"),d.push("encryptedCardForNetworkToken"),d.push("browserInfo"),d.push("threeDsData"),u&&d.push("bin")):e.paymentMethod.formattedValue===n.PaymentMethod.PayPal?"ON"===l&&d.push("payPalNonce"):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?d.push("accountHolderName","iban","mandateSigned"):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal&&d.push("idealBankId","idealBankName"),d}function _(e){var t=e.additionalData,a=void 0===t?{}:t,n=e.allowSubmitWithoutTOS,o=e.captchaComponentRef,s=e.handle3DsMessage,c=e.enableBinRouting,p=e.prepareForSubmission,_=e.trigger,f=e.url,h=e.showCpf,S=void 0!==h&&h,P=e.showCpfName,v=void 0!==P&&P,b=e.useSelectedUser,C=void 0!==b&&b,T=e.psd2AddressFields,F=void 0!==T&&T,w=e.subChangePlansIgnoreRevenueAPI,E=void 0===w?void 0:w,N=e.webPlusDirect,k=void 0!==N&&N,x=e.paymentPayPalV2Flow,A=void 0===x?"OFF":x;return function(e,t){var h,P=t(),b=P.formData,T=P.pageState.paymentFormSpec,w=P.pageState.existingAccountShowing,N=P.pricingState,x=P.pageState.useRevenueApi,V=P.pricingState.subChangePlans;if(E&&(V=E,x=!1),x){var U=b.scheduleId.formattedValue;a.schedule_id=U.toString()}if(V&&!x){var I=b.scheduleId.formattedValue,D=b.evh.rawValue,R=V.filter((function(e){return!!e.finalSubState.plan&&(e.finalSubState.plan.billingSchedule.id===I&&!!e.finalSubState.addons.skus.length===D)})).pop();if(R){if(R.finalSubState.planSku.productType!==b.productPlanType.rawValue)return u.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20),void i.reportException({err:new Error("Intended product type to purchase does not match subscription change plan"),severity:i.SEVERITY.CRITICAL});if((h=R.tvm)&&N.revenueApiPrice)if(h.getTotalPrice().formatCurrency(2)!==N.revenueApiPrice)return u.Notify.error(l.PricingDataException.notifyErrorMessagePersonal,20),void i.reportException({err:new Error("Unable to verify that Subscription Change Plan Price is === Revenue Api Pricing (Amt/Currency)"),severity:i.SEVERITY.CRITICAL,tags:["revenue_api","payments"]});a.sub_change_plan=JSON.stringify(R)}}var L=y(b,T,w,F,S,v,n,c,C,A);if(C)return m.isValidSubmitState(P.formData,L)?void g(h,a,P).then((function(){return d.start(P.formData.selectedUser.rawValue)})).then((function(){return e(m.submitForm(f,L,p,a))})).catch((function(e){i.reportException({err:new Error("Error during form submission using preauthentication"+e.message),severity:i.SEVERITY.CRITICAL}),d.deactivate()})).finally((function(){""!==P.formData.vat.formattedValue&&r.ProEventsLogger.log("vat_provided_on_initial_purchase",{},void 0,P.pageState.isServerView)})):void e(m.showFormFieldErrors(L,"SubmitForm"));var O=x?{revenueApiProductCode:N.revenueApiProductCode||"",expectedPriceToken:N.revenueApiPricingToken||"",useRevenueApi:x,webPlusDirect:!!k}:void 0;g(h,a,P).then((function(t){e(m.submitForm(f,L,p,t,o,s,_,O)),""!==P.formData.vat.formattedValue&&r.ProEventsLogger.log("vat_provided_on_initial_purchase",{},void 0,P.pageState.isServerView)}))}}var f;function g(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var n,i,s,u,l,p,d,m,y,_;return a.__generator(this,(function(a){return n=r.pageState,i=n.existingAccountShowing,s=n.requestId,u=n.submitSeq,l=n.useRevenueApi,p=r.pricingState.revenueApiMarketingTrackerData,d=e&&e.getScheduleId()===o.ScheduleId.MONTHLY?"monthly":"yearly",t.account_info_type=i?"existing":"new",t.billing_schedule=d,t.currency=e&&e.getCurrency(),t.expected_price=e&&e.getExpectedPriceToken(),t.plan_id=e&&e.transition.state.plan.id,t.tos_version="3",t.packrat=e&&e.hasPackrat(),t.addon_expected_price=e&&e.hasPackrat()&&e.getAddonExpectedPrice(),t.request_id=s,t.submit_seq=u,r.navState?(m=r.navState,y=m.showTrialVersion,_=m.productPlanType,l&&p?(t.billing_schedule=p.contract_length,t.currency=p.currency,t.expected_price_amount=parseFloat(p.total_price_amount),t.product=p.product_family):(t.expected_price_amount=e&&e.getTotalPrice().amount,t.product=_===o.ProductPlanType.PLUS?"plus":"pro"),t.signup_type=y?"trial":"purchase",t.signup_tag=_===o.ProductPlanType.PLUS?y?f.PLUS_TRY:f.PLUS_BUY:y?f.PRO_TRY:f.PRO_BUY,[2,c.setWebRegisterLoggingData(t)]):[2,c.setWebRegisterLoggingData(t)]}))}))}function h(e){return function(t){t(p.updateCountryCode(e)),t(s.updatePrice())}}function S(e){return function(t){t(p.updateZipCode(e)),t(s.updatePrice())}}function P(e){return function(t){t(p.updateVat(e)),t(s.updatePrice())}}function v(e){return function(t){t((function(e){return{type:"UpdateEVH",value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function b(e){return function(t){t((function(e){return{type:"UpdateSchedule",value:e}})(e)),t(s.updateCurrentTransitionPrices())}}function C(e){return function(t){t(p.updateIdealBank(e))}}function T(){return function(e,t){e({type:"ToggleNewAccount",show:!t().pageState.showCreateAccount})}}function F(e){return function(t,a){t({type:"UpdateSelectedUser",value:e})}}function w(e){return{type:"UpdateProductPlanType",value:e}}Object.defineProperty(t,"__esModule",{value:!0}),i=a.__importStar(i),s=a.__importStar(s),p=a.__importStar(p),d=a.__importStar(d),t.getFieldNamesToValidate=y,t.submitProBuyFormToServer=_,(function(e){e.PRO_BUY="pro_buy_register",e.PRO_TRY="pro_try_register",e.PLUS_BUY="plus_buy_register",e.PLUS_TRY="plus_try_register"})(f||(f={})),t.fillAdditionalData=g,t.updateCountryCode=h,t.updateZipCode=S,t.updateVat=P,t.updateEVH=v,t.updateSchedule=b,t.updateIdealBank=C,t.toggleNewAccount=T,t.updateSelectedUser=F,t.updateProductPlanType=w,t.actionCreators={submitProBuyFormToServer:_,updateCountryCode:h,updateZipCode:S,updateVat:P,updateEVH:v,updateSchedule:b,updateIdealBank:C,toggleNewAccount:T,updateSelectedUser:F,updateProductPlanType:w}})),define("modules/clean/react/payments/buy/actions/page_actions",["require","exports","tslib","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/dbmodal"],(function(e,t,a,r,n,o){"use strict";function i(e,t,a){return{type:"UpdateCurrentPage",step:e,productPlanType:t,showTrialVersion:!!a}}function s(e){return function(t){t({type:"LoadSubChangePlans",baseSubChangePlans:e}),t(r.updatePrice())}}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),o=a.__importStar(o),t.toggleSignInModal=function(e){return function(t,a){var r=a();r.pageState.userInfo.existingAccount&&!r.pageState.preauthUser?t({type:"ToggleSignInModal",show:e}):new o.DBModal({element_id:"sign-in-modal",focus:"input[name='login_email']"}).show()}},t.updateCurrentPage=i,t.updateHistory=function(){return{type:"UpdateHistory"}},t.setFooterLinks=function(e){return function(t){t({type:"SetFooterLinks",footerLinks:e})}},t.updateState=function(e){return{type:"UpdateState",props:e}},t.updateSelectedPlan=function(e,t){return function(a,r){a(i(2,e,t)),a(n.updateProductPlanType(e));var o=r().pricingState;o.baseSubChangePlans&&a(s(o.baseSubChangePlans))}},t.loadSubChangePlans=s,t.openSurvey=function(e){return{type:"OpenSurvey",defaultValue:e}},t.cancelSurvey=function(e){return{type:"CancelSurvey",defaultValue:e}},t.submitSurvey=function(e,t,a){return{type:"SubmitSurvey",defaultValue:e,value:t,other:a}}})),define("modules/clean/react/payments/buy/actions/pricing_actions",["require","exports","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/clean/react/growth_pages/promo/types","modules/clean/api_v2/default_user_client","modules/clean/api_v2/noauth_client","modules/clean/viewer","modules/clean/react/payments/buy/types/types"],(function(e,t,a,r,n,o,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new r.SubscriptionService,l=0;function p(){return function(e,t){return t().pageState.useRevenueApi?(function(e,t){e({type:"UpdateTransitionsStart"});var a=t().formData,r=s.Viewer.get_viewer().get_user_by_role("personal"),n=r?new o.DefaultUserApiV2Client(r):new i.NoAuthApiV2Client,c={customer_criteria:{tax_info:{vat_id:a.vat.errorState?"":a.vat.formattedValue,postal_code:a.zipCode.formattedValue,country_code:a.countryCode.formattedValue}},plan_selection_criteria:{product_lines:[{".tag":u.ProductLine.DROPBOX_FILE_SHARING}],plan_families:[{".tag":u.ProductFamily.PLUS},{".tag":u.ProductFamily.PROFESSIONAL}],contract_length:[{unit:{".tag":u.ContractLengthUnitType.MONTH},quantity:1},{unit:{".tag":u.ContractLengthUnitType.YEAR},quantity:1}],include_trials:!1,include_paid:!0},locations:[{".tag":u.RevenueContentLocation.BUY_CHECKOUT},{".tag":u.RevenueContentLocation.BUY}]};l=Math.random()*Number.MAX_VALUE,n.ns("storefront_self_serve").rpc("get_plan_data",c,{}).then((p=l,function(t){l===p&&(e(m(void 0,t)),e(f()))}));var p})(e,t):(function(e,t){var r=t(),o=r.formData,i=r.pricingState,s=r.pageState,u={countryCode:o.countryCode.formattedValue,zipCode:o.zipCode.formattedValue,vat:o.vat.errorState?"":o.vat.formattedValue};if(e({type:"UpdateTransitionsStart"}),!i.subChangePlans)return void e({type:"HasPendingUpdate"});var l=i.subChangePlans.map((function(e){return a.SubscriptionDiff.fromSubscriptionStatus(e)})),p=s.promoSpec&&s.promoSpec.cashCode&&s.promoSpec.id!==n.PromoSpecType.TRIAL?{cashCode:s.promoSpec.cashCode}:void 0;c.priceSet(l,u,p,!0).then((function(t){e(m(t)),e(_(t)),e(f(t))})).catch((function(t){e(y(t))}))})(e,t)}}function d(){return{type:"UpdateTransitionsStart"}}function m(e,t){return{type:"UpdateTransitionsSuccess",subChangePlans:e,revenueApiPlanInfo:t}}function y(e){return{type:"UpdateTransitionsError",error:e}}function _(e){return{type:"UpdateDisplayPrices",subChangePlans:e}}function f(e){return{type:"UpdateCurrentTransitionPrices",subChangePlans:e}}function g(){return{type:"HasPendingUpdate"}}t.updatePrice=p,t.updateTransitionsStart=d,t.updateTransitionsSuccess=m,t.updateTransitionsError=y,t.updateDisplayPrices=_,t.updateCurrentTransitionPrices=f,t.hasPendingUpdate=g,t.actionCreators={updatePrice:p,updateTransitionsStart:d,updateTransitionsSuccess:m,updateTransitionsError:y,updateDisplayPrices:_,updateCurrentTransitionPrices:f,hasPendingUpdate:g}})),define("modules/clean/react/payments/buy/helpers/preauth",["require","exports","modules/clean/ajax_as_promised"],(function(e,t,a){"use strict";function r(e,t){return void 0===t&&(t=!0),a.WebRequest({url:"/pro/ajax_preauth",data:{user_id:e,enabled:t},type:"POST"})}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){return r(e)},t.deactivate=function(){return r(null,!1)}})),define("modules/clean/react/payments/buy/state/pro_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/payments/payment_form/payment_form_spec","modules/clean/redux/unsupported","modules/clean/redux/devtools","modules/clean/react/payments/buy/actions/pricing_actions","modules/clean/react/payments/buy/actions/buy_form_actions","modules/clean/react/payments/buy/helpers/preauth","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/react/payments/buy/reducers/revenue_api_reducers","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/constants","modules/clean/react/payments/common/middleware/pro_buy_logger","modules/clean/react/payments/common/form_value_factory","modules/core/browser","modules/core/notify","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/logging/hive/schemas/web-payments_ux_analytics"],(function(e,t,a,r,n,o,i,s,u,c,l,p,d,m,y,_,f,g,h,S,P,v){"use strict";function b(e){return function(t){return function(a){if("SubmitFormError"!==a.type)return t(a);var r=t(a),n=e.getState().pageState;return a.data&&a.data.error_message&&h.Notify.error(a.data.error_message),a.data.redirect&&g.redirect(a.data.redirect),null==n.suggestedUser||n.showCreateAccount||l.deactivate(),r}}}function C(e){var t=T(e),a=F(e,t);return{pageState:t,pricingState:w(e,a),formData:a,navState:(function(e){var t=e.navState;return t||{currentStep:0,productPlanType:0,showTrialVersion:!1}})(e)}}function T(e){var t=e.autocompleteForm,a=e.isServerView,r=e.locale,n=e.userInfo,i=e.serializedPaymentFormSpec,s=e.suggestedUser,u=e.showPlanSwitchRadios,c=e.preauthUser,l=e.optimizeCpf,p=e.requestId,d=e.footerLinks,m=e.promoSpec,y=e.useRevenueApi,_=e.plansContent,f=e.marketingTracker;return{autocomplete:t,locale:r,userInfo:n,existingAccountShowing:n.existingAccount,paymentFormSpec:new o.PaymentFormSpec(i),submitFormSuccess:!1,hasFormError:!1,isServerView:"ON"===a,suggestedUser:s,showCreateAccount:!1,showPlanSwitchRadios:u,preauthUser:c,optimizeCpf:l,requestId:p,submitSeq:0,footerLinks:d,submitting:!1,promoSpec:m,isPaymentOptionsSurveyOpen:!1,paymentFormErrorsExperiment:e.paymentFormErrorsExperiment,showBuyClickError:!1,showCpf:e.showCpf,psd2AddressFields:e.psd2AddressFields,useRevenueApi:y,plansContent:_,marketingTracker:f,paypalEmail:""}}function F(e,t){var a=e.countryCode,r=e.userInfo,n=e.vat,o=e.trialLength,i=e.showTrialVersion,s=e.locale,u=r.fname||"",c=r.lname||"",l="";r.existingAccount||(l=r.email||"");var p,d=r.password||"",m=y.ScheduleId.YEARLY,_=e.productPlanType||y.ProductPlanType.STANDARD;p=i?t.paymentFormSpec.default_payment_method():t.paymentFormSpec.default_payment_method_for_country(a);var g=n||"";return{city:f.FormValueFactory.createCity(""),phone:f.FormValueFactory.createPhone(""),name:f.FormValueFactory.createName(""),address:f.FormValueFactory.createAddress(""),nonce:f.FormValueFactory.createNonce(""),payPalNonce:f.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:f.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:f.FormValueFactory.createEncryptedCardForNetworkToken("",""),bin:f.FormValueFactory.createBIN(""),browserInfo:f.FormValueFactory.createBrowserInfo(""),threeDsData:f.FormValueFactory.createThreeDsData(""),firstName:f.FormValueFactory.createInput(u),lastName:f.FormValueFactory.createInput(c),email:f.FormValueFactory.createEmail(l),password:f.FormValueFactory.createPassword(d),productPlanType:f.FormValueFactory.createProductPlanType(_),scheduleId:f.FormValueFactory.createSchedule(m),paymentMethod:f.FormValueFactory.createPaymentMethod(p,a,t.paymentFormSpec),countryCode:f.FormValueFactory.createCountryCode(a),zipCode:f.FormValueFactory.createZipCode("",a,t.paymentFormSpec),vat:f.FormValueFactory.createVat(g,a),cpf:f.FormValueFactory.createCpf("",void 0,t.optimizeCpf),cpfName:f.FormValueFactory.createCpfNamePrefill("","",r.displayName,void 0,t.optimizeCpf),accountHolderName:f.FormValueFactory.createInput(""),iban:f.FormValueFactory.createIBAN(""),mandateSigned:f.FormValueFactory.createCheckbox(!1),idealBankId:f.FormValueFactory.createIdealBankId(""),idealBankName:f.FormValueFactory.createIdealBankName(""),termsAndService:f.FormValueFactory.createCheckbox(!1),evh:f.FormValueFactory.createCheckbox(!1),trialEndDate:f.FormValueFactory.createTrialEndDate(o,s),selectedUser:f.FormValueFactory.createUserSelection(),preauthUser:f.FormValueFactory.createUserSelection()}}function w(e,t){var r,n;return e.useRevenueApi?(r=t.productPlanType.formattedValue,n=d.getRevenueApiPricingState(t,e.plansContent,r),a.__assign(a.__assign({},n),{loadingPrices:!1,requestToken:-1,pendingUpdate:!1,displayPrices:{},currentTransitionPrices:{}})):(function(){var a,r=e.baseSubChangePlans,n=e.serializedSubChangePlans;r?a=r.filter((function(t){return t.subState.planSku&&e.navState&&t.subState.planSku.productType===e.navState.productPlanType})):n&&(a=n.map((function(e){return m.SubscriptionChangePlan.deserialize(e)})));var o=p.getDisplayPrices(a,t,e.promoSpec),i=p.getCurrentTransitionPrices(a,t);return{hasCurrencyChanged:!1,loadingPrices:void 0===a,requestToken:-1,subChangePlans:a,baseSubChangePlans:r,pendingUpdate:!1,displayPrices:o,currentTransitionPrices:i}})()}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),o=a.__importStar(o),l=a.__importStar(l),t.submitFormErrorMiddleware=b,t.configureStore=function(e,t){var a=C(e),o=e.useRevenueApi?v.PaymentsUxPlatform.RevenueAPI:v.PaymentsUxPlatform.Legacy,s=r.applyMiddleware(n.default,_.proBuyLogger,new S.PaymentsUXLogger(e.requestId,o).reduxMiddleware,P.marketingEventMiddleware,b);return i.createStore(t,a,r.compose(s))},t.createState=C,t.createPageState=T,t.createFormState=F,t.createPricingState=w})),define("modules/clean/react/payments/buy/reducers/form_value_reducers",["require","exports","tslib","external/lodash","modules/clean/react/payments/buy/reducers/revenue_api_reducers","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/buy/actions/buy_form_actions"],(function(e,t,a,r,n,o,i,s,u,c,l){"use strict";function p(e,t){var a=r.assignIn({},e.formData,t),n=e.pageState.showBuyClickError;if("ON"===e.pageState.paymentFormErrorsExperiment){var o=l.getFieldNamesToValidate(a,e.pageState.paymentFormSpec,e.pageState.existingAccountShowing,e.pageState.psd2AddressFields,e.pageState.showCpf);n=e.pageState.showBuyClickError&&!c.isValidSubmitState(a,o)}var i=r.assignIn({},e.pageState,{hasFormError:!1,showBuyClickError:n});return r.assignIn({},e,{formData:a,pageState:i})}function d(e,t){return"UpdateFirstName"!==t.type?e:p(e,{firstName:s.FormValueFactory.createInput(t.value,e.formData.firstName)})}function m(e,t){return"UpdateLastName"!==t.type?e:p(e,{lastName:s.FormValueFactory.createInput(t.value,e.formData.lastName)})}function y(e,t){if("EmailTakenError"!==t.type)return e;var a=e.formData.email;return a.errorState=o.EmailErrorState.TakenError,a.showError=!0,p(e,{email:a})}function _(e,t){return"UpdateEmail"!==t.type?e:p(e,{email:s.FormValueFactory.createEmail(t.value,e.formData.email)})}function f(e,t){return"UpdatePassword"!==t.type?e:p(e,{password:s.FormValueFactory.createPassword(t.value,e.formData.password)})}function g(e,t){var a=e.formData.firstName.rawValue,r=e.formData.lastName.rawValue,n=e.pageState.userInfo.displayName,o=e.pageState.optimizeCpf;switch(t.type){case"UpdateCpfName":return p(e,{cpfName:s.FormValueFactory.createCpfName(t.value,e.formData.cpfName,o)});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:s.FormValueFactory.createCpfNamePrefill(t.value,r,n,void 0,o)});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:p(e,{cpfName:s.FormValueFactory.createCpfNamePrefill(a,t.value,n,void 0,o)});default:return e}}function h(e,t){if("ToggleNewAccount"!==t.type)return e;var a={};return t.show?a={selectedUser:s.FormValueFactory.createUserSelection()}:e.pageState.preauthUser||(a={firstName:s.FormValueFactory.createInput(""),lastName:s.FormValueFactory.createInput(""),email:s.FormValueFactory.createEmail(""),password:s.FormValueFactory.createPassword("")}),p(e,a)}function S(e,t){return"UpdateSelectedUser"!==t.type?e:p(e,{selectedUser:s.FormValueFactory.createUserSelection(t.value)})}function P(e,t){if("UpdateProductPlanType"!==t.type)return e;var o,i,u,c,l=e.pageState.useRevenueApi;return void 0!==l&&l?(o=s.FormValueFactory.createProductPlanType(t.value),i=r.assignIn({},e.formData,{productPlanType:o}),u=n.getRevenueApiPricingState(e.formData,e.pageState.plansContent,o.formattedValue,e.pricingState),c=a.__assign(a.__assign({},e.pricingState),u),a.__assign(a.__assign({},e),{formData:i,pricingState:c})):p(e,{productPlanType:s.FormValueFactory.createProductPlanType(t.value)})}function v(e,t){return"UpdateSchedule"!==t.type?e:p(e,{scheduleId:s.FormValueFactory.createSchedule(t.value,e.formData.scheduleId)})}function b(e,t){return"UpdateEVH"!==t.type?e:p(e,{evh:s.FormValueFactory.createCheckbox(t.value,e.formData.evh)})}function C(e,t){if("UpdateAddress"!==t.type)return e;var a="UpdateAddress"===t.type?t.value:e.formData.address.rawValue;return p(e,{address:s.FormValueFactory.createAddress(a,e.formData.address)})}function T(e,t){if("UpdatePhone"!==t.type)return e;var a="UpdatePhone"===t.type?t.value:e.formData.phone.rawValue;return p(e,{phone:s.FormValueFactory.createPhone(a,e.formData.phone)})}function F(e,t){if("UpdateName"!==t.type)return e;var a="UpdateName"===t.type?t.value:e.formData.name.rawValue;return p(e,{name:s.FormValueFactory.createName(a,e.formData.name)})}function w(e,t){if("UpdateCity"!==t.type)return e;var a="UpdateCity"===t.type?t.value:e.formData.city.rawValue;return p(e,{city:s.FormValueFactory.createCity(a,e.formData.city)})}function E(e,t){if("UpdatePaymentMethod"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a=e.formData,r=e.pageState,n="UpdatePaymentMethod"===t.type?t.value:a.paymentMethod.rawValue,o=a.countryCode.formattedValue;return p(e,{paymentMethod:s.FormValueFactory.createPaymentMethod(n,o,r.paymentFormSpec,a.paymentMethod)})}function N(e,t){return"UpdateCountryCode"!==t.type?e:p(e,{countryCode:s.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})}function k(e,t){if("UpdateZipCode"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a="UpdateZipCode"===t.type?t.value:e.formData.zipCode.rawValue,r=e.formData.countryCode.formattedValue;return p(e,{zipCode:s.FormValueFactory.createZipCode(a,r,e.pageState.paymentFormSpec,e.formData.zipCode)})}function x(e,t){if("UpdateVat"!==t.type&&"UpdateCountryCode"!==t.type)return e;var a="UpdateVat"===t.type?t.value.toUpperCase():e.formData.vat.rawValue,r=e.formData.countryCode.formattedValue;return p(e,{vat:s.FormValueFactory.createVat(a,r,e.formData.vat)})}function A(e,t){if("UpdateCpf"!==t.type)return e;var a=e.pageState.optimizeCpf;return p(e,{cpf:s.FormValueFactory.createCpf(t.value,e.formData.cpf,a)})}function V(e,t){return"UpdateNonce"!==t.type?e:p(e,{nonce:s.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce,e.pageState.paymentFormErrorsExperiment)})}function U(e,t){return"UpdateBIN"!==t.type?e:p(e,{bin:s.FormValueFactory.createBIN(t.value,e.formData.bin)})}function I(e,t){return"UpdateAccountHolderName"!==t.type?e:p(e,{accountHolderName:s.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})}function D(e,t){return"UpdateIBAN"!==t.type?e:p(e,{iban:s.FormValueFactory.createIBAN(t.value,e.formData.iban)})}function R(e,t){return"UpdateMandateSigned"!==t.type?e:p(e,{mandateSigned:s.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})}function L(e,t){return"UpdateTermsAndService"!==t.type?e:p(e,{termsAndService:s.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})}function O(e,t){if("UpdateIdealBank"!==t.type)return e;var a=t.value,r=a.bankId,n=a.bankName;return p(e,{idealBankId:s.FormValueFactory.createIdealBankId(r,e.formData.idealBankId),idealBankName:s.FormValueFactory.createIdealBankName(n,e.formData.idealBankName)})}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),o=a.__importStar(o),t.AccountReducers=[d,m,_,f,g,S,h,y],t.PlanReducers=[P,v,b],t.PaymentReducers=[N,E,k,x,A,g,V,u.updatePayPalNonce,u.updateAdyenEncryptedCard,u.updateEncryptedCardForNetworkToken,U,u.updateBrowserInfo,u.updateThreeDsData,I,D,R,O,w,C,T,F],t.OrderSummaryReducers=[L],t.FormInputReducers=[B,H,q,z],t.updateFirstName=d,t.updateLastName=m,t.emailAlreadyTakenError=y,t.updateEmail=_,t.updatePassword=f,t.updateCpfName=g,t.toggleNewAccount=h,t.updateUserSelection=S,t.updateProductPlanType=P,t.updateSchedule=v,t.updateEVH=b,t.updateAddress=C,t.updatePhone=T,t.updateName=F,t.updateCity=w,t.updatePaymentMethod=E,t.updateCountryCode=N,t.updateZipCode=k,t.updateVat=x,t.updateCpf=A,t.updateNonce=V,t.updateBIN=U,t.updateAccountHolderName=I,t.updateIBAN=D,t.updateMandateSigned=R,t.updateTOS=L,t.updateIdealBank=O;var M={firstName:"fname",lastName:"lname",email:"account-email",password:"password",name:"name",nonce:"iframe-holder",countryCode:"country_code",address:"address",zipCode:"zip",city:"city",accountHolderName:"owner_name",iban:"iban",mandateSigned:"mandate_signed",idealBankId:"ideal_bank",vat:"vat",cpf:"cpf"};function B(e,t){if("ShowFormFieldErrors"!==t.type)return e;var n=!1,o=a.__assign({},e.formData);e=r.assignIn({},e,{formData:o});for(var s,u=[],c=0,l=t.fieldNames;c<l.length;c++){var p=l[c],d=o[p];d&&!i.FormValueHelper.isValid(d)&&(o[p]=r.assignIn({},o[p],{showError:!0}),n=!0,u.push(p))}var m=e.pageState.showBuyClickError;if("ON"===e.pageState.paymentFormErrorsExperiment&&"SubmitForm"===t.origin){m=!0;for(var y=0,_=u;y<_.length;y++){var f=_[y];if(M[f]){var g=document.getElementById(M[f]);if(g){var h=g.getBoundingClientRect().top;void 0===s?s=h:h<s&&(s=h)}}}void 0!==s&&scrollBy({top:s-150,behavior:"smooth"})}var S=r.assignIn({},e.pageState,{hasFormError:n,showBuyClickError:m});return e=r.assignIn({},e,{pageState:S})}function H(e,t){if("SubmitFormStart"!==t.type)return e;var a=r.assignIn({},e.pageState,{submitting:!0,submitSeq:e.pageState.submitSeq+1});return r.assignIn({},e,{pageState:a})}function q(e,t){if("SubmitFormSuccess"!==t.type)return e;var r;if(e.pageState.isServerView&&void 0!==t.data&&void 0!==t.data.data){var n=t.data.data;r={userQuota:n.user_quota,userQuotaUsage:n.user_quota_usage}}return a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{submitFormSuccess:!0,submitting:!1,newQuotaInfo:r})})}function z(e,t){if("SubmitFormError"!==t.type)return e;var a=r.assignIn({},e.pageState,{submitting:!1});return r.assignIn({},e,{pageState:a})}t.showFormFieldErrors=B,t.submitFormStart=H,t.submitFormSuccess=q,t.submitFormError=z})),define("modules/clean/react/payments/buy/reducers/page_reducers",["require","exports","tslib"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.existingAccountShowing=function(e,t){switch(void 0===e&&(e=!1),t.type){case"ToggleNewAccount":return!e;case"ToggleSignInModal":return(function(e,t){return void 0!==t.show?t.show:!e})(e,t);default:return e}},t.showCreateAccount=function(e,t){return void 0===e&&(e=!1),"ToggleNewAccount"!==t.type?e:void 0!==t.show?t.show:!e},t.footerLinks=function(e,t){return void 0===e&&(e=[]),"SetFooterLinks"!==t.type?e:a.__spreadArrays(t.footerLinks)},t.isPaymentOptionsSurveyOpen=function(e,t){switch(void 0===e&&(e=!1),t.type){case"OpenSurvey":return!0;case"CancelSurvey":case"SubmitSurvey":return!1;default:return e}}})),define("modules/clean/react/payments/buy/reducers/pricing_reducers",["require","exports","tslib","modules/clean/payments/skus/constants","external/lodash","modules/clean/react/payments/buy/helpers/pricing_value_helper","modules/clean/react/payments/buy/types/types","modules/clean/react/payments/buy/reducers/revenue_api_reducers"],(function(e,t,a,r,n,o,i,s){"use strict";function u(e,t){if("UpdateTransitionsStart"!==t.type)return e;var a=n.assignIn({},e.pricingState,{loadingPrices:!0});return n.assignIn({},e,{pricingState:a})}function c(e,t){return"UpdateTransitionsSuccess"!==t.type?e:e.pageState.useRevenueApi?(function(){var n,o=t.revenueApiPlanInfo.plans,s={plus:{yearly:null,monthly:null},professional:{yearly:null,monthly:null}};for(var u in o){var c=o[u],l=c.contract_length,p=c.product_defining_details;p.product_family[".tag"]===i.ProductFamily.PLUS&&l.unit[".tag"]===i.ContractLengthUnitType.MONTH&&1===l.quantity?s.plus.monthly=a.__assign(a.__assign({},o[u]),{productCode:u}):p.product_family[".tag"]===i.ProductFamily.PLUS&&l.unit[".tag"]===i.ContractLengthUnitType.YEAR&&1===l.quantity?s.plus.yearly=a.__assign(a.__assign({},o[u]),{productCode:u}):p.product_family[".tag"]===i.ProductFamily.PROFESSIONAL&&l.unit[".tag"]===i.ContractLengthUnitType.MONTH&&1===l.quantity?s.professional.monthly=a.__assign(a.__assign({},o[u]),{productCode:u}):p.product_family[".tag"]===i.ProductFamily.PROFESSIONAL&&l.unit[".tag"]===i.ContractLengthUnitType.YEAR&&1===l.quantity&&(s.professional.yearly=a.__assign(a.__assign({},o[u]),{productCode:u}))}var d=a.__assign(a.__assign({},e.pageState),{plansContent:a.__assign(a.__assign({},e.pageState.plansContent),(n={},n[r.ProductPlanType.PLUS]=a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS]),{name:s.plus.yearly.plan_content.display_name,namePrefixedWithDropbox:s.plus.yearly.plan_content.dropbox_display_name,priceAnnual:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].priceAnnual),{price:s.plus.yearly.plan_content.advertized_contract_length_price,priceCharged:s.plus.yearly.plan_content.total_price_charged,priceAsMonthly:s.plus.yearly.plan_content.advertized_monthly_price,withoutSavings:"",currency:s.plus.yearly.plan_content.currency,productCode:s.plus.yearly.productCode,pricingToken:s.plus.yearly.pricing_token,taxLines:s.plus.yearly.plan_content.tax_lines,marketingTrackerData:s.plus.yearly.plan_content.marketing_tracker_data}),priceMonthly:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].priceMonthly),{price:s.plus.monthly.plan_content.advertized_contract_length_price,priceCharged:s.plus.monthly.plan_content.total_price_charged,currency:s.plus.monthly.plan_content.currency,productCode:s.plus.monthly.productCode,pricingToken:s.plus.monthly.pricing_token,taxLines:s.plus.monthly.plan_content.tax_lines,marketingTrackerData:s.plus.monthly.plan_content.marketing_tracker_data}),quota:s.plus.yearly.plan_content.advertized_space_long,reasons:s.plus.yearly.location_feature_list_map[i.RevenueContentLocation.BUY].features.map((function(e){return{text:e}})),included:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PLUS].included),{items:s.plus.yearly.location_feature_list_map[i.RevenueContentLocation.BUY_CHECKOUT].features.map((function(e){return{text:e}}))})}),n[r.ProductPlanType.PROFESSIONAL]=a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL]),{name:s.professional.yearly.plan_content.display_name,namePrefixedWithDropbox:s.professional.yearly.plan_content.dropbox_display_name,priceAnnual:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].priceAnnual),{price:s.professional.yearly.plan_content.advertized_contract_length_price,priceCharged:s.professional.yearly.plan_content.total_price_charged,priceAsMonthly:s.professional.yearly.plan_content.advertized_monthly_price,withoutSavings:s.professional.monthly.plan_content.advertized_yearly_price,savings:s.professional.yearly.plan_content.advertized_yearly_price_savings,currency:s.professional.yearly.plan_content.currency,productCode:s.professional.yearly.productCode,pricingToken:s.professional.yearly.pricing_token,taxLines:s.professional.yearly.plan_content.tax_lines,marketingTrackerData:s.professional.yearly.plan_content.marketing_tracker_data}),priceMonthly:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].priceMonthly),{price:s.professional.monthly.plan_content.advertized_contract_length_price,priceCharged:s.professional.monthly.plan_content.total_price_charged,currency:s.professional.monthly.plan_content.currency,productCode:s.professional.monthly.productCode,pricingToken:s.professional.monthly.pricing_token,taxLines:s.professional.monthly.plan_content.tax_lines,marketingTrackerData:s.professional.monthly.plan_content.marketing_tracker_data}),quota:s.professional.yearly.plan_content.advertized_space_long,reasons:s.professional.yearly.location_feature_list_map[i.RevenueContentLocation.BUY].features.map((function(e){return{text:e}})),included:a.__assign(a.__assign({},e.pageState.plansContent[r.ProductPlanType.PROFESSIONAL].included),{items:s.professional.yearly.location_feature_list_map[i.RevenueContentLocation.BUY_CHECKOUT].features.map((function(e){return{text:e}}))})}),n))}),m=a.__assign(a.__assign({},e.pricingState),{loadingPrices:!1,pendingUpdate:!1});return a.__assign(a.__assign({},e),{pageState:d,pricingState:m})})():(function(){var a,r=!1;if(t.subChangePlans&&(a=t.subChangePlans,e.pricingState.subChangePlans)){var o=e.pricingState.subChangePlans[0].tvm,i=a[0].tvm,s=o&&o.getCurrency(),u=i&&i.getCurrency();r=e.pricingState.hasCurrencyChanged||s!==u}var c=n.assignIn({},e.pricingState,{loadingPrices:!1,hasCurrencyChanged:r,subChangePlans:t.subChangePlans,pendingUpdate:!1});return n.assignIn({},e,{pricingState:c})})()}function l(e,t){if("UpdateDisplayPrices"!==t.type)return e;var a,r,i,s,u=e.pageState.useRevenueApi;return void 0!==u&&u?e:(a=e.pageState.promoSpec,r=t.subChangePlans||e.pricingState.subChangePlans,i=o.getDisplayPrices(r,e.formData,a),s=n.assignIn({},e.pricingState,{displayPrices:i}),n.assignIn({},e,{pricingState:s}))}function p(e,t){if("UpdateCurrentTransitionPrices"!==t.type)return e;var r,i,u,c=e.pageState.useRevenueApi;return void 0!==c&&c?(function(){var t=e.formData.productPlanType.formattedValue,r=s.getRevenueApiPricingState(e.formData,e.pageState.plansContent,t,e.pricingState),n=a.__assign(a.__assign({},e.pricingState),r);return a.__assign(a.__assign({},e),{pricingState:n})})():(r=t.subChangePlans||e.pricingState.subChangePlans,i=o.getCurrentTransitionPrices(r,e.formData),u=n.assignIn({},e.pricingState,{currentTransitionPrices:i}),n.assignIn({},e,{pricingState:u}))}function d(e,t){if("HasPendingUpdate"!==t.type)return e;var a=n.assignIn({},e.pricingState,{pendingUpdate:!0});return n.assignIn({},e,{pricingState:a})}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),t.TransitionManagementReducers=[u,c],t.PricingManagementReducers=[d,l,p],t.updateTransitionsStart=u,t.updateTransitionsSuccess=c,t.updateDisplayPrices=l,t.updateCurrentTransitionPrices=p,t.hasPendingUpdate=d})),define("modules/clean/react/payments/buy/reducers/revenue_api_reducers",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRevenueApiPricingState=function(e,t,r,n){r!==a.ProductPlanType.PLUS&&r!==a.ProductPlanType.PROFESSIONAL&&(r=a.ProductPlanType.PROFESSIONAL);var o=e.scheduleId.formattedValue===a.ScheduleId.YEARLY?"priceAnnual":(e.scheduleId.formattedValue,a.ScheduleId.MONTHLY,"priceMonthly"),i=t[r][o];return{hasCurrencyChanged:!!n&&n.revenueApiCurrency!==i.currency,revenueApiPrice:i.priceCharged,revenueApiCurrency:i.currency,revenueApiProductCode:i.productCode,revenueApiPricingToken:i.pricingToken,revenueApiTaxLines:i.taxLines,revenueApiMarketingTrackerData:i.marketingTrackerData}}})),define("modules/clean/react/payments/buy/reducers/nav_reducer",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navReducer=function(e,t){return"UpdateCurrentPage"!==t.type?e:{currentStep:t.step,productPlanType:t.productPlanType,showTrialVersion:t.showTrialVersion}}})),define("modules/clean/react/payments/buy/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/buy/reducers/form_value_reducers","modules/clean/react/payments/buy/reducers/pricing_reducers","modules/clean/react/payments/buy/reducers/page_reducers","modules/clean/react/payments/buy/reducers/nav_reducer","modules/clean/react/payments/buy/state/pro_store_creator"],(function(e,t,a,r,n,o,i,s,u){"use strict";function c(e){return function(t,a){return Object.assign({},t,e(t,a))}}function l(e,t){return"UpdateState"!==t.type?e:u.createState(t.props)}function p(e,t){if("LoadSubChangePlans"!==t.type)return e;var r=a.__assign({},e.pricingState);return r.baseSubChangePlans=t.baseSubChangePlans,r.subChangePlans=t.baseSubChangePlans.filter((function(t){return t.subState.planSku&&t.subState.planSku.productType===e.navState.productPlanType})),a.__assign(a.__assign({},e),{pricingState:a.__assign({},r)})}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),o=a.__importStar(o),t.updateState=l,t.loadSubChangePlans=p,t.proBuyReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,r){return t(e(a,r),r)}}))}.apply(void 0,a.__spreadArrays([r.combineReducers({formData:function(e,t){return void 0===e&&(e={}),e},pageState:c(r.combineReducers({existingAccountShowing:i.existingAccountShowing,footerLinks:i.footerLinks,showCreateAccount:i.showCreateAccount,isPaymentOptionsSurveyOpen:i.isPaymentOptionsSurveyOpen})),pricingState:function(e,t){return void 0===e&&(e={}),e},navState:c(s.navReducer)}),l,p],n.AccountReducers,n.PlanReducers,n.PaymentReducers,n.OrderSummaryReducers,n.FormInputReducers,o.TransitionManagementReducers,o.PricingManagementReducers))})),define("modules/clean/react/payments/buy/types/types",["require","exports","tslib","modules/clean/payments/skus/constants","modules/core/exception"],(function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importStar(n),(function(e){e.PROFESSIONAL="PROFESSIONAL",e.PLUS="PLUS"})(t.BuyPagePlanTiers||(t.BuyPagePlanTiers={})),t.getPlanContentFromMap=function(e,t){return t!==r.ProductPlanType.PLUS&&t!==r.ProductPlanType.PROFESSIONAL&&(n.reportException({err:new Error("Unsupported plan type "+t),severity:n.SEVERITY.CRITICAL}),t=r.ProductPlanType.PROFESSIONAL),e.plansByType?e.plansByType[t]:t===r.ProductPlanType.PLUS?e.plans.Plus:e.plans.Professional},(function(e){e.DROPBOX_FILE_SHARING="dropbox_file_sharing",e.HELLO_SIGN="hello_sign",e.UNKNOWN_PRODUCT_LINE="unknown_product_line"})(t.ProductLine||(t.ProductLine={})),(function(e){e.PLUS="plus",e.PROFESSIONAL="professional",e.STANDARD="standard",e.ADVANCED="advanced",e.SERVER="server",e.ENTERPRISE="enterprise",e.EDUCATION="education",e.ANY_PRODUCT_FAMILY="any_product_family"})(t.ProductFamily||(t.ProductFamily={})),(function(e){e.DAY="day",e.MONTH="month",e.YEAR="year",e.UNKNOWN_CONTRACT_LENGHTH_UNIT="unknown_contract_length_unit"})(t.ContractLengthUnitType||(t.ContractLengthUnitType={})),(function(e){e.USER="user",e.TEAM="team",e.RESELLER_TEAM="reseller_team",e.UNKNOWN="unknown"})(t.CustomerType||(t.CustomerType={})),(function(e){e.BUY="buy",e.BUY_CHECKOUT="buy_checkout",e.UNKNOWN="unknown"})(t.RevenueContentLocation||(t.RevenueContentLocation={}))}));
//# sourceMappingURL=pkg-buy.min.js-vfl0EKtBo.map