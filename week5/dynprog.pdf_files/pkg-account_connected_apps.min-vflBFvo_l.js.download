define("modules/clean/account_page/tabs/connected_apps",["require","exports","tslib","react","react-redux","modules/clean/web_timing_logger","modules/clean/account_page/widgets/connected_services/view","modules/clean/account_page/widgets/linked_apps/view","modules/clean/account_page/util","modules/clean/account_page/widgets/linked_apps/logger"],(function(e,t,n,a,o,r,s,i,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o);var p=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){l.logEvent("view_connected_apps_page"),this.checkTTIstate()},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.checkTTIstate=function(){this.props.dataLoadedForTTI&&(r.mark_time_to_view(),r.mark_time_to_interactive())},t.prototype.render=function(){var e=this.props.expBetterConnectedAppsPage,t=c.getCurrentUser(),n=t.role,o=t.id;return a.default.createElement("div",{className:"account-page-tab"},a.default.createElement(s.ConnectedServices,null),a.default.createElement(i.LinkedApps,{userId:o,appType:"user",expBetterConnectedAppsPage:e}),"work"===n&&a.default.createElement(i.LinkedApps,{userId:o,appType:"team",teamName:c.getTeamName(),expBetterConnectedAppsPage:e}))},t})(a.default.Component);t.ConnectedAppsTab=o.connect((function(e){return{dataLoadedForTTI:"ready"===e.connectedServices.loadingState&&"ready"===e.linkedApps.loadingState}}))(p)})),define("modules/clean/account_page/widgets/connected_services/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/profile_services/profile_services_link","modules/clean/profile_services/profile_services_constants","modules/core/exception","modules/clean/account_page/widgets/connected_services/api"],(function(e,t,n,a,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r);var c=new o.ProfileServicesLinkingHandler;function l(e){return void 0===e&&(e=[]),e.map((function(e){return r.ServiceRequestType.to_api_v2(e)}))}t.loadDataIfNecessary=function(){var e=this;return function(t,o){return n.__awaiter(e,void 0,void 0,(function(){var e,r,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:return"never_loaded"!==o().connectedServices.loadingState?[3,3]:(t({type:"connected_services_load_services"}),e=i.getProfileServices(a.getCurrentUser()),r=i.getFeatureAvailability(a.getCurrentUser()),[4,e]);case 1:return s=n.sent(),[4,r];case 2:c=n.sent(),t({type:"connected_services_feature_availability_loaded",features:c.features}),t({type:"connected_services_services_loaded",services:s.services,connections:s.linked_services}),n.label=3;case 3:return[2]}}))}))}},t.authUserWithService=function(e,t,a,o){var i=this;return function(p){return n.__awaiter(i,void 0,Promise,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return"facebook"===t[".tag"]?(s.assert(!1,"facebook linking has been deprecated"),[2,null]):[4,c.auth_service_with_user_promise(r.default.from_api_service_type(t),e.id,null,a,void 0,void 0,o)];case 1:return(i=n.sent()).success&&p({type:"connected_services_service_connected",service_type:r.default.to_api_service_type(i.provider),displayName:i.display_name,granted_permissions:l(i.granted_request_types),missing_permissions:l(i.missing_request_types),external_service_id:i.external_service_id}),[2,i]}}))}))}},t.deauthUserWithService=function(e,t,a){var o=this;return function(r,s){return n.__awaiter(o,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return o=s().connectedServices.connections.length,[4,i.unlinkUserFromService(e,t,a)];case 1:return n.sent(),r({type:"connected_services_service_disconnected",service_type:t,external_service_id:a,connections:a?o-1:0}),[2,!0]}}))}))}},t.updateModalState=function(e,t,a){var o=this;return function(r,s){return n.__awaiter(o,void 0,void 0,(function(){return n.__generator(this,(function(n){return r({type:"connected_services_modal_state_updated",modal_type:e,service:t,service_data:a}),[2,!0]}))}))}}})),define("modules/clean/account_page/widgets/connected_services/api",["require","exports","tslib","modules/clean/api_v2/default_user_client"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProfileServices=function(e){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(t){return[2,new a.DefaultUserApiV2Client(e).ns("profile_services").rpc("list_linked_services",void 0,{})]}))}))},t.getFeatureAvailability=function(e){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(t){return[2,new a.DefaultUserApiV2Client(e).ns("integrations").rpc("are_features_available",{features:[{feature:"profile_card_v2",entry_point:"connected_apps"},{feature:"slack_folder_linking"}]},{})]}))}))},t.unlinkUserFromService=function(e,t,o){return n.__awaiter(this,void 0,Promise,(function(){return n.__generator(this,(function(n){return[2,new a.DefaultUserApiV2Client(e).ns("profile_services").rpc("unlink",{service:t,external_service_id:o||void 0},{}).then((function(e){return e.success})).catch((function(){return!1}))]}))}))}})),define("modules/clean/account_page/widgets/connected_services/view",["require","exports","tslib","react","react-redux","spectrum/tertiary_link","modules/clean/account_page/widgets/connected_services/action_creators","modules/clean/account_page/components/loading","modules/clean/profile_services/profile_services_constants","modules/clean/account_page/util","modules/clean/profile_services/profile_services_link","modules/core/i18n","modules/clean/static_urls","deep-integrations/instrumentation/connect_service_flow_wrapper","modules/clean/integrations/log_event","deep-integrations/instrumentation/function_wrapper","deep-integrations/instrumentation/constants","deep-integrations/platform/log_event","deep-integrations/instrumentation/common_context","deep-integrations/instrumentation/instr_feature_component","modules/clean/integrations/performance_timer","deep-integrations/async","modules/clean/account_page/widgets/connected_services/zoom_settings","modules/clean/account_page/widgets/connected_services/disconnect_modal","modules/clean/account_page/widgets/connected_services/multi_account_settings"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d,_,m,f,v,g,h,y,b,k,C,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o),c=n.__importDefault(c);var A=v.InstrFeatureType.ConnectedServices;t.ConnectedServicesComponent=function(e){return a.default.createElement(y.InstrFeatureComponent,{logEvent:g.withDefaults(e.logEvent,{feature_name:A}),performanceTimer:b.WebPerformanceTimer,criticalAsyncProps:["ready"===e.loadingState?k.fulfilled(null):k.pending]},a.default.createElement(w,n.__assign({},e)))};var w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.props.fetchServices()},t.prototype.connectService=function(e,t,a,o,r){return n.__awaiter(this,void 0,void 0,(function(){var s,i,c,l;return n.__generator(this,(function(n){switch(n.label){case 0:s=o?o.connection_state:{".tag":"never_connected"},this.props.logEvent(_.buildStartEvent(t.service_type,s,r,v.InstrConnectServiceFlowOutcome.Connected,{service_action:a})),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.props.connectService(e,t.service_type,a,o?o.external_service_id:null)];case 2:return null!=(i=n.sent())&&p.ProfileServicesLinkingHandler.show_import_notifications(i),c=i&&i.success?v.InstrConnectServiceFlowOutcome.Connected:v.InstrConnectServiceFlowOutcome.Error,this.props.logEvent(_.buildEndEvent(t.service_type,r,v.InstrConnectServiceFlowOutcome.Connected,c,{service_action:a})),[3,4];case 3:return l=n.sent(),this.props.logEvent(_.buildEndEvent(t.service_type,r,v.InstrConnectServiceFlowOutcome.Connected,v.InstrConnectServiceFlowOutcome.Error,{service_action:a,error:JSON.stringify(l)})),[3,4];case 4:return[2]}}))}))},t.prototype.disconnectService=function(e,t,n,a){var o=this;this.props.logEvent(_.buildStartEvent(t.service_type,n?n.connection_state:{".tag":"is_connected"},a,v.InstrConnectServiceFlowOutcome.Disconnected)),this.props.disconnectService(e,t,n).then((function(e){return o.props.logEvent(_.buildEndEvent(t.service_type,a,v.InstrConnectServiceFlowOutcome.Disconnected,e?v.InstrConnectServiceFlowOutcome.Disconnected:v.InstrConnectServiceFlowOutcome.Abort))})).catch((function(e){return o.props.logEvent(_.buildEndEvent(t.service_type,a,v.InstrConnectServiceFlowOutcome.Disconnected,v.InstrConnectServiceFlowOutcome.Error,{error:JSON.stringify(e)}))}))},t.prototype.renderServiceRow=function(e,t){var n=l.getCurrentUser(),o=e.service_type,r=e.service_availability,s=e.supports_multiple_links,i=t.length>0,p=c.default.from_api_service_type(o),u=this.getServiceDataWithFeatureCheck(o,["profile_card_v2","slack_folder_linking"]),d=null,_=null;if(0===t.length)d=this.renderDisconnectedConnectionBlock(n,e,u);else if(s)d=this.renderMultiAccountConnectionBlock(e,u,t);else{_=t[0];for(var m=0,f=t;m<f.length;m++){var v=f[m];"is_connected"===v.connection_state[".tag"]&&(_=v)}d=this.renderSingleAccountConnectionBlock(n,e,u,_)}return i||u.action&&"enabled"===r[".tag"]?a.default.createElement("div",{"data-service":p,key:p,className:"connected-services__row"},this.renderServiceInfoBlock(n,e,_,u.permissions,u.learn_more_page),d):null},t.prototype.renderSingleAccountConnectionBlock=function(e,t,n,o){var r=this,s=t.service_type,i=c.default.from_api_to_name(s),l=n.action,p=o.connection_state,_=o.display_name,m="",g=null,h=f.functionWrapperProvider(this.props.logEvent,A);return"zoom"===s[".tag"]?"is_connected"===p[".tag"]?(m=u._("Settings"),g=f.onClickWrapper(h,v.InstrActionType.ModifyServiceSettings,(function(){r.props.updateModalState("zoom_settings",t,null)}),{serviceType:t.service_type[".tag"]})):(m=u.intl.formatMessage(u._("Reconnect to %(service_name)s"),{service_name:i}),l&&(g=f.onClickWrapper(h,v.InstrActionType.ReconnectService,(function(){r.connectService(e,t,l,o,A)}),{serviceType:s[".tag"]}))):"is_connected"===p[".tag"]?(m=u._("Disconnect"),g=f.onClickWrapper(h,v.InstrActionType.DisconnectService,(function(){r.disconnectService(e,t,null,A)}),{serviceType:s[".tag"]})):(m=u.intl.formatMessage(u._("Reconnect to %(service_name)s"),{service_name:i}),l&&(g=f.onClickWrapper(h,v.InstrActionType.ReconnectService,(function(){r.connectService(e,t,l,o,A)}),{serviceType:s[".tag"]}))),a.default.createElement("div",{className:"connected-services__service-connection-block"},"is_connected"===p[".tag"]&&a.default.createElement("img",{className:"connected-services__service-connection-check",src:d.static_url("/static/images/check-green-vfl4z9rpV.svg"),alt:u._("Connected")}),_&&a.default.createElement("span",{className:"connected-services__service-connection-display-name"},_),a.default.createElement("span",{className:"connected-services__action-button"},this.getOptionalTertiaryLink(m,g)))},t.prototype.renderDisconnectedConnectionBlock=function(e,t,n){var o=this,r=t.service_type,s=c.default.from_api_to_name(r),i=n.action,l=u.intl.formatMessage(u._("Connect to %(service_name)s"),{service_name:s}),p=null,d=f.functionWrapperProvider(this.props.logEvent,A);return i&&(p=f.onClickWrapper(d,v.InstrActionType.ConnectService,(function(){o.connectService(e,t,i,null,A)}),{serviceType:r[".tag"]})),a.default.createElement("div",{className:"connected-services__service-connection-block"},a.default.createElement("span",{className:"connected-services__action-button"},this.getOptionalTertiaryLink(l,p)))},t.prototype.renderMultiAccountConnectionBlock=function(e,t,n){var o,r=this,s=e.service_type,i=f.functionWrapperProvider(this.props.logEvent,A);o=f.onClickWrapper(i,v.InstrActionType.ModifyServiceSettings,(function(){r.props.updateModalState("multiple_account_settings",e,t)}),{serviceType:s[".tag"]});return a.default.createElement("div",{className:"connected-services__service-connection-block"},"",a.default.createElement("span",{className:"connected-services__action-button"},this.getOptionalTertiaryLink(u._("Settings"),o)))},t.prototype.getOptionalTertiaryLink=function(e,t){return t?a.default.createElement(r.TertiaryLink,{onClick:t},e):null},t.prototype.renderServiceInfoBlock=function(e,t,n,o,r){var s=t.service_type,i=c.default.from_api_to_name(s),l=c.default.from_api_to_img(s),p=f.functionWrapperProvider(this.props.logEvent,A);return a.default.createElement("div",{className:"connected-services__service-info-block"},a.default.createElement("div",null,a.default.createElement("img",{className:"connected-services__service-info-icon",src:d.static_url(l),alt:i})),a.default.createElement("div",{className:"connected-services__service-info-text"},a.default.createElement("div",{className:"connected-services__service-info-name"},i),a.default.createElement("div",{className:"connected-services__service-info-metadata"},a.default.createElement("div",null,o,r&&a.default.createElement("a",{className:"connected-services__service-info-learn-more",onClick:f.onClickWrapper(p,v.InstrActionType.LearnMore,void 0,{serviceType:s[".tag"]}),href:r,target:"_blank",rel:"noopener noreferrer"},u._("Learn More"))),this.renderConnectGoogleCalendar(e,t,n),this.renderConnectSlackFilesRead(e,t,n))))},t.prototype.renderExtensionsTable=function(){var e=n.__spreadArrays(this.props.services);e.sort(this.serviceCompare.bind(this));for(var t={},o=0,r=this.props.connections;o<r.length;o++){var s=r[o];(u=s.service_type[".tag"])in t||(t[u]=[]),t[u].push(s)}for(var i=[],c=0,l=e;c<l.length;c++){var p=l[c],u=p.service_type[".tag"];i.push(this.renderServiceRow(p,t[u]||[]))}return a.default.createElement("div",{className:"connected-services"},i)},t.prototype.render=function(){return"ready"!==this.props.loadingState?a.default.createElement("div",{className:"account-page-block account-page-block--connected-apps"},a.default.createElement(i.Loading,null)):a.default.createElement("div",{className:"account-page-block"},a.default.createElement("span",{className:"account-page-block__heading"},u._("Connect apps to Dropbox")),a.default.createElement("p",{className:"account-page-block__subtext"},u._("Integrated features from these apps make it easier to collaborate with people you know on Dropbox.")),this.renderExtensionsTable(),this.renderCurrentModal())},t.prototype.renderCurrentModal=function(){var e=this;if(null==this.props.modalState)return null;var t=l.getCurrentUser(),n=function(){e.props.updateModalState(null,null,null)};if("multiple_account_settings"===this.props.modalState.type){var a=this.props.modalState.service,o=this.props.modalState.serviceData;return a&&o?S.renderMultiAccountSettingsModal(t,a,o,(function(t,n,a,o,r){e.connectService(t,n,a,o,r)}),(function(t,n,a,o){e.disconnectService(t,n,a,o)}),n):null}return"zoom_settings"===this.props.modalState.type&&(a=this.props.modalState.service)?C.renderZoomSettingsModal(t,a,(function(t,n,a,o){e.disconnectService(t,n,a,o)}),n):null},t.prototype.renderConnectGoogleCalendar=function(e,n,o){var r=this;return null==o?null:this.isFeatureAvailable("profile_card_v2")&&"google"===n.service_type[".tag"]&&"is_connected"===o.connection_state[".tag"]&&t.containsPermission(o.missing_permissions,"calendar")&&a.default.createElement("span",{className:"connected-services__service-info-action-button"},this.getOptionalTertiaryLink(u._("Connect Google Calendar"),(function(){r.connectService(e,n,"link_calendar",o,A)})))},t.prototype.renderConnectSlackFilesRead=function(e,n,o){var r=this;return null==o?null:this.isFeatureAvailable("slack_folder_linking")&&"slack_dropbox"===n.service_type[".tag"]&&"is_connected"===o.connection_state[".tag"]&&t.containsPermission(o.missing_permissions,"read_files")&&a.default.createElement("span",{className:"connected-services__service-info-action-button"},this.getOptionalTertiaryLink(u._("Enable Folder Linking"),(function(){r.connectService(e,n,"link_read_files",o,A)})))},t.containsPermission=function(e,t){return!!e.find((function(e){return e[".tag"]===t}))},t.prototype.isFeatureAvailable=function(e){for(var t=0,n=this.props.features;t<n.length;t++){var a=n[t];if(a.feature===e&&"available"===a.available[".tag"])return!0}return!1},t.prototype.getServiceDataWithFeatureCheck=function(e,t){for(var n=0,a=t;n<a.length;n++){var o=a[n];if(this.isFeatureAvailable(o)){var r=c.default.get_gated_service_data(e,o);if(r)return r}}return c.default.get_service_data(e)},t.prototype.serviceCompare=function(e,t){var n=this.getServiceDataWithFeatureCheck(e.service_type,["profile_card_v2"]),a=this.getServiceDataWithFeatureCheck(t.service_type,["profile_card_v2"]),o=n.order-a.order;return 0!==o?o:n.friendly_name<a.friendly_name?-1:n.friendly_name>a.friendly_name?1:0},t})(a.default.Component);t.ConnectedServices=o.connect((function(e){return{services:e.connectedServices.services,connections:e.connectedServices.connections,loadingState:e.connectedServices.loadingState,features:e.connectedServices.features,logEvent:h.decorateCommonContext(m.createIntegrationsActionsLogger().logEvent,{services:e.connectedServices.services,serviceList:e.connectedServices.connections,featureGates:e.connectedServices.features}),modalState:e.connectedServices.modalState}}),(function(e){return{fetchServices:function(){return e(s.loadDataIfNecessary())},connectService:function(t,n,a,o){return e(s.authUserWithService(t,n,a,o||void 0))},disconnectService:function(t,n,a){var o=null!=a?a.external_service_id:null;return e(E.disconnectModalActionCreator(t,n.service_type,o))},updateModalState:function(t,n,a){return e(s.updateModalState(t,n,a))}}}))(t.ConnectedServicesComponent)})),define("modules/clean/account_page/widgets/connected_services/disconnect_modal",["require","exports","tslib","react","modules/clean/account_page/widgets/connected_services/action_creators","modules/clean/profile_services/profile_services_constants","modules/core/i18n","spectrum/modal","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/integrations/log_event","deep-integrations/instrumentation/function_wrapper","deep-integrations/instrumentation/constants"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),r=n.__importDefault(r),t.disconnectModalActionCreator=function(e,t,_){var m=this;return function(f,v){var g=o.deauthUserWithService(e,t,_);return new Promise((function(e,o){(function(e,t,n){var o=p.createIntegrationsActionsLogger().logEvent,l=u.functionWrapperProvider(o,d.InstrFeatureType.ConnectedServices),_=r.default.from_api_to_name(e),m=s.intl.formatMessage(s._("Disconnect %(service_name)s integration?"),{service_name:_}),f=s.intl.formatMessage(s._("Are you sure you want to disconnect <st>%(service_name)s</st>? You’ll need to reconnect again to continue using %(service_name)s integrations on Dropbox."),{st:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)},service_name:_});c.Modal.showInstance(a.default.createElement(i.UtilityModal,{ariaLabel:m,title:m,overlayClickClose:!0,primaryAction:s._("Disconnect"),secondaryAction:s._("Cancel"),shouldFocusAfterRender:!0,onPrimaryAction:u.onClickWrapper(l,d.InstrActionType.DisconnectServiceConfirm,t,{serviceType:e[".tag"]}),open:!0,onSecondaryAction:u.onClickWrapper(l,d.InstrActionType.DisconnectServiceAbort,n,{serviceType:e[".tag"]}),onRequestClose:function(){return c.Modal.close()},appElement:document.getElementById("embedded-app")},f))})(t,(function(){return n.__awaiter(m,void 0,void 0,(function(){var a,i;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,g(f,v)];case 1:return(a=n.sent())&&l.Snackbar.complete(s.intl.formatMessage(s._("Successfully disconnected %(service)s integration"),{service:r.default.from_api_to_name(t)})),e(a),[3,3];case 2:return i=n.sent(),o(i),[3,3];case 3:return[2]}}))}))}),(function(){e(!1)}))}))}}})),define("modules/clean/account_page/widgets/connected_services/multi_account_settings",["require","exports","tslib","react","spectrum/tertiary_link","modules/clean/profile_services/profile_services_constants","modules/core/i18n","spectrum/modal","modules/clean/integrations/log_event","deep-integrations/instrumentation/function_wrapper","deep-integrations/instrumentation/constants","react-redux","deep-integrations/instrumentation/common_context","deep-integrations/instrumentation/instr_feature_component","modules/clean/integrations/performance_timer","deep-integrations/platform/log_event"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d,_,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),r=n.__importDefault(r),u=n.__importStar(u);var v=p.InstrFeatureType.MultiAccountSettings;t.MultiAccountSettingsComponent=function(e){return a.default.createElement(_.InstrFeatureComponent,{logEvent:f.withDefaults(e.logEvent,{feature_name:v}),performanceTimer:m.WebPerformanceTimer},a.default.createElement(g,n.__assign({},e)))};var g=(function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.getServiceConnections=function(){var e=this;return this.props.connections.filter((function(t){return t.service_type[".tag"]===e.props.service.service_type[".tag"]}))},t.prototype.renderConnectAnotherAccount=function(){var e=this,t=c.createIntegrationsActionsLogger().logEvent,n=l.functionWrapperProvider(t,v),i=this.props.serviceData.action;if(!i)return null;var u=this.props.service,d=u.service_type,_=r.default.from_api_to_name(d),m=l.onClickWrapper(n,p.InstrActionType.ConnectService,(function(){e.props.onConnect(e.props.user,u,i,null,v)}),{serviceType:d[".tag"]}),f=s.intl.formatMessage(s._("Connect another %(service_name)s account",{comment:"This appears as a link on a modal that contains settings related to an app.\n        service_name will be a brand name, such as Slack or Zoom, whose account we're asking the user to link."}),{service_name:_});return a.default.createElement("div",{className:"connected-services__service-settings-add-account"},a.default.createElement(o.TertiaryLink,{onClick:m},f))},t.prototype.renderPermissionsList=function(e){var t=this,n=this.props.service,r=[];if(h(e.granted_permissions,"contacts")&&r.push(s._("Contacts",{comment:"This appears in a list of permissions that an app (that, for example, Google, or Outlook) supports."})),h(e.granted_permissions,"calendar"))r.push(s._("Calendar",{comment:"This appears in a list of permissions that an app (that, for example, Google or Outlook) supports."}));else if("google"===n.service_type[".tag"]&&h(e.missing_permissions,"calendar")){var i=c.createIntegrationsActionsLogger().logEvent,u=l.functionWrapperProvider(i,v),d=l.onClickWrapper(u,p.InstrActionType.ConnectService,(function(){t.props.onConnect(t.props.user,n,"link_calendar",e,v)}),{serviceType:n.service_type[".tag"]});r.push(a.default.createElement(o.TertiaryLink,{className:"connected-services__service-settings-service-list-entry-info",onClick:d},s._("Link Calendar",{comment:"This appears in a comma-separated list of permissions that an app (for example, Google or Outlook) supports.\n                A 'link', in this context, is the act of a user connecting that app to Dropbox, and approving access to that permission."})))}var _=s.intl.formatList(r,{style:"narrow",type:"conjunction"});return a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-info-permissions"},_)},t.prototype.getDisconnectButton=function(e,t){var n=this,r=s._("Disconnect"),i=l.onClickWrapper(e,p.InstrActionType.DisconnectService,(function(){n.props.onDisconnect(n.props.user,n.props.service,t,v)}),{serviceType:t.service_type[".tag"]});return a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-button-disconnect"},a.default.createElement(o.TertiaryLink,{onClick:i},r))},t.prototype.getReconnectButton=function(e,t,n){var r=this,i=this.props.serviceData.action,c=n.service_type;if(null==i)return null;var u=s.intl.formatMessage(s._("Reconnect to %(service_name)s"),{service_name:t}),d=l.onClickWrapper(e,p.InstrActionType.ReconnectService,(function(){r.props.onConnect(r.props.user,r.props.service,i,n,v)}),{serviceType:c[".tag"]});return a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-button-reconnect"},a.default.createElement(o.TertiaryLink,{onClick:d},u))},t.prototype.render=function(){var e=this,t=c.createIntegrationsActionsLogger().logEvent,n=l.functionWrapperProvider(t,v),o=this.props.service.service_type,p=r.default.from_api_to_name(o),u=this.getServiceConnections(),d=s.intl.formatMessage(s._("%(service_name)s settings",{comment:"This appears as a heading of a modal view that contains settings related to an app.\n        service_name will be a brand name, such as Slack or Zoom, whose settings the user is changing."}),{service_name:p}),_=u.map((function(t){var o=t.display_name,r=null;return r="is_connected"===t.connection_state[".tag"]?e.getDisconnectButton(n,t):e.getReconnectButton(n,p,t),a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry",key:t.external_service_id},a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-info"},a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-name"},o),e.renderPermissionsList(t)),a.default.createElement("div",{className:"connected-services__service-settings-service-list-entry-button"},r))})),m=this.renderConnectAnotherAccount();return a.default.createElement(i.UtilityModal,{className:"connected-services__service-settings-modal",ariaLabel:d,title:d,overlayClickClose:!0,primaryAction:s._("Close"),onRequestClose:this.props.onClose,shouldFocusAfterRender:!0,open:!0,appElement:document.getElementById("embedded-app"),shouldRequestCloseOnActions:!0},a.default.createElement("div",{className:"connected-services__service-settings-service-list"},_),m)},t})(a.default.Component);function h(e,t){return!!e.find((function(e){return e[".tag"]===t}))}t.MultiAccountSettingsComponentImpl=g,t.renderMultiAccountSettingsModal=function(e,n,o,r,s,i){return a.default.createElement(t.MultiAccountSettings,{service:n,serviceData:o,user:e,onConnect:r,onDisconnect:s,onClose:i})},t.MultiAccountSettings=u.connect((function(e){return{connections:e.connectedServices.connections,logEvent:d.decorateCommonContext(c.createIntegrationsActionsLogger().logEvent,{serviceList:e.connectedServices.connections})}}))(t.MultiAccountSettingsComponent)})),define("modules/clean/account_page/widgets/connected_services/zoom_settings",["require","exports","tslib","react","modules/clean/profile_services/profile_services_constants","modules/core/i18n","spectrum/modal","modules/clean/react/snackbar","modules/clean/integrations/log_event","deep-integrations/instrumentation/function_wrapper","deep-integrations/instrumentation/constants","spectrum/checkbox/checkbox","modules/clean/api_v2/default_user_client","react-redux"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importDefault(o),_=n.__importStar(_);var m=p.InstrFeatureType.ZoomSettings,f=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleSaveMeetingRecordingsCheckboxChange=function(){n.setState((function(e){return{saveMeetingRecordings:!e.saveMeetingRecordings}}))},n.fetchZoomSettings=function(){n.setState({isFetching:!0}),new d.DefaultUserApiV2Client(n.props.user).ns("integrations").rpc("get_user_settings",{},{}).then((function(e){var t=!(!e.zoom_settings||!e.zoom_settings.save_meeting_recordings),a=!(!e.zoom_settings||!e.zoom_settings.meeting_recordings_disabled_by_admin);n.setState({isFetching:!1,initialSaveMeetingRecordings:t,adminHasDisabledSaveMeetingRecordings:a,saveMeetingRecordings:t})}),(function(e){n.setState({isFetching:!1})}))},n.confirmNewSettings=function(){var e=r._("Setting updated."),t=r._("Couldn’t update setting. Try again later.");n.state.saveMeetingRecordings!==n.state.initialSaveMeetingRecordings?new d.DefaultUserApiV2Client(n.props.user).ns("integrations").rpc("set_user_settings",{zoom_settings:{save_meeting_recordings:n.state.saveMeetingRecordings}},{}).then((function(t){i.Snackbar.complete(e)}),(function(e){i.Snackbar.fail(t)})):i.Snackbar.complete(e)},n.state={isFetching:!0,initialSaveMeetingRecordings:!1,adminHasDisabledSaveMeetingRecordings:!1,saveMeetingRecordings:!1},n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchZoomSettings()},t.prototype.getServiceConnections=function(){var e=this;return this.props.connections.filter((function(t){return t.service_type[".tag"]===e.props.service.service_type[".tag"]}))},t.prototype.getSettingsComponent=function(){return this.state.isFetching?a.default.createElement("div",null):a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"connected-services__service-setting-checkbox-container"},a.default.createElement(u.Checkbox,{disabled:this.state.adminHasDisabledSaveMeetingRecordings,checked:this.state.saveMeetingRecordings&&!this.state.adminHasDisabledSaveMeetingRecordings?"checked":"unchecked",onChange:this.handleSaveMeetingRecordingsCheckboxChange,className:"connected-services__service-team-settings-checkbox-symbol"}),a.default.createElement("span",{className:this.state.adminHasDisabledSaveMeetingRecordings?"connected-services__service-setting-checkbox-name--disabled":"connected-services__service-setting-checkbox-name"},a.default.createElement("div",{className:"connected-services__service-setting-checkbox-name-title"},r._("Copy Zoom cloud recordings to Dropbox",{comment:"This is a label on a checkbox relating to settings for the Zoom integration.\n                When the checkbox is checked, a feature of the integration is enabled.\n                A more in-depth explanation is given below the checkbox.\n                Zoom is a brand, and Zoom Meeting is the name of a Zoom product.\n                Cloud recording is vaguely the name of a Zoom product, but they aren't very consistent about it;\n                  this is specifically contrasted with local recordings."})),a.default.createElement("div",null,r._("After a meeting you host is recorded to Zoom cloud, the recording will be copied from Zoom cloud to your Zoom folder in Dropbox. We’ll notify you when files are copied. This feature requires certain settings in your Zoom account to be enabled.",{comment:"This is an explanation under a checkbox on the settings for the Zoom integration.\n                Zoom is a brand name.\n                Cloud recording is vaguely the name of a Zoom product, but they aren't very consistent about its name;\n                  this is specifically contrasted with local recordings, which this feature does not interact with."})," ",a.default.createElement("a",{href:"https://help.dropbox.com/installs-integrations/third-party/zoom#cloudrecordings",target:"_blank",rel:"noopener noreferrer"},r._("Learn more"))))))},t.prototype.render=function(){var e=this,t=this.getServiceConnections();if(0===t.length)return null;var n=t[0],i=c.createIntegrationsActionsLogger().logEvent,u=l.functionWrapperProvider(i,m),d=o.default.from_api_to_name(this.props.service.service_type),_=r.intl.formatMessage(r._("%(service_name)s settings",{comment:"This appears as a heading of a modal view that contains settings related to an app.\n        service_name will be a brand name, such as Slack or Zoom, whose settings the user is changing."}),{service_name:d}),f=l.onClickWrapper(u,p.InstrActionType.ModifyServiceSettingsConfirm,this.confirmNewSettings,{serviceType:this.props.service.service_type[".tag"]}),v=l.onClickWrapper(u,p.InstrActionType.DisconnectService,(function(){e.props.onDisconnect(e.props.user,e.props.service,n,m)}),{serviceType:this.props.service.service_type[".tag"]});return a.default.createElement(s.UtilityModal,{className:"connected-services__service-settings-modal",ariaLabel:_,title:_,overlayClickClose:!0,primaryAction:r._("Update"),secondaryAction:r._("Cancel"),shouldFocusAfterRender:!0,onPrimaryAction:f,open:!0,link:r._("Disconnect Zoom"),onLink:v,onRequestClose:this.props.onClose,appElement:document.getElementById("embedded-app")},this.getSettingsComponent())},t})(a.default.Component);t.ZoomSettingsComponent=f,t.ZoomSettings=_.connect((function(e){return{connections:e.connectedServices.connections}}))(f),t.renderZoomSettingsModal=function(e,n,o,r){return"zoom"!==n.service_type[".tag"]?null:a.default.createElement(t.ZoomSettings,{user:e,service:n,onDisconnect:o,onClose:r})}})),define("modules/clean/account_page/widgets/linked_apps/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/linked_apps/api"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=function(e){var t=this;return function(o,r){return n.__awaiter(t,void 0,void 0,(function(){var t;return n.__generator(this,(function(n){switch(n.label){case 0:return"never_loaded"!==r().linkedApps.loadingState?[3,2]:(o({type:"linked_apps_load_apps"}),[4,a.getLinkedApps(e)]);case 1:t=n.sent(),o({type:"linked_apps_apps_loaded",apps:t}),n.label=2;case 2:return[2]}}))}))}},t.unlinkApp=function(e,t,o,r){var s=this;return function(i,c){return n.__awaiter(s,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return i({type:"linked_apps_unlink_app",appType:t,app:o}),"app_action"!==o.type?[3,2]:[4,a.unlinkAppAction(e,o)];case 1:return n.sent(),[3,4];case 2:return[4,a.unlinkApp(e,o,r)];case 3:n.sent(),n.label=4;case 4:return i({type:"linked_apps_app_unlinked",appType:t,app:o}),[2,!0]}}))}))}}})),define("modules/clean/account_page/widgets/linked_apps/api",["require","exports","modules/clean/api_v2/user_client","modules/clean/ajax_as_promised"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLinkedApps=function(e){return a.WebRequest({url:"/account/get_linked_apps",subject_user:e,dataType:"json"})},t.unlinkApp=function(e,t,a){return(new n.UserApiV2Client).ns("security_settings").rpc("uninstall_app",{app_id:t.id,keep_sandbox_files:a},{subjectUserId:e})},t.unlinkAppAction=function(e,t){return(new n.UserApiV2Client).ns("security_settings").rpc("uninstall_app_action",{action_id:t.action_id},{subjectUserId:e})}})),define("modules/clean/account_page/widgets/linked_apps/modals",["require","exports","tslib","react","spectrum/checkbox","modules/core/i18n","spectrum/modal","modules/clean/react/modal"],(function(e,t,n,a,o,r,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var n=e.call(this,t)||this;return n.onAccept=function(){n.props.onSubmit(n.props.appInfo,n.state.checked)},n.onToggle=function(e){n.setState({checked:"checked"===e})},n.onClose=function(){i.Modal.close()},n.state={checked:!1},n}return n.__extends(t,e),t.prototype.renderCheckbox=function(e){var t=r._("Also remove <st>%(app_name)s</st> folder from my Dropbox."),n=r.intl.formatMessage(t,{st:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)},app_name:e});return a.default.createElement("div",{className:"remove-app-folder"},a.default.createElement(o.Checkbox,{onChange:this.onToggle,className:"remove-app-folder__checkbox",checked:this.state.checked?"checked":"unchecked"}),a.default.createElement("div",null,n))},t.prototype.render=function(){var e=this.props.appInfo,t=e.name,n=r.intl.formatMessage(r._("Disconnect %(app_name)s?"),{app_name:t}),o=r._("Are you sure you want to disconnect <st>%(app_name)s</st>? This app will no longer have permission to access your Dropbox."),i=r.intl.formatMessage(o,{st:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)},app_name:t}),c="app_action"!==e.type&&e.uses_sandbox&&e.app_folder;return a.default.createElement(s.UtilityModal,{id:"linked-apps-dismiss-app-modal",ariaLabel:n,title:n,overlayClickClose:!0,primaryAction:r._("Disconnect"),secondaryAction:r._("Cancel"),shouldFocusAfterRender:!0,onPrimaryAction:this.onAccept,open:!0,onRequestClose:this.onClose,appElement:document.getElementById("embedded-app")},a.default.createElement("div",null,i),c&&this.renderCheckbox(t))},t})((a=n.__importDefault(a)).default.Component);t.DismissAppModal=c})),define("modules/clean/account_page/widgets/linked_apps/view",["require","exports","tslib","react","react-redux","modules/core/i18n","modules/core/uri","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/account_page/components/action_table","modules/clean/account_page/components/info_tooltip","modules/clean/account_page/components/loading","modules/clean/account_page/widgets/linked_apps/action_creators","modules/clean/account_page/widgets/linked_apps/modals","modules/clean/react/snackbar","modules/clean/account_page/components/linked_apps","modules/clean/account_page/widgets/linked_apps/logger"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d,_,m,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o);var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t})(l.ActionTable),h=r._("This app no longer has access to your files because you deleted its app folder. You will need to reinstall the app for it to work again."),y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uninstallApp=function(e,a){return n.__awaiter(t,void 0,void 0,(function(){return n.__generator(this,(function(t){switch(t.label){case 0:v.logEvent("click_confirm_disconnect_app",v.appInfoExtras(e)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.props.unlinkApp(this.props.userId,this.props.appType,e,!a)];case 2:return t.sent(),m.Snackbar.complete(r.intl.formatMessage(r._("Successfully disconnected %(app_name)s"),{app_name:e.name})),[3,4];case 3:return t.sent(),m.Snackbar.fail(r.intl.formatMessage(r._("Could not disconnect %(app_name)s, try again later"),{app_name:e.name})),[3,4];case 4:return[2]}}))}))},t.onClosePressed=function(e){v.logEvent("click_disconnect_app",v.appInfoExtras(e)),i.Modal.showInstance(a.default.createElement(_.DismissAppModal,{appInfo:e,onSubmit:t.uninstallApp}))},t.renderAppDetail=function(e,n){switch(n){case"app_name":return t.renderAppName(e);case"publisher":return a.default.createElement(f.LinkedAppsPublisherInfo,{appInfo:e});case"access_type":return t.renderAccessType(e);case"datastore":return t.renderDatastoreExport(e)}return null},t.hideClose=function(e){return"team"===t.props.appType},t.isLinkedAppsEmpty=function(){var e,n=t.props,a=n.appType,o=n.apps,r="user"===a?null==o?void 0:o.user_apps:null==o?void 0:o.team_apps;return 0===(null!==(e=null==r?void 0:r.length)&&void 0!==e?e:0)},t}return n.__extends(t,e),t.prototype.componentWillMount=function(){this.props.loadApps(this.props.userId)},t.prototype.renderAppName=function(e){var t=e.icon_url?a.default.createElement("img",{src:e.icon_url,className:"action-app-name__icon-img",alt:""}):a.default.createElement(c.Sprite,{group:"web",name:"folder_app",alt:""});return a.default.createElement("div",{className:"app-name"},a.default.createElement("span",{className:"app-name__icon"},t),a.default.createElement("span",null,e.name))},t.prototype.renderAccessType=function(e){var t;t="no_access"===e.access_type?r._("No access - App folder deleted"):"full"===e.access_type?r._("Full Dropbox"):e.access_type,e.pending&&(t=r.intl.formatMessage(r._("%(access_type)s (Pending)"),{access_type:t}));var n="no_access"===e.access_type?h:e.access_type_desc;return a.default.createElement(p.InfoTooltip,{prompt:t,content:n})},t.prototype.renderDatastoreExport=function(e){if("app_action"!==e.type&&e.datastore){var t=r._("This app has saved data for you in Dropbox datastores, which are no longer supported. Click here to download your data as a CSV file."),n=new s.URI({path:"/developers/apps/datastores/export/"+e.id+"/"+this.props.userId}).toString(),o=a.default.createElement("a",{className:"datastores-link",href:n},r._("Download datastores"));return a.default.createElement(p.InfoTooltip,{prompt:o,content:t})}return!1},t.prototype.renderAppTable=function(){var e=this.props.apps,t="user"===this.props.appType?e.user_apps:e.team_apps,o=t.some((function(e){return"app_action"!==e.type&&e.datastore})),s=["app_name","publisher","access_type"],i={app_name:r._("App name"),publisher:r._("Publisher"),access_type:r._("Access type")};o&&(s.push("datastore"),i.datstore="");var c={keys:s,headers:i,data:t,renderRowDetail:this.renderAppDetail,onClosePressed:this.onClosePressed,hideClose:this.hideClose,dismissAriaLabel:function(e){return r.intl.formatMessage(r._("Unlink %(app_name)s"),{app_name:e.name})},dismissHeaderAriaLabel:r._("Unlink app"),tableClass:["linked-apps-table"]};return a.default.createElement(g,n.__assign({},c))},t.prototype.getSectionHeaders=function(){if(this.isLinkedAppsEmpty()){if("user"===this.props.appType){var e=r._("You haven’t given any third-party apps access to your Dropbox account.");return[r._("Apps with access to your Dropbox"),e]}return[r._("Apps managed for your team"),e=r._("You haven’t given any third-party apps access to your Dropbox account.")]}if("user"===this.props.appType){var t=r._("You’ve given these apps permission to access your Dropbox files on your behalf.");return[r._("Apps with access to your Dropbox"),t]}var n=this.props.teamName;return[r._("Apps managed for your team"),t=r.intl.formatMessage(r._("An administrator at %(company_name)s has given these apps access to your %(company_name)s Dropbox account."),{company_name:n})]},t.prototype.render=function(){var e,t=this.props,n=t.apps,o=t.appType,r=t.expBetterConnectedAppsPage;if("ready"!==t.loadingState)return a.default.createElement("div",{className:"account-page-block account-page-block--linked-apps"},a.default.createElement(u.Loading,null));var s=null!==(e="user"===o?null==n?void 0:n.user_apps:null==n?void 0:n.team_apps)&&void 0!==e?e:[],i=this.getSectionHeaders(),c=i[0],l=i[1];return"ON_SHOW_ACCORDION"===r?a.default.createElement("div",{className:"linked-apps"},a.default.createElement("span",{className:"account-page-block__heading"},c),a.default.createElement("p",{className:"account-page-block__subtext"},l),a.default.createElement(f.LinkedAppsAccordion,{appType:o,appInfos:s,onClickDisconnect:this.uninstallApp})):a.default.createElement("div",{className:"account-page-block account-page-block--linked-apps"},a.default.createElement("span",{className:"account-page-block__heading"},c),a.default.createElement("p",{className:"account-page-block__subtext"},l),!this.isLinkedAppsEmpty()&&this.renderAppTable())},t})(a.default.Component);t.LinkedAppsComponent=y,t.LinkedApps=o.connect((function(e){return{apps:e.linkedApps.apps,loadingState:e.linkedApps.loadingState}}),(function(e){return{loadApps:function(t){return e(d.loadDataIfNecessary(t))},unlinkApp:function(t,n,a,o){return e(d.unlinkApp(t,n,a,o))}}}))(y)})),define("modules/clean/account_page/components/linked_apps",["require","exports","tslib","react","modules/core/i18n","purify","modules/clean/react/css","spectrum-arbor/components/arbor_expander","spectrum/table","dig-components/buttons","dig-components/controls","dig-components/modal","dig-components/typography","dig-components/icons","dig-components/icons/src","modules/clean/datetime","modules/clean/account_page/widgets/linked_apps/logger"],(function(e,t,n,a,o,r,s,i,c,l,p,u,d,_,m,f,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),r=n.__importStar(r),t.LinkedAppsPublisherInfo=function(e){var t=e.appInfo,n=t.publisher_company||t.name;return t.publisher_url?a.default.createElement(d.Link,{href:t.publisher_url,target:"_blank",rel:"noopener noreferrer",onClick:function(){return v.logEvent("click_developer_link",v.appInfoExtras(t))},hasNoUnderline:!0},n):a.default.createElement(d.Text,null,n)};var g=function(e){var t=e.appInfo;return a.default.createElement("div",{className:"linked-apps-headline"},t.icon_url?a.default.createElement("img",{src:t.icon_url,className:"linked-apps-headline__icon",alt:""}):a.default.createElement(_.UIIcon,{className:"linked-apps-headline__icon",size:"large",src:m.ImageLine}),a.default.createElement("div",{className:"linked-apps-headline__heading"},a.default.createElement(d.Text,{isBold:!0},t.name),a.default.createElement(d.Text,{size:"small",color:"faint"},t.publisher_company||t.name)))},h=function(e){var t,n=e.appInfo,s=o._("This app no longer has access to your files because you deleted its app folder. You will need to reinstall the app for it to work again."),i="no_access"===n.access_type?s:n.access_type_desc,c="app_action"!==n.type&&(null===(t=n.scope_list_messages)||void 0===t?void 0:t.length)?a.default.createElement("ul",{className:"linked-apps-info-table__value-ul"},n.scope_list_messages.map((function(e){return a.default.createElement("li",{className:"linked-apps-info-table__value-li",key:"id="+n.id+";message="+e,dangerouslySetInnerHTML:{__html:r.sanitize(e)}})}))):null;return null!=c?c:a.default.createElement(d.Text,null,i)},y=function(e){var n=e.appInfo,r=n.first_linked_ts?f.format_date(new Date(n.first_linked_ts),"MMMM d, yyyy"):null;return a.default.createElement(c.Table,{columnFlex:[1,7],className:"linked-apps-info-table"},a.default.createElement(c.TableBody,null,r?a.default.createElement(c.TableRow,{className:"linked-apps-info-table__row"},a.default.createElement(c.TableCell,{className:"linked-apps-info-table__key"},a.default.createElement(d.Text,{color:"faint",isBold:!0},o._("Connected on"))),a.default.createElement(c.TableCell,{className:"linked-apps-info-table__value"},a.default.createElement(d.Text,null,r))):null,a.default.createElement(c.TableRow,{className:"linked-apps-info-table__row"},a.default.createElement(c.TableCell,{className:"linked-apps-info-table__key"},a.default.createElement(d.Text,{color:"faint",isBold:!0},o._("Developer"))),a.default.createElement(c.TableCell,{className:"linked-apps-info-table__value"},a.default.createElement(t.LinkedAppsPublisherInfo,{appInfo:n}))),a.default.createElement(c.TableRow,{className:"linked-apps-info-table__row"},a.default.createElement(c.TableCell,{className:"linked-apps-info-table__key"},a.default.createElement(d.Text,{color:"faint",isBold:!0},o._("Permissions"))),a.default.createElement(c.TableCell,{className:"linked-apps-info-table__value"},a.default.createElement(h,{appInfo:n})))))},b=function(e){var t=e.appName,n=e.checked,r=e.onChange,s=o._("Also remove <st>%(app_name)s</st> folder from my Dropbox."),i=o.intl.formatMessage(s,{st:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)},app_name:t});return a.default.createElement("div",{className:"linked-apps-modal__checkbox"},a.default.createElement(p.Checkbox,{checked:n,onChange:r,id:"linked-apps-modal__checkbox"}),a.default.createElement("label",{htmlFor:"linked-apps-modal__checkbox"},a.default.createElement(d.Text,{className:"linked-apps-modal__checkbox-message"},i)))},k=function(e){var t=e.open,n=e.appInfo,r=e.onClickClose,s=e.onClickDisconnect,i=o._("Are you sure you want to disconnect <st>%(app_name)s</st>? This app will no longer have permission to access your Dropbox."),c=o.intl.formatMessage(i,{st:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)},app_name:n.name}),p="app_action"!==n.type&&n.uses_sandbox&&n.app_folder,_=a.useState(!1),m=_[0],f=_[1];return a.default.createElement(u.Modal,{open:t,overlayClassName:"linked-apps-modal",onRequestClose:r},a.default.createElement(u.Modal.Header,{hasBottomSpacing:"title-standard"},a.default.createElement(d.Title,null,o.intl.formatMessage(o._("Disconnect %(app_name)s?"),{app_name:n.name}))),a.default.createElement(u.Modal.Body,null,a.default.createElement(d.Text,null,c),p?a.default.createElement(b,{appName:n.name,checked:m,onChange:function(){return f(!m)}}):null),a.default.createElement(u.Modal.Footer,null,a.default.createElement(l.Button,{variant:"opacity",onClick:r,autoFocus:!0},o._("Cancel")),a.default.createElement(l.Button,{variant:"primary",onClick:function(){s(n,m),r()}},o._("Disconnect"))))},C=function(e){var t=e.appInfo,n=e.appType,r=e.onClickDisconnect,s=a.useState(!1),i=s[0],c=s[1];return a.default.createElement("div",{className:"linked-apps-body"},a.default.createElement(y,{appInfo:t}),a.default.createElement("div",{className:"linked-apps-actions"},a.default.createElement(l.Button,{className:"linked-apps-actions__disconnect",variant:"primary",onClick:function(){v.logEvent("click_disconnect_app",v.appInfoExtras(t)),c(!0)},disabled:"team"===n},o._("Disconnect")),a.default.createElement(k,{open:i,appInfo:t,onClickDisconnect:r,onClickClose:function(){return c(!1)}})))},E=function(e,t){var n,a;return(null!==(n=t.first_linked_ts)&&void 0!==n?n:0)-(null!==(a=e.first_linked_ts)&&void 0!==a?a:0)};t.LinkedAppsAccordion=s.requireCssWithComponent((function(e){var t=e.appType,n=e.appInfos,o=e.onClickDisconnect,r=n.sort(E),s=r.map((function(e){return{id:"api_app"===e.type?e.id:e.action_id,headline:a.default.createElement(g,{appInfo:e}),body:a.default.createElement(C,{appType:t,appInfo:e,onClickDisconnect:o})}}));return a.default.createElement(i.ArborExpander,{items:s,onClick:function(e,t){var n;if(t===i.ArborExpanderItemAction.OPEN){var a=null!==(n=r[e])&&void 0!==n?n:{};v.logEvent("click_expand_connected_app_details",v.appInfoExtras(a))}}})}),["/static/css/spectrum/index.web-vfl_-DzRS.css","/static/css/account/pagelet/index-vfln0ueq6.css","/static/css/dig-components/index.web-vflm0_tak.css","/static/js/spectrum-arbor/index.web-vfl1BIK7j.css"])})),define("modules/clean/account_page/widgets/linked_apps/logger",["require","exports","tslib","modules/clean/logging/telemetry","modules/clean/logging/hive/schemas/web-app_directory_connected_apps"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new((a=n.__importStar(a)).HiveLogger);t.logEvent=function(e,t){var n=new o.AppDirectoryConnectedAppsRow({event_name:e,event_extras:JSON.stringify(t)});r.log(n)},t.appInfoExtras=function(e){return{app_type:e.type,app_id:"api_app"===e.type?e.id:void 0,action_id:"app_action"===e.type?e.action_id:void 0,app_name:e.name}}})),define("modules/clean/logging/hive/schemas/web-app_directory_connected_apps",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.category="web-app_directory_connected_apps",this.user_id=null,this.session_id=null,this.request_id=null,this.url=null,this.event_name=e.event_name,this.event_extras=e.event_extras,Object.seal(this)};t.AppDirectoryConnectedAppsRow=n})),define("dig-components/modal",["require","exports","tslib","dig-components/modal/modal"],(function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.__exportStar(a,t)})),define("dig-components/modal/body",["require","exports","tslib","react","dig-components/typography/text"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),t.Body=a.forwardRef((function(e,t){var r=e.children,s=e.className,i=void 0===s?"":s,c=n.__rest(e,["children","className"]),l="dig-Modal-content-body "+i;return a.createElement(o.Text,Object.assign({ref:t,className:l,tagName:"div",color:"standard"},c),r)})),t.Body.displayName="Modal.Body"})),define("dig-components/modal/footer",["require","exports","tslib","react","classnames"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),o=n.__importDefault(o),t.Footer=function(e){var t=e.hasTopBorder,r=void 0!==t&&t,s=e.children,i=e.className,c=void 0===i?"":i,l=n.__rest(e,["hasTopBorder","children","className"]),p=o.default("dig-Modal-content-footer",{"dig-Modal-content-footer--hasTopBorder":r},c);return a.createElement("div",Object.assign({className:p},l),s)},t.Footer.displayName="Modal.Footer"})),define("dig-components/modal/header",["require","exports","tslib","react","classnames"],(function(e,t,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),o=n.__importDefault(o),t.Header=function(e){var t=e.hasBottomSpacing,r=void 0===t?"title-small":t,s=e.children,i=e.className,c=void 0===i?"":i,l=n.__rest(e,["hasBottomSpacing","children","className"]),p=o.default("dig-Modal-content-header",{"dig-Modal-content-header--margin-title-standard":"title-standard"===r},c);return a.createElement("div",Object.assign({className:p},l),s)},t.Header.displayName="Modal.Header"})),define("dig-components/modal/modal",["require","exports","tslib","classnames","react","react-modal","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/modal/header","dig-components/modal/body","dig-components/modal/footer","focus-visible"],(function(e,t,n,a,o,r,s,i,c,l,p,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importDefault(a),o=n.__importStar(o),r=n.__importDefault(r);var d=function(e){switch(e){case"small":return 450;case"standard":return 600;case"large":return 700}return e};t.Modal=function(e){var t=e.children,l=e.className,p=e.withCloseButton,u=e.width,_=void 0===u?"standard":u,m=e.open,f=void 0!==m&&m,v=e.onRequestClose,g=e.overlayClassName,h=n.__rest(e,["children","className","withCloseButton","width","open","onRequestClose","overlayClassName"]),y=a.default("dig-Modal-content",l),b=v;return o.createElement(r.default,Object.assign({},h,{isOpen:f,shouldCloseOnOverlayClick:!0,onRequestClose:v,className:y,bodyOpenClassName:"dig-Modal-body--open",htmlOpenClassName:"dig-Modal-html--open",overlayClassName:a.default("dig-Modal-overlay",g),closeTimeoutMS:200,style:{content:{width:d(_)}}}),!!p&&o.createElement(s.IconButton,{variant:"transparent",className:"dig-Modal-close-btn","aria-label":p,onClick:b},o.createElement(i.UIIcon,{src:c.CloseLine})),o.createElement("div",{className:"dig-Modal-content-inner"},t))},t.Modal.Header=l.Header,t.Modal.Body=p.Body,t.Modal.Footer=u.Footer,t.Modal.displayName="Modal",t.Modal.setAppElement=r.default.setAppElement}));
//# sourceMappingURL=pkg-account_connected_apps.min.js-vflymMnax.map