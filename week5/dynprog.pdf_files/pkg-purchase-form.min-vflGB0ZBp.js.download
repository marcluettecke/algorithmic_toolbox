define("modules/clean/react/growth_pages/promo/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(function(e){e[e.NOT_APPLICABLE=0]="NOT_APPLICABLE",e[e.EXTRA_TIME_MONTHS=1]="EXTRA_TIME_MONTHS",e[e.EXPERIMENTAL_PLAN=2]="EXPERIMENTAL_PLAN",e[e.PERCENT_DISCOUNT_PRETAX=3]="PERCENT_DISCOUNT_PRETAX",e[e.TRIAL=4]="TRIAL"})(t.PromoSpecType||(t.PromoSpecType={}))})),define("modules/clean/react/payments/buy/components/plan/exp_plan_selection",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/analytics","modules/constants/trademark"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPlanChange=function(e,r,a){var n=e.currentTarget;a=a||n.value,t.handlePlanChange(parseInt(a,10))},t.onPlanLabelClick=function(e){t.handlePlanChange(e)},t}return r.__extends(t,e),t.prototype.handlePlanChange=function(e){if(e!==this.props.productPlanType){var t=e===o.ProductPlanType.PROFESSIONAL&&!0===this.props.showTrialVersion;this.props.actions.updateSelectedPlan(e,t),this.props.updateHistory(2,e,void 0,t),s.ProEventsLogger.log(s.ProEventNames.BUY_TRY_PAGE_CHECKOUT,{type:"QuotaSwitch",selectedPlanType:e})}},t.prototype.renderPlusPlanBlock=function(){var e=this,t=this.props,r=t.isFromLowSpace,n=t.productPlanType,s=t.quotaStrings,u=a.default.createElement("span",{id:"plan-info__label--plus",className:"plan-info__label plan-info__label--bold plan-info__label--plus",onClick:function(){return e.onPlanLabelClick(o.ProductPlanType.PLUS)},"aria-hidden":"true"},s.plus),c="Dropbox "+l.TRADEMARK_PLUS;return a.default.createElement("div",{className:"plan-info__choice plan-info__plus"},a.default.createElement(i.LabeledRadioInput,{name:"plan_id",inputId:"plan-info__radio--plus",ariaLabelId:"plan-info__label--plus",className:"plan-info__radio",labelClassName:"plan-info__container",value:o.ProductPlanType.PLUS.toString(),checked:n===o.ProductPlanType.PLUS,labelSpan:u,onClickOrChange:this.onPlanChange}),a.default.createElement("div",{className:"plan-info__subtitle plan-info__subtitle--plus"},r&&c))},t.prototype.renderProfessionalPlanBlock=function(){var e=this,t=this.props,r=t.isFromLowSpace,s=t.isMontana,u=t.productPlanType,c=t.quotaStrings,p=t.showTrialVersion,d=a.default.createElement("span",{id:"plan-info__label--pro",className:"plan-info__label plan-info__label--bold plan-info__label--pro",onClick:function(){return e.onPlanLabelClick(o.ProductPlanType.PROFESSIONAL)},"aria-hidden":"true"},c.professional),m="Dropbox "+l.TRADEMARK_PROFESSIONAL,h=n.intl.formatMessage(n._("With <smart_sync>Smart Sync</smart_sync> and <showcase>Showcase</showcase>"),{smart_sync:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("a",{className:"plan-info__subtitle--underline",href:"/smart-sync"},e)},showcase:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("a",{className:"plan-info__subtitle--underline",href:"/showcase"},e)}}),f=n.intl.formatMessage(n._("With <showcase>Dropbox Showcase</showcase>"),{showcase:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("a",{className:"plan-info__subtitle--underline",href:"/showcase"},e)}}),y=n.intl.formatMessage(n._("Try free for %(pro_trial_days)d days"),{pro_trial_days:this.props.proTrialDays});return a.default.createElement("div",{className:"plan-info__choice plan-info__pro"},a.default.createElement(i.LabeledRadioInput,{name:"plan_id",inputId:"plan-info__radio--pro",ariaLabelId:"plan-info__label--pro",className:"plan-info__radio",labelClassName:"plan-info__container",value:o.ProductPlanType.PROFESSIONAL.toString(),checked:u===o.ProductPlanType.PROFESSIONAL,labelSpan:d,onClickOrChange:this.onPlanChange}),a.default.createElement("div",{className:"plan-info__subtitle plan-info__subtitle--pro"},r?m:s?f:h),p&&a.default.createElement("div",{className:"plan-info__subtitle plan-info__subtitle--green"},y))},t.prototype.render=function(){return a.default.createElement("div",{className:"grid__container plan-info"},this.renderPlusPlanBlock(),a.default.createElement("div",{className:"plan-info__spacer"}),this.renderProfessionalPlanBlock())},t})((a=r.__importDefault(a)).default.Component);t.ExpPlanSelection=u})),define("modules/clean/react/payments/buy/components/buy_purchase_form",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/raf_throttle","modules/clean/auth/common/recaptcha","modules/clean/web_timing_logger","modules/clean/analytics","modules/clean/react/payments/buy/components/account/new_account_input","modules/clean/react/payments/buy/components/plan/schedule_selection","modules/clean/react/payments/buy/components/payments/buy_payment_info_section","modules/clean/react/payments/buy/components/payments/order_summary","modules/clean/react/payments/buy/components/payments/worldpay_entity_info","modules/clean/react/payments/buy/components/plan/exp_plan_selection","modules/clean/react/async/loadable","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/growth_pages/promo/types","modules/core/exception","modules/clean/payments/skus/subscription_service","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_change_plan","modules/core/notify","modules/clean/payments/skus/pricing_data","modules/clean/ajax"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,h,f,y,_,g,v,S,C,b,E,P,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),l=r.__importStar(l),S=r.__importStar(S),F=r.__importStar(F);var N=y.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/payments/buy/components/account/user_selector"],t,r)})).then(r.__importStar).then((function(e){return e.UserSelectorPanel}))}}),T=(function(e){function t(t){var r=e.call(this,t)||this;if(r.paymentSection=a.default.createRef(),r.variant="row",r.setCaptchaComponent=function(e){r.captchaComponent=e},r.submitForm=function(e){var t,a=((t={})[_.PaymentMethod.CreditCard]="/pro/ajax_buy",t[_.PaymentMethod.PayPal]="/pro/ajax_paypal_buy",t[_.PaymentMethod.DirectDeposit]="/payments/ajax_sepa_buy",t[_.PaymentMethod.Ideal]="/payments/ajax_ideal_buy",t);r.onSubmitProBuyForm({trigger:e,url:a[r.props.formData.paymentMethod.formattedValue],useSelectedUser:r.shouldUseSelectedUser()})},r.handleSubmitTryForm=function(e){e.preventDefault(),r.onSubmitFormWithCaptchaScore()},r.submitTryForm=function(e){var t;u.ProEventsLogger.log("clicked_start_free_trial_cta_"+r.props.planName.toLowerCase());var a=((t={})[_.PaymentMethod.CreditCard]="/pro/ajax_try",t[_.PaymentMethod.PayPal]="/pro/ajax_paypal_try",t);r.onSubmitProBuyForm({trigger:e,url:a[r.props.formData.paymentMethod.formattedValue],useSelectedUser:!1})},r.onSubmitProBuyForm=function(e){var t=e.trigger,a=e.url,n=e.useSelectedUser,o=r.props.promoSpec,i={cont:r.props.continueURI,is_pro_buy_form:!0};r.saveState(),o&&(i.is_pro_buy_form=!1,i.promo_ids=o.id,o.cashCode&&(i.code=o.cashCode)),!r.props.pageState.useRevenueApi||r.props.formData.paymentMethod.formattedValue===_.PaymentMethod.CreditCard&&"US"===r.props.formData.countryCode.formattedValue&&!r.props.showTrialVersion?r.props.actions.submitProBuyForm({additionalData:i,allowSubmitWithoutTOS:!1,captchaComponentRef:r.captchaComponent,handle3DsMessage:r.paymentInfoSection.getCreditCardFrame().handle3DsMessage,enableBinRouting:!0,prepareForSubmission:r.prepareForSubmission.bind(r),showCpf:r.props.showCpf,showCpfName:r.props.showCpfName,trigger:t,url:a,useSelectedUser:n,psd2AddressFields:r.props.experiments.psd2AddressFields,webPlusDirect:!!r.props.experiments.webPlusDirect,paymentPayPalV2Flow:r.props.experiments.paymentPayPalV2Flow}):F.WebRequest({url:"/pro/ajax_fetch_sub_change_plans",type:"POST",success:function(e){var o=JSON.parse(e);if(0===o.length)P.Notify.error(w.PricingDataException.notifyErrorMessagePersonal,20),S.reportException({err:new Error("/pro/ajax_fetch_sub_change_plans returned 0 Subscription Change Plans"),severity:S.SEVERITY.NONCRITICAL});else{var s=o.map((function(e){return E.SubscriptionChangePlan.deserialize(e)}));s=s.filter((function(e){return e.subState.planSku&&e.subState.planSku.code===r.props.pricingState.revenueApiProductCode&&e.subState.planSku.productType===r.props.productPlanType}));var l=new C.SubscriptionService,u=r.props,c=u.formData,p=u.pageState,d={countryCode:c.countryCode.formattedValue,zipCode:c.zipCode.formattedValue,vat:c.vat.errorState?"":c.vat.formattedValue},m=[];s&&(m=s.map((function(e){return b.SubscriptionDiff.fromSubscriptionStatus(e)})));var h=p.promoSpec&&p.promoSpec.cashCode&&p.promoSpec.id!==v.PromoSpecType.TRIAL?{cashCode:p.promoSpec.cashCode}:void 0;l.priceSet(m,d,h,!0).then((function(e){r.props.actions.submitProBuyForm({additionalData:i,allowSubmitWithoutTOS:!1,captchaComponentRef:r.captchaComponent,handle3DsMessage:r.paymentInfoSection.getCreditCardFrame().handle3DsMessage,enableBinRouting:!0,prepareForSubmission:r.prepareForSubmission.bind(r),showCpf:r.props.showCpf,showCpfName:r.props.showCpfName,trigger:t,url:a,useSelectedUser:n,psd2AddressFields:r.props.experiments.psd2AddressFields,subChangePlansIgnoreRevenueAPI:e,paymentPayPalV2Flow:r.props.experiments.paymentPayPalV2Flow})})).catch((function(e){S.reportException({err:e,severity:S.SEVERITY.CRITICAL,tags:["revenue_api","payments"]})}))}},error:function(e,t,r){if(0!==e.status){P.Notify.error(w.PricingDataException.notifyErrorMessagePersonal,20);var a="/pro/ajax_fetch_sub_change_plans failed to return Subscription Change Plans in the work-around code Revenue API (status: "+e.status+")";S.reportException({err:new Error(a),severity:S.SEVERITY.CRITICAL})}}})},r.onSubmitFormWithCaptchaScore=function(){r.captchaComponent&&r.captchaComponent.getWrappedComponent().submit()},r.resubmitForm=function(e){void 0===e&&(e=g.SubmitFormTriggerType.ButtonClick),r.props.showTrialVersion?r.submitTryForm(e):r.submitForm(e)},r.handleChange=function(){var e="none";if(window.innerWidth>=736){var t=r.state.elementPositions,a=window.pageYOffset||document.documentElement.scrollTop,n=t.columnTop-r.stickyColumnBuffer,o=t.paymentSectionTop-r.stickyColumnBuffer;e=a>=n&&a<=o?"fixed":a>o?"flex-end":"flex-start"}r.state.stickyElementState!==e&&r.setState({stickyElementState:e})},r.handleResize=function(){r.getElementPositions()},r.getElementPositions=function(){var e=r.paymentSection;if(e&&e.current){var t=r.summaryColumn.getBoundingClientRect(),a=r.stickyElement.getBoundingClientRect(),n=e.current.getBoundingClientRect(),o={columnTop:t.top+window.pageYOffset,columnLeft:t.left+window.pageXOffset,columnWidth:t.width,paymentSectionTop:n.top+window.pageYOffset,stickyElementHeight:a.height,windowWidth:document.documentElement.clientWidth};r.setState({elementPositions:o},r.handleChange)}},r.onLoginClick=function(){u.GrowthEventsLogger.log("buy_checkout_sign_in_modal",{action:"click",location:"in_product"}),r.props.actions.toggleExistingAccount()},r.onCreateClick=function(e){return function(){e&&u.GrowthEventsLogger.log(e,{action:"click",location:"in_product"}),r.props.actions.toggleNewAccount()}},r.handlePress=function(e){!r.props.pageState.isPaymentOptionsSurveyOpen&&"Enter"===e.key&&e.target instanceof Element&&("INPUT"===e.target.tagName||"SELECT"===e.target.tagName)&&(e.preventDefault(),r.onSubmitFormWithCaptchaScore())},r.updateSelectedUser=function(e,t){u.GrowthEventsLogger.log("buy_checkout_choose_user",{action:t,location:"in_product"}),r.props.actions.updateSelectedUser(e)},r.getCreateAccountLinkProps=function(){var e=r,t=e.onCreateClick,a=e.onLoginClick,n=e.props.pageState,i=n.preauthUser,s=n.showCreateAccount,l=i?s?"choose an account":"create an account":"use existing Dropbox account";return{onClick:i?t(s?"buy_checkout_toggle_choose_account":"buy_checkout_toggle_create_account"):a,linkKey:"create_account",linkText:o._("or <create_account>%(create_link_text)s</create_account>"),otherFormatters:{create_link_text:l}}},r.scrollThrottle=new i.RafThrottle(r.handleChange),r.resizeThrottle=new i.RafThrottle(r.handleResize),r.stickyColumnBuffer=50,r.state={stickyElementState:"flex-start",elementPositions:{columnTop:250,columnLeft:45,columnWidth:500,paymentSectionTop:900,stickyElementHeight:550,windowWidth:1e3},hasLoadedSubChangePlans:!1},r.props.showTrialVersion){var n=r.props.pageState.paymentFormSpec;r.props.actions.updatePaymentMethod(n.default_payment_method())}return r.variant=r.props.variant?r.props.variant:"row",r}return r.__extends(t,e),t.prototype.prepareForSubmission=function(){return this.paymentInfoSection.prepareForSubmission()},t.prototype.shouldUseSelectedUser=function(){return"V1"===this.props.experiments.subgrowthBuyUniversalPreauth&&null!=this.props.pageState.suggestedUser&&!this.props.pageState.showCreateAccount||"V1"===this.props.experiments.subgrowthProBuyPreauthAccountChooser&&null!=this.props.pageState.preauthUser&&!this.props.pageState.showCreateAccount},t.prototype.getValue=function(e,t){var r=sessionStorage.getItem(e);return null!=r?r:t},t.prototype.loadState=function(){try{if(!this.props.experiments.cachePaymentUIFields)return;if(void 0===sessionStorage)return;this.props.actions.updateFirstName(this.getValue("firstName",this.props.formData.firstName.rawValue)),this.props.actions.updateLastName(this.getValue("lastName",this.props.formData.lastName.rawValue)),this.props.actions.updateEmail(this.getValue("email",this.props.formData.email.rawValue)),this.props.actions.updateZipCode(this.getValue("zipCode",this.props.formData.zipCode.rawValue));var e=this.getValue("countryCode",this.props.formData.countryCode.rawValue);this.props.actions.updateCountryCode(e);var t=Number(this.getValue("paymentMethod",""+this.props.formData.paymentMethod.rawValue));this.props.pageState.paymentFormSpec.available_payment_methods_for_country(e).includes(t)&&this.props.actions.updatePaymentMethod(t),this.props.experiments.psd2AddressFields&&(this.props.actions.updateAddress(this.getValue("address",this.props.formData.address.rawValue)),this.props.actions.updateCity(this.getValue("city",this.props.formData.city.rawValue)),this.props.actions.updateName(this.getValue("name",this.props.formData.name.rawValue)))}catch(e){S.reportException({err:new Error("Error loading payment state"+e.message),severity:S.SEVERITY.NONCRITICAL})}},t.prototype.saveState=function(){try{if(!this.props.experiments.cachePaymentUIFields)return;if(void 0===sessionStorage)return;sessionStorage.setItem("firstName",this.props.formData.firstName.rawValue),sessionStorage.setItem("lastName",this.props.formData.lastName.rawValue),sessionStorage.setItem("email",this.props.formData.email.rawValue),sessionStorage.setItem("zipCode",this.props.formData.zipCode.rawValue),sessionStorage.setItem("countryCode",this.props.formData.countryCode.rawValue),sessionStorage.setItem("paymentMethod",""+this.props.formData.paymentMethod.rawValue),this.props.experiments.psd2AddressFields&&(sessionStorage.setItem("address",""+this.props.formData.address.rawValue),sessionStorage.setItem("city",""+this.props.formData.city.rawValue),sessionStorage.setItem("name",""+this.props.formData.name.rawValue))}catch(e){S.reportException({err:new Error("Error saving payment state"+e.message),severity:S.SEVERITY.NONCRITICAL})}},t.prototype.componentDidMount=function(){l.mark_time_to_interactive(),this.getElementPositions(),window.addEventListener("resize",this.resizeThrottle.request),"row"===this.variant&&window.addEventListener("scroll",this.scrollThrottle.request),"orientation"in window&&window.addEventListener("orientationchange",this.resizeThrottle.request),this.loadState()},t.prototype.componentDidUpdate=function(e,t){var r=this.props,a=r.pricingState;r.pageState.useRevenueApi||!this.state.hasLoadedSubChangePlans&&a.currentTransitionPrices.totalPrice&&(this.handleResize(),this.setState({hasLoadedSubChangePlans:!0}))},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this.scrollThrottle.request),window.removeEventListener("resize",this.resizeThrottle.request)},t.prototype.renderPaymentForm=function(){var e,t=this,n=this.props,i=n.ccIframeUrl,s=n.countryList,l=n.experiments,u=n.idealBanks,m=n.initialPricingStrings,h=n.locale,y=n.formData,_=n.pageState,g=n.pricingState,v=n.showTrialVersion,S=n.trialLength,C=n.quotaStrings,b=n.updateHistory,E=n.useAUTaxInclusivePricing,P=n.showPlusTryRedesign,w=function(e){return void 0===e&&(e=!0),e?o._("%(index)s. Choose your space"):o._("Choose your space")},F=function(e){return void 0===e&&(e=!0),e?o._("%(index)s. Choose your billing cycle"):o._("Choose your billing cycle")},T=function(e){return void 0===e&&(e=!0),e?o._("%(index)s. Create your account"):o._("Create your account")},k=function(e){return void 0===e&&(e=!0),e?o._("%(index)s. Choose account"):o._("Choose account")},D=function(e){return void 0===e&&(e=!0),e?o._("%(index)s. Enter payment details"):o._("Enter payment details")};_.showPlanSwitchRadios&&(e=function(e,r){return a.default.createElement(V,{index:e,key:"choose-space-section-"+e,modifier:"plan-selection",title:w(r)},a.default.createElement(f.ExpPlanSelection,{actions:t.props.actions,isMontana:"ON"===l.expMontanaMasterSwitch,productPlanType:y.productPlanType.rawValue,proTrialDays:S,quotaStrings:C,updateHistory:b,showTrialVersion:"ON"===l.ujProfessionalTrial,isFromLowSpace:"V1"===l.expMontanaOptimizationReroute}))});var M,B=a.default.createElement(p.ScheduleSelection,{actions:this.props.actions,displayPrices:g.displayPrices,formData:y,initialPricingStrings:m,locale:h,subgrowthProBuyStep2PricingMessaging:l.subgrowthProBuyStep2PricingMessaging,useAUTaxInclusivePricing:E,showTrialVersion:v}),A=_.suggestedUser&&"V1"===l.subgrowthBuyUniversalPreauth;if(!_.userInfo.email||_.preauthUser){if(!_.preauthUser){var L=a.default.createElement(I,{onClick:A?this.onCreateClick():this.onLoginClick,linkKey:"existing_account",linkText:A?o._("or <existing_account>choose an account</existing_account>"):o._("or <existing_account>use existing Dropbox account</existing_account>")});M=function(e,r){return a.default.createElement(x,{index:e,key:"create-account-section-"+e,link:L,title:T(r)},a.default.createElement(c.NewAccountInput,{actions:t.props.actions,pageState:_,formData:y,paymentFormErrorsExperiment:l.paymentFormErrorsExperiment}))}}if(A&&_.suggestedUser&&!_.showCreateAccount){var O=a.default.createElement(I,{onClick:this.onCreateClick(),linkKey:"create_account",linkText:o._("or <create_account>create an account</create_account>")});M=function(e,r){return a.default.createElement(x,{index:e,key:"create-account-section-"+e,link:O,title:k(r)},a.default.createElement(N,{users:[_.suggestedUser],selected:y.selectedUser.hasSelection?y.selectedUser.rawValue:void 0,onClickUser:t.updateSelectedUser,onDeselect:t.updateSelectedUser,onClickLogin:t.onLoginClick,error:y.selectedUser.showError?o._("Please select or create an account to upgrade."):void 0}))}}"V1"===l.subgrowthProBuyPreauthAccountChooser&&(M=function(e,n){return a.default.createElement(x,{index:e,key:"create-account-section-"+e,link:a.default.createElement(I,r.__assign({},t.getCreateAccountLinkProps())),title:_.preauthUser&&!_.showCreateAccount?k(n):T(n)},_.preauthUser&&!_.showCreateAccount?a.default.createElement(N,{users:[_.preauthUser],selected:y.selectedUser.hasSelection?y.selectedUser.rawValue:void 0,onClickUser:t.updateSelectedUser,onDeselect:t.updateSelectedUser,onClickLogin:t.onLoginClick,error:y.selectedUser.showError?o._("Please select or create an account to upgrade."):void 0,isPreauth:!0}):a.default.createElement(c.NewAccountInput,{actions:t.props.actions,pageState:_,formData:y,paymentFormErrorsExperiment:l.paymentFormErrorsExperiment}))})}var U=a.default.createElement(d.PaymentInfoSection,{showSepaLogo:"V1"===l.subgrowthProBuyReplaceDebitWithSepaLogo,paymentSpec:_.paymentFormSpec,iframeUrl:i,idealBanks:u,countryList:s,formData:y,productPlanType:this.props.productPlanType,showCpf:this.props.showCpf,showCpfName:this.props.showCpfName,psd2AddressFields:this.props.experiments.psd2AddressFields,optimizeCpf:_.optimizeCpf,actions:this.props.actions,ref:function(e){t.paymentInfoSection=e},showTrialVersion:v,hidePaymentMethodSelector:!1,enableIdealReact:!1,userInfo:this.props.pageState.userInfo,submitForm:this.resubmitForm,paymentOptionsExperiment:l.paymentOptionsExperiment,isPaymentOptionsSurveyOpen:this.props.pageState.isPaymentOptionsSurveyOpen,paymentFormErrorsExperiment:l.paymentFormErrorsExperiment,paymentPayPalV2Flow:l.paymentPayPalV2Flow,braintreeClientToken:this.props.braintreeClientToken}),R=[e,function(e,t){return a.default.createElement(V,{index:e,key:"billing-schedule-section-"+e,modifier:"schedule-selection",title:F(t)},B)},M,function(e,r){return a.default.createElement(V,{forwardRef:t.paymentSection,index:e,key:"payment-section-"+e,modifier:"billing",title:D(r)},U)}],q=!0;if(P){R=[M,function(e,r){return a.default.createElement(V,{forwardRef:t.paymentSection,key:"plus-try-redesign-section-"+e,modifier:"billing",title:o._("Add your billing info for later")},B,U)}],q=!1}var W=R.filter(Boolean).map((function(e,t){return e(t+1,q)}));return a.default.createElement("form",{className:"payment-form grid__container",method:"post",onKeyPress:this.handlePress},W)},t.prototype.renderOrderSummary=function(){var e=this.props,t=e.actions,r=e.buyLink,n=e.experiments,o=e.formData,i=e.pageState,s=e.planName,l=e.planNamePrefixedWithDropbox,u=e.pricingState,c=e.productPlanType,p=e.promoSpec,d=e.trialLength,h=e.showTrialVersion,f=e.taxNamesByCountry,y=e.showPlusTryRedesign,_="",g="",v=[];return i.useRevenueApi&&(_=u.revenueApiPrice||"",g=u.revenueApiCurrency||"",v=u.revenueApiTaxLines||[]),a.default.createElement("div",{className:"grid__item"},a.default.createElement(m.OrderSummary,{actions:t,buyLink:r,formVariant:this.variant,formData:o,currentTransitionPrices:u.currentTransitionPrices,loadingPrices:u.loadingPrices,onClick:this.onSubmitFormWithCaptchaScore,onTryClick:this.handleSubmitTryForm,pageState:i,planName:s,planNamePrefixedWithDropbox:l,productPlanType:c,taxNamesByCountry:f,showTrialVersion:h,promoSpec:p,paymentFormErrorsExperiment:n.paymentFormErrorsExperiment,showPlusTryRedesign:y,trialLength:d,revenueApiPrice:_,revenueApiCurrency:g,revenueApiTaxLines:v}))},t.prototype.renderIncludedFeatures=function(){var e=this.props.includedFeaturesContent,t=this.props.experiments;if(e){var r="ON"===t.subgrowthProBuyFeaturesMobile,o=n.default({"included-features":!0,grid__container:!0,"included-features--show-on-mobile":r});return a.default.createElement("div",{className:o},a.default.createElement("p",{className:"included-features__title grid__item"},e.title),a.default.createElement("ul",{className:"included-features__list grid__container"},e.items.map((function(e,t){return a.default.createElement("li",{className:"included-features__feature grid__item--1-2",key:"included-"+t},e.text)}))))}},t.prototype.renderWorldpayEntityText=function(){return-1===t.excludeWorldpayEntityTextForCountry.indexOf(this.props.formData.countryCode.formattedValue)?a.default.createElement(h.WorldPayEntityInfo,null):null},t.prototype.render=function(){var e,t,o=this,i=this.state,l=i.elementPositions,u=i.stickyElementState,c="flex-start",p={msFlexAlign:"start"};if("flex-end"===u&&(c="flex-end",p={msFlexAlign:"end"}),"none"!==u){var d=l.paymentSectionTop-l.columnTop+l.stickyElementHeight;t=r.__assign({height:d,alignItems:c},p)}else t={alignItems:c,width:l.windowWidth,maxWidth:l.windowWidth};var m={};"fixed"===u&&(m={position:"fixed",top:this.stickyColumnBuffer,left:l.columnLeft,width:l.columnWidth});var h="column"===this.variant;return a.default.createElement("div",{className:n.default("PurchaseForm","grid__container",(e={},e["PurchaseForm--column"]=h,e))},a.default.createElement("div",{className:n.default("grid__item",{"grid__item--medium--11-24":!h})},this.renderPaymentForm()),!h&&a.default.createElement("div",{className:"grid__item--medium--1-12"}),a.default.createElement("div",{className:n.default("grid__item","PurchaseForm__summary-col",{"grid__item--medium--11-24":!h,"PurchaseForm__summary-col--full":h}),style:t,ref:function(e){o.summaryColumn=e}},a.default.createElement("div",{className:"grid__item",style:m,ref:function(e){o.stickyElement=e}},this.renderOrderSummary(),this.renderIncludedFeatures())),a.default.createElement("div",{className:"grid__item"},this.renderWorldpayEntityText()),a.default.createElement(s.Recaptcha,{ref:this.setCaptchaComponent,source:"BUY_PURCHASE_FORM",onSubmit:this.resubmitForm,email:this.props.pageState.userInfo.email||this.props.formData.email.formattedValue}))},t.excludeWorldpayEntityTextForCountry=["US","CA","MX"],t})(a.default.Component);t.BuyPurchaseForm=T;var k=function(){return a.default.createElement("hr",{"aria-hidden":"true",className:"payment-form__divider grid__item payment-form__divider"})},V=function(e){var t=e.children,n=e.forwardRef,i=e.index,s=e.modifier,l=e.title,u=r.__assign({className:"payment-form__section--"+s+" grid__item"},n?{ref:n}:{});return a.default.createElement("section",r.__assign({},u),a.default.createElement(k,null),a.default.createElement("div",{className:"payment-form__header grid__item"},i?o.intl.formatMessage(l,{index:i}):l),t)},x=function(e){var t=e.index,r=e.link,n=e.title,i=e.children;return a.default.createElement("section",{className:"payment-form__section grid__item"},a.default.createElement(k,null),a.default.createElement("div",{className:"payment-form__header grid__container grid--x-bookend"},a.default.createElement("div",{className:"payment-form__header--account"},t?o.intl.formatMessage(n,{index:t}):n),r),i)},I=function(e){var t,n=e.linkText,i=e.linkKey,s=e.onClick,l=e.otherFormatters,u=void 0===l?{}:l;return a.default.createElement("div",{className:"payment-form__login"},o.intl.formatMessage(n,r.__assign(((t={})[i]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("button",{"aria-label":"",key:"account-toggle",className:"account-toggle button--as-link",onClick:s,type:"button"},e)},t),u)))}})),define("modules/clean/react/payments/buy/components/account/new_account_input",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/web_timing_logger"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),o=r.__importStar(o);var u=(function(t){function u(){var e=null!==t&&t.apply(this,arguments)||this;return e.onFirstNameChanged=function(t){e.props.actions.updateFirstName(t.value)},e.onFirstNameBlur=function(t){"ON"===e.props.paymentFormErrorsExperiment&&e.props.actions.showFormFieldErrors(["firstName"],"FirstNameBlur")},e.onLastNameChanged=function(t){e.props.actions.updateLastName(t.value)},e.onLastNameBlur=function(t){"ON"===e.props.paymentFormErrorsExperiment&&e.props.actions.showFormFieldErrors(["lastName"],"LastNameBlur")},e.onEmailChanged=function(t){e.props.actions.updateEmail(t.value)},e.onEmailBlur=function(t){"ON"!==e.props.paymentFormErrorsExperiment?""!==t.value&&e.props.actions.showFormFieldErrors(["email"],"EmailBlur"):e.props.actions.showFormFieldErrors(["email"],"EmailBlur")},e.onPasswordChanged=function(t){e.props.actions.updatePassword(t.value)},e.onPasswordBlur=function(t){e.props.actions.showFormFieldErrors(["password"],"PasswordBlur")},e.toggleExistingAccount=function(){e.props.actions.toggleExistingAccount(!1)},e}return r.__extends(u,t),u.prototype.firstNameErrorString=function(){var e=this.props.formData.firstName;return e.showError&&!i.FormValueHelper.isValid(e)?n._("Please enter a valid first name."):""},u.prototype.lastNameErrorString=function(){var e=this.props.formData.lastName;return e.showError&&!i.FormValueHelper.isValid(e)?n._("Please enter a valid last name."):""},u.prototype.emailErrorMessage=function(){var e=this,t=this.props.formData.email;if(t.showError)switch(t.errorState){case o.EmailErrorState.Empty:return n._("Please enter an email address.");case o.EmailErrorState.NoAt:return n._("An email address must contain a single @");case o.EmailErrorState.BadUsername:var r=t.formattedValue.split("@")[0];return n.intl.formatMessage(n._("The username portion of the email address is invalid (the portion before the @: %(username)s)."),{username:r});case o.EmailErrorState.BadDomain:var i=t.formattedValue.split("@")[1];return""===i?n._("The domain portion of the email address is invalid (the portion after the @)."):n.intl.formatMessage(n._("The domain portion of the email address is invalid (the portion after the @: %(domain)s)."),{domain:i});case o.EmailErrorState.TakenWarning:return a.default.createElement("span",null,n._("This e-mail is already taken."));case o.EmailErrorState.TakenError:return a.default.createElement("span",null,n.intl.formatMessage(n._("This e-mail is already taken. <a_signin>Sign in</a_signin> or <a_forgot>reset your password</a_forgot>."),{a_signin:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{key:"a-signin",className:"login-register-switch-link",onClick:e.toggleExistingAccount},t)},a_forgot:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("a",{key:"a-forgot",href:"/forgot"},e)}}))}return""},u.prototype.passwordErrorString=function(){return this.props.formData.password.showError?n._("Passwords must be 6 characters or more."):""},u.prototype.renderPasswordStrengthMeter=function(e){return this.state&&this.state.passwordStrengthMeter?a.default.createElement(this.state.passwordStrengthMeter,{password:e}):void 0},u.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(a){switch(a.label){case 0:return[4,l.waitForTTI()];case 1:return a.sent(),[4,new Promise((function(t,r){e(["modules/clean/components/password_strength_meter"],t,r)})).then(r.__importStar)];case 2:return t=a.sent().PasswordStrengthMeter,this.setState({passwordStrengthMeter:t}),[2]}}))}))},u.prototype.render=function(){var e=this.props,t=e.formData,r=e.pageState,o=n._("Email"),i=n._("Password");return a.default.createElement("div",{className:"grid__item account-info grid__item--large--11-12"},a.default.createElement("div",{className:"account-info__name grid__container grid--x-bookend grid--y-top"},a.default.createElement(s.LabeledTextInput,{name:"fname",autocomplete:r.autocomplete?"given-name":"off",labelText:n._("First name"),containerClassName:"grid__item--fluid grid__item--margin-right--1-24",value:t.firstName.rawValue,onBlur:this.onFirstNameBlur,onChange:this.onFirstNameChanged,errorText:this.firstNameErrorString()}),a.default.createElement(s.LabeledTextInput,{name:"lname",autocomplete:r.autocomplete?"family-name":"off",labelText:n._("Last name"),containerClassName:"grid__item--fluid",value:t.lastName.rawValue,onBlur:this.onLastNameBlur,onChange:this.onLastNameChanged,errorText:this.lastNameErrorString()})),a.default.createElement("div",{className:"account-info__cred grid__container grid--x-bookend grid--y-top"},a.default.createElement(s.LabeledTextInput,{name:"account-email",autocomplete:r.autocomplete?"email":"off",type:"email",labelText:o,containerClassName:"grid__item--fluid grid__item--margin-right--1-24",value:t.email.rawValue,onBlur:this.onEmailBlur,onChange:this.onEmailChanged,errorText:this.emailErrorMessage()}),a.default.createElement("div",{className:"account-info__password grid__item--fluid"},this.renderPasswordStrengthMeter(t.password.rawValue),a.default.createElement(s.LabeledTextInput,{name:"password",type:"password",autocomplete:"new-password",labelText:i,containerClassName:"grid__item",value:t.password.rawValue,onChange:this.onPasswordChanged,onBlur:this.onPasswordBlur,errorText:this.passwordErrorString()}))))},u})(a.default.Component);t.NewAccountInput=u})),define("modules/clean/react/payments/buy/components/plan/schedule_selection",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,r,a,n,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScheduleChange=function(e,r,a){var n=e.currentTarget;a=a||n.value;var o=parseInt(a,10);o!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(o)},t.onPlanLabelClick=function(e){e!==t.props.formData.scheduleId.formattedValue&&t.props.actions.updateSchedule(e)},t}return r.__extends(t,e),t.prototype.getPricingStrings=function(){var e,t,r,a,n,i,s,l,u,c=this.props.initialPricingStrings;if(c)e=o.intl.formatMessage(o._("%(price)s / year"),{price:c.yearlyPrice}),n=o.intl.formatMessage(o._("%(price)s per year. Save %(savings)s"),{price:c.yearlyPrice,savings:c.yearlySavings}),t=o.intl.formatMessage(o._("%(price)s / month"),{price:c.monthlyPrice}),i=o.intl.formatMessage(o._("%(price)s per month"),{price:c.monthlyPrice}),r=o.intl.formatMessage(o._("%(price)s / year"),{price:c.yearlyWithoutSavings}),a=o.intl.formatMessage(o._("Equivalent to %(price)s / month"),{price:c.annualPriceAsMonthly}),s=o.intl.formatMessage(o._("%(yearly_price)s per year. Equivalent to %(monthly_equivalent)s per month"),{yearly_price:c.yearlyPrice,monthly_equivalent:c.annualPriceAsMonthly}),l=o.intl.formatMessage(o._("%(price)s / month"),{price:c.annualPriceAsMonthly}),u=o.intl.formatMessage(o._("%(price)s per month when billed yearly"),{price:c.annualPriceAsMonthly});else{var p=this.props.displayPrices,d=p.yearlyPrice,m=p.monthlyPrice,h=p.yearlySavings,f=p.taxInclusiveYearlyPrice,y=p.taxInclusiveMonthlyPrice,_=p.taxInclusiveYearlySavings;this.props.useAUTaxInclusivePricing?(e=o.intl.formatMessage(o._("%(price)s / year"),{price:f?f.formatCurrency():""}),n=o.intl.formatMessage(o._("%(price)s per year. Save %(savings)s. Prices include GST"),{price:f?f.formatCurrency():"",savings:_?_.formatCurrency():""}),t=o.intl.formatMessage(o._("%(price)s / month"),{price:y?y.formatCurrency():""}),i=o.intl.formatMessage(o._("%(price)s per month. Includes GST"),{price:y?y.formatCurrency():""}),r=o.intl.formatMessage(o._("%(price)s / year"),{price:y?y.multiply(12).formatCurrency():""}),a=o.intl.formatMessage(o._("Equivalent to %(price)s / month"),{price:f?f.divide(12).formatCurrency():""}),s=o.intl.formatMessage(o._("%(yearly_price)s per year. Equivalent to %(monthly_equivalent)s per month. Prices include GST"),{yearly_price:f?f.formatCurrency():"",monthly_equivalent:f?f.divide(12).formatCurrency():""}),l=o.intl.formatMessage(o._("%(price)s / month"),{price:f?f.divide(12).formatCurrency():""}),u=o.intl.formatMessage(o._("%(price)s per month when billed yearly"),{price:f?f.divide(12).formatCurrency():""})):(e=o.intl.formatMessage(o._("%(price)s / year"),{price:d?d.formatCurrency():""}),n=o.intl.formatMessage(o._("%(price)s per year. Save %(savings)s"),{price:d?d.formatCurrency():"",savings:h?h.formatCurrency():""}),t=o.intl.formatMessage(o._("%(price)s / month"),{price:m?m.formatCurrency():""}),i=o.intl.formatMessage(o._("%(price)s per month"),{price:m?m.formatCurrency():""}),r=o.intl.formatMessage(o._("%(price)s / year"),{price:m?m.multiply(12).formatCurrency():""}),a=o.intl.formatMessage(o._("Equivalent to %(price)s / month"),{price:d?d.divide(12).formatCurrency():""}),s=o.intl.formatMessage(o._("%(yearly_price)s per year. Equivalent to %(monthly_equivalent)s per month"),{yearly_price:d?d.formatCurrency():"",monthly_equivalent:d?d.divide(12).formatCurrency():""}),l=o.intl.formatMessage(o._("%(price)s / month"),{price:d?d.divide(12).formatCurrency():""}),u=o.intl.formatMessage(o._("%(price)s per month when billed yearly"),{price:d?d.divide(12).formatCurrency():""}))}return{yearlyPrice:e,yearlyPriceAx:n,monthlyPrice:t,monthlyPriceAx:i,yearlyPriceNoSavings:r,yearlyEquivalentToMonthly:a,yearlyEquivalentToMonthlyAx:s,yearlyGstIncluded:o._("(prices include GST)"),monthlyGstIncluded:o._("(includes GST)"),yearlyPricePerMonth:l,yearlyPricePerMonthAx:u}},t.prototype.renderYearlyPlanBlock=function(){var e=this,t=this.props.formData.scheduleId.formattedValue,r=this.getPricingStrings(),l=r.yearlyPrice,u=r.yearlyPriceAx,c=r.yearlyPriceNoSavings,p=r.yearlyEquivalentToMonthly,d=r.yearlyEquivalentToMonthlyAx,m=r.yearlyGstIncluded,h=r.yearlyPricePerMonth,f=r.yearlyPricePerMonthAx,y=r.monthlyGstIncluded,_=n.default({"plan-info__savings":!0,"plan-info__savings--strike":"en"===this.props.locale&&"V1"!==this.props.subgrowthProBuyStep2PricingMessaging}),g=o._("(includes 2 free months)"),v=u;"en"===this.props.locale&&("V1"===this.props.subgrowthProBuyStep2PricingMessaging?(g=p,v=d):g=c);var S=this.props.formData.productPlanType.rawValue===i.ProductPlanType.PLUS&&!this.props.showTrialVersion&&!this.props.showServerViewVersion,C=a.default.createElement("span",{id:"plan-info__label--yearly",className:"plan-info__label plan-info__label--yearly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.YEARLY)},"aria-hidden":"true"},o._("Billed Yearly"));return a.default.createElement("div",{className:"plan-info__choice plan-info__yearly"},a.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--yearly",ariaLabelId:"plan-info__label--yearly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.YEARLY.toString(),checked:t===i.ScheduleId.YEARLY,labelSpan:C,onClickOrChange:this.onScheduleChange}),a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},S?h:l),a.default.createElement("span",{className:"ax-visually-hidden"},S?f:v),!S&&a.default.createElement("div",{"aria-hidden":"true",className:_},g),this.props.useAUTaxInclusivePricing&&a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},S?y:m))},t.prototype.renderMonthlyPlanBlock=function(){var e=this,t=this.props.formData.scheduleId.formattedValue,r=this.getPricingStrings(),n=r.monthlyPrice,l=r.monthlyPriceAx,u=r.monthlyGstIncluded,c=a.default.createElement("span",{id:"plan-info__label--monthly",className:"plan-info__label plan-info__label--monthly",onClick:function(){return e.onPlanLabelClick(i.ScheduleId.MONTHLY)},"aria-hidden":"true"},o._("Billed Monthly"));return a.default.createElement("div",{className:"plan-info__choice plan-info__monthly"},a.default.createElement(s.LabeledRadioInput,{name:"schedule_id",inputId:"plan-info__radio--monthly",ariaLabelId:"plan-info__label--monthly",className:"plan-info__radio",labelClassName:"plan-info__container",value:i.ScheduleId.MONTHLY.toString(),checked:t===i.ScheduleId.MONTHLY,labelSpan:c,onClickOrChange:this.onScheduleChange}),a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},n),a.default.createElement("span",{className:"ax-visually-hidden"},l),this.props.useAUTaxInclusivePricing&&a.default.createElement("div",{className:"plan-info__subtitle","aria-hidden":"true"},u))},t.prototype.render=function(){return a.default.createElement("div",{className:"grid__container plan-info"},this.renderYearlyPlanBlock(),a.default.createElement("div",{className:"plan-info__spacer"}),this.renderMonthlyPlanBlock())},t})(a.default.Component);t.ScheduleSelection=l})),define("modules/clean/react/payments/buy/components/payments/cpf_tooltip",["require","exports","tslib","react","modules/core/i18n"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n._("The Cadastro de Pessoas Físicas (CPF) is the the Brazilian individual taxpayer registry identification number. It has 11 digits and can be found on your CPF card. It consists of numbers, dots and a dash, as in the following example: 100.001.101-00."),t=n._("The Cadastro Nacional da Pessoa Jurídica, or most commonly known as CNPJ, is a number that identifies legal entities and other legal arrangements at the Federal Revenue Service of Brazil. It has functions similar to those of the CPF, the only difference being that it is unique to the use of legal entities. It is a 14-digit number with a certain format, like in the following example: 00.000.000/0001-00");return a.default.createElement("div",{className:"cpf-tooltip-contents"},a.default.createElement("p",{className:"cpf-tooltip-contents__header"},n._("What is CPF?")),a.default.createElement("p",null,e),a.default.createElement("p",{className:"cpf-tooltip-contents__header"},n._("What is CNPJ?")),a.default.createElement("p",null,t))},t})((a=r.__importDefault(a)).default.Component);t.CPFTooltip=o})),define("modules/clean/react/payments/buy/components/payments/buy_payment_info_section",["require","exports","tslib","react","classnames","modules/clean/react/tooltip","modules/clean/react/image","modules/clean/static_urls","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/skus/constants","modules/clean/payments/validation","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/buy/components/payments/ideal_form","modules/clean/react/payments/buy/components/payments/payment_method_selector","modules/clean/react/payments/buy/components/payments/payment_method_survey","modules/clean/react/payments/buy/components/payments/cpf_tooltip","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/react/payments/checkout/components/payment_method_form/address_form","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_purchase_full_name","modules/clean/react/payments/common/constants","modules/core/exception"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,h,f,y,_,g,v,S,C,b,E,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),P=r.__importStar(P);var w=(function(t){function w(){var n=null!==t&&t.apply(this,arguments)||this;return n.createPaypalBtn=function(){var t=n.props.braintreeClientToken?n.props.braintreeClientToken:"",a=n.props.actions.updatePayPalNonce;Promise.all([new Promise((function(t,r){e(["braintree-web-client"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["braintree-web-paypal"],t,r)})).then(r.__importStar),new Promise((function(t,r){e(["paypal-api-checkout"],t,r)})).then(r.__importStar)]).then((function(e){var r=e[0],n=e[1],o=e[2].default;r.create({authorization:t},(function(e,t){if(e)P.reportException({err:new Error("Error creating Braintree client: "+e),severity:P.SEVERITY.CRITICAL});else{var r=o;n.create({client:t},(function(e,t){e?P.reportException({err:new Error("Error creating PayPal Checkout: "+e),severity:P.SEVERITY.CRITICAL}):r.Button.render({env:"production",style:{color:"gold",height:35,label:"paypal",shape:"rect",size:"responsive",tagline:!1},funding:{allowed:[r.FUNDING.CARD],disallowed:[r.FUNDING.CREDIT]},payment:function(){return t.createPayment({flow:"vault",enableShippingAddress:!1})},onAuthorize:function(e,r){return t.tokenizePayment(e,(function(e,t){a(t.nonce,t.details.email)}))},onCancel:function(e){},onError:function(e){P.reportException({err:new Error("PayPal Checkout error: "+e),severity:P.SEVERITY.CRITICAL})}},"#paypal-button").then((function(){}))}))}}))}))},n.clearPayPalNonce=function(e){e.preventDefault(),n.props.actions.updatePayPalNonce("","")},n.onCpfNameChange=function(e){n.props.actions.updateCpfName(e.value)},n.onVatBlur=function(e){"ON"===n.props.paymentFormErrorsExperiment&&n.props.actions.showFormFieldErrors(["vat"],"VatBlur"),n.props.actions.blurVat(e.value)},n.onVatChange=function(e){n.props.actions.updateVat(e.value)},n.onCpfBlur=function(e){"ON"===n.props.paymentFormErrorsExperiment&&n.props.actions.showFormFieldErrors(["cpf"],"CpfBlur"),n.props.actions.blurCpf(e.value)},n.onCpfChange=function(e){n.props.actions.updateCpf(e.value)},n.renderPaymentMethodSurvey=function(){var e=n.props.paymentSpec.paymentMethodSurveyOptions(n.props.formData.countryCode.rawValue,n.props.paymentOptionsExperiment);return 0===e.length||void 0===n.props.isPaymentOptionsSurveyOpen||void 0===n.props.actions.openSurvey||void 0===n.props.actions.cancelSurvey||void 0===n.props.actions.submitSurvey?null:a.default.createElement(_.PaymentMethodSurvey,{isSurveyModalOpen:n.props.isPaymentOptionsSurveyOpen,surveyOptions:e,openSurvey:n.props.actions.openSurvey,cancelSurvey:n.props.actions.cancelSurvey,submitSurvey:n.props.actions.submitSurvey})},n}return r.__extends(w,t),w.prototype.componentDidMount=function(){var e=this.props.formData.countryCode.formattedValue,t=this.props.showServerViewVersion;l.ProEventsLogger.log("uj-billing-country",{country:e},void 0,t),"BR"===e&&this.props.showCpf&&l.ProEventsLogger.log("uj-cpf-viewed-field",{},void 0,t),this.props.actions.updateHistory&&this.props.actions.updateHistory(),"ON"===this.props.paymentPayPalV2Flow&&this.props.braintreeClientToken&&this.createPaypalBtn()},w.prototype.prepareForSubmission=function(){return this.props.formData.paymentMethod.formattedValue===u.PaymentMethod.CreditCard?this.creditCardFrame.tokenize():Promise.resolve(!0)},w.prototype.getCreditCardFrame=function(){return this.creditCardFrame},w.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!h.FormValueHelper.isValid(e)&&e.showError?d.intl.formatMessage(d._("Please enter a valid VAT number (ex: %(examples)s)."),{examples:p.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},w.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!h.FormValueHelper.isValid(e)&&e.showError?d._("Please enter a valid CPF number."):""},w.prototype.renderLocationFields=function(){return a.default.createElement("div",{className:"grid__item"},a.default.createElement(C.AddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList,psd2AddressFields:this.props.psd2AddressFields,showCpf:this.props.showCpf,showServerViewVersion:this.props.showServerViewVersion,paymentFormErrorsExperiment:this.props.paymentFormErrorsExperiment}),this.renderVatFields(),this.renderCpfInput())},w.prototype.renderVatFields=function(){var e=null;if(this.props.paymentSpec.should_show_vat_for_country(this.props.formData.countryCode.formattedValue)&&this.props.productPlanType===c.ProductPlanType.PROFESSIONAL){var t=this.props.formData.vat.errorState&&this.props.formData.vat.showError,r=p.getVatPrefix(this.props.formData.countryCode.formattedValue),o=n.default({"payment-info__vat-input":!0,"payment-info__vat-input--valid":""!==this.props.formData.vat.formattedValue&&h.FormValueHelper.isValid(this.props.formData.vat)}),i=void 0;"ON"===this.props.paymentFormErrorsExperiment&&(i=this.vatErrorString()),e=a.default.createElement(m.LabeledTextInput,{className:"payment-info__vat",inputClassName:o,containerClassName:"grid__item vat-container",name:"vat",labelText:d._("VAT number (optional)"),placeholder:r,hasError:Boolean(t),value:this.props.formData.vat.rawValue,onBlur:this.onVatBlur,onChange:this.onVatChange,errorText:i})}return e},w.prototype.renderCpfInput=function(){var e=null;if(this.props.showCpf&&this.props.paymentSpec.should_require_cpf(this.props.formData.countryCode.formattedValue,this.props.formData.paymentMethod.formattedValue)){var t=this.props.formData.cpf.errorState&&this.props.formData.cpf.showError,r=n.default({"payment-info__cpf-input":!0,"payment-info__cpf-input--valid":""!==this.props.formData.cpf.formattedValue&&h.FormValueHelper.isValid(this.props.formData.cpf)}),l=void 0,u=void 0;this.props.optimizeCpf?(l=a.default.createElement("span",null,d._("CPF/CNPJ"),a.default.createElement(o.Tooltip,{position:o.TooltipPosition.RIGHT,tooltip_contents:a.default.createElement(g.CPFTooltip,null),is_focusable:!0},a.default.createElement(i.Image,{className:"cpf-tooltip-icon",src:s.static_url("/static/images/payments/buy/rebrand-info-vflRPzJtZ.png"),srcHiRes:s.static_url("/static/images/payments/buy/rebrand-info@2x-vflc1SGxi.png"),alt:d._("More information"),width:15,height:15}))),u=d._("e.g. 100.001.101-00",{comment:"This is being used as a placeholder value for a Brazilian payment form field"})):l=d._("CPF/CNPJ");var c=void 0;"ON"===this.props.paymentFormErrorsExperiment&&(c=this.cpfErrorString()),e=a.default.createElement("div",{className:"grid__item"},a.default.createElement(m.LabeledTextInput,{className:"",inputClassName:r,containerClassName:"grid__item payment-info__cpf",name:"cpf",labelText:l,hasError:Boolean(t),value:this.props.formData.cpf.rawValue,onBlur:this.onCpfBlur,onChange:this.onCpfChange,placeholder:u,errorText:c}),this.props.showCpfName&&a.default.createElement(m.LabeledTextInput,{className:"",containerClassName:"grid__item",name:"cpf_name",labelText:d._("Name"),value:this.props.formData.cpfName.rawValue,onChange:this.onCpfNameChange}))}return e},w.prototype.showPSD2FieldsToUser=function(){return!0===this.props.psd2AddressFields&&this.props.formData.paymentMethod.formattedValue===u.PaymentMethod.CreditCard&&this.props.paymentSpec.should_show_PSD2_address_fields_for_country(this.props.formData.countryCode.formattedValue)},w.prototype.renderPaymentMethodSelector=function(){var e=this.props,t=e.paymentSpec,r=e.formData,n=e.showSepaLogo,o=e.showTrialVersion,i=this.renderPaymentMethodSurvey();return a.default.createElement(a.default.Fragment,null,a.default.createElement(y.PaymentMethodSelector,{showSepaLogo:n,paymentSpec:t,paymentMethod:r.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:r.countryCode.rawValue,zipCode:r.zipCode.rawValue,showTrialVersion:o,fullWidth:null!==i}),i)},w.prototype.renderErrors=function(){var e=this.props,t=e.formData,r=e.paymentSpec,n=[];if("ON"===this.props.paymentFormErrorsExperiment)return null;t.nonce.showError&&t.paymentMethod.formattedValue===u.PaymentMethod.CreditCard&&(t.nonce.isCCNValid||n.push(d._("Please enter a valid credit card number.")),t.nonce.isCCodeValid||n.push(d._("Please enter a valid CVV.")),t.nonce.isCCExpValid||n.push(d._("Please enter a valid expiration date."))),r.showPSD2FieldsToUser(t.paymentMethod.formattedValue,t.countryCode.formattedValue,!!this.props.psd2AddressFields)&&(t.address.errorState&&t.address.showError&&n.push(E.AddressErrorMessage),t.name.errorState&&t.name.showError&&n.push(E.NameErrorMessage),t.city.errorState&&t.city.showError&&n.push(E.CityErrorMessage)),t.paymentMethod.formattedValue===u.PaymentMethod.DirectDeposit&&(t.accountHolderName.errorState&&t.accountHolderName.showError&&n.push(d._("Please enter the account holder’s name.")),t.iban.errorState&&t.iban.showError&&n.push(d._("Please enter a valid bank account number."))),t.paymentMethod.formattedValue===u.PaymentMethod.Ideal&&t.idealBankId.errorState&&t.idealBankId.showError&&n.push(d._("Please select your bank."));var o=E.ZipCodeErrorMessage;return!h.FormValueHelper.isValid(t.zipCode)&&t.zipCode.showError&&n.push(o),r.should_show_vat_for_country(t.countryCode.formattedValue)&&t.vat.errorState&&n.push(this.vatErrorString()),t.cpf.errorState&&n.push(this.cpfErrorString()),n.length>0?a.default.createElement("div",{className:"payment-info__errors"},n.map((function(e){return a.default.createElement("div",{key:e},e)}))):null},w.prototype.render=function(){var e=this,t=this.props,n=t.actions,o=t.formData,i=t.idealBanks,s=t.hidePaymentMethodSelector,l=this.renderLocationFields(),c=l;o.paymentMethod.formattedValue===u.PaymentMethod.DirectDeposit?c=a.default.createElement(S.DirectDebitForm,{locationFields:l,formData:o,actions:n,paymentFormErrorsExperiment:this.props.paymentFormErrorsExperiment}):o.paymentMethod.formattedValue===u.PaymentMethod.Ideal&&(c=a.default.createElement(f.IdealForm,{locationFields:l,formData:o,actions:n,idealBanks:i,paymentFormErrorsExperiment:this.props.paymentFormErrorsExperiment}));var p,m="payment-info grid__container",h="grid__item grid__item--large--3-4";return"ON"===this.props.paymentFormErrorsExperiment&&(m="payment-info grid__container inline-errors",h="grid__item grid__item--large--11-12"),"ON"===this.props.paymentPayPalV2Flow&&(p=a.default.createElement("span",{className:"paypal-button-container",hidden:o.paymentMethod.formattedValue!==u.PaymentMethod.PayPal},a.default.createElement("span",{className:"paypal-button-start",hidden:""!==o.payPalNonce.formattedValue},a.default.createElement("label",{className:"input__label"},d._("Sign into PayPal to continue with this payment method:")),a.default.createElement("div",{id:"paypal-button"})),a.default.createElement("span",{className:"paypal-button-end",hidden:""===o.payPalNonce.formattedValue},a.default.createElement("span",{id:"paypal-button-account-email"},o.payPalNonce.email),a.default.createElement("br",null),a.default.createElement("a",{href:"#",onClick:this.clearPayPalNonce},d._("Change PayPal account"))),a.default.createElement("span",{hidden:!1===o.payPalNonce.showError},a.default.createElement("label",{className:"input__label--error"},d._("Please select your PayPal account."))))),a.default.createElement("div",{className:m},!s&&this.renderPaymentMethodSelector(),a.default.createElement("div",{className:h},a.default.createElement(b.CreditCardPurchaseFullNameIfPsd2,r.__assign({},this.props)),a.default.createElement(v.CreditCardFrame,{iframeUrl:this.props.iframeUrl,hidden:o.paymentMethod.formattedValue!==u.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){e.creditCardFrame=t},nonce:o.nonce,bin:o.bin,showServerViewVersion:this.props.showServerViewVersion,submitForm:this.props.submitForm,getHeightFromIframe:"ON"===this.props.paymentFormErrorsExperiment,paymentFormErrorsExperiment:this.props.paymentFormErrorsExperiment}),p,c),this.renderErrors())},w})(a.default.Component);t.PaymentInfoSection=w})),define("modules/clean/react/payments/buy/components/payments/order_summary",["require","exports","tslib","react","classnames","modules/core/i18n","modules/constants/trademark","modules/clean/react/payments/buy/components/payments/tos","modules/clean/react/rebrand/elements/rebrand_buttons","spectrum/button","modules/core/browser","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/constants","modules/clean/payments/cash"],(function(e,t,r,a,n,o,i,s,l,u,c,p,d,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),c=r.__importStar(c);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropboxPlanName=function(){var e=t.props,r=e.planName,a=e.planNamePrefixedWithDropbox;return a||("Plus"===r?i.DROPBOX_PLUS:i.DROPBOX_PROFESSIONAL)},t.onClickRedirectToBuy=function(){var e=t.props.showServerViewVersion;p.ProEventsLogger.log("clicked_buy_directly_cta",{},void 0,e),c.redirect(t.props.buyLink)},t}return r.__extends(t,e),t.prototype.getFormattedTaxLines=function(){if(this.props.pageState.useRevenueApi){var e=this.props.revenueApiTaxLines;if(e.length)return e.map((function(e){return{taxName:e.tax_name,formattedAmount:e.tax_amount,formattedPercent:e.tax_rate}}))}else{var t=this.props.currentTransitionPrices,r=t.taxPercentage,a=t.taxAmount;if(a&&a.amount&&r&&r>0){var n=this.getTaxNameForCountry(),i=o.format_percent(r);return[{taxName:n,formattedAmount:a.toString(),formattedPercent:i}]}}return[]},t.prototype.getTaxNameForCountry=function(){return this.props.taxNamesByCountry?this.props.taxNamesByCountry[this.props.currentTransitionPrices.taxCountryCode||"null"]:o._("Tax")},t.prototype.renderTaxElement=function(){var e=this.props.showTrialVersion?"order-summary__strike":"";return this.getFormattedTaxLines().map((function(t){return a.default.createElement("div",{key:t.taxName,className:"order-summary__tax grid__item"},o.intl.formatMessage(o._("%(tax_name)s (%(tax_percent)s):"),{tax_name:t.taxName,tax_percent:t.formattedPercent})," ",a.default.createElement("span",{className:e},o.intl.formatMessage(o._("%(tax_amount)s"),{tax_amount:t.formattedAmount})))}))},t.prototype.renderWithheldTaxElement=function(){var e=this.props.currentTransitionPrices,t=e.withheldTaxAmount,r=e.withheldTaxPercentage,n=this.getTaxNameForCountry();if(t&&t.amount&&r&&r>0){var i=o.format_percent(r),s=t.toString();return a.default.createElement("div",{className:"order-summary__withheld_tax grid__item"},o.intl.formatMessage(o._("Withheld %(tax_name)s (%(tax_percent)s): %(tax_amount)s"),{tax_name:n,tax_percent:i,tax_amount:s}))}},t.prototype.renderTotalPriceElement=function(e){var t=this.props,n=t.currentTransitionPrices,i=t.revenueApiCurrency,s=t.showPlusTryRedesign,l=a.default.createElement("div",{className:"order-summary__price grid__item"},o.intl.formatMessage(o._("Billed Now: %(total_price)s"),{total_price:e})),u={strike:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("span",{className:"order-summary__strike order-summary__padding-left"},e)},free:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("span",{className:"order-summary__free-price order-summary__padding-left"},e)}},c=a.default.createElement("div",{className:"order-summary__price grid__item"},o.intl.formatMessage(o._("Charged Now: <strike>%(total_price)s</strike> <free>FREE</free>"),r.__assign(r.__assign({},u),{total_price:e}))),p=n.currency||i;return s&&(c=c=a.default.createElement("div",{className:"order-summary__price grid__item"},o.intl.formatMessage(o._("Billed now: <free>%(free_price)s</free>"),r.__assign(r.__assign({},u),{free_price:new h.Cash(0,p).toString()})))),this.props.showTrialVersion?c:l},t.prototype.renderCTA=function(){var e=this.props,t=e.loadingPrices,r=e.pageState,i=e.showTrialVersion,s=e.showServerViewVersion,c=e.showPlusTryRedesign,p=e.trialLength,d=e.onTryClick,m=e.onClick,h=t||r.submitting,f=n.default({"button--submit":!0,"button--loading":h,grid__item:!0,"order-summary__button":!0}),y=i?o._("Start your free trial"):o._("Buy now");s&&!i&&(y=o.intl.formatMessage(o._("Get %(plan)s now"),{plan:this.dropboxPlanName()})),c&&(y=o.intl.formatMessage(o._("Try free for %(trialLength)s days"),{trialLength:p}));var _=y;h&&(_=a.default.createElement("div",{className:"loader"},a.default.createElement("span",{className:"loader__dot"}),a.default.createElement("span",{className:"loader__dot"}),a.default.createElement("span",{className:"loader__dot"})));var g=i?d:m;return s?a.default.createElement(u.Button,{"aria-label":y,variant:"primary",size:"default",type:"submit",className:f,onClick:g,disabled:h,"data-uxa-log":"order-summary-submit-button"},_):a.default.createElement(l.RebrandButton,{ariaLabel:y,importance:"primary",size:"medium",type:"submit",className:f,onClick:g,disabled:h,"data-uxa-log":"order-summary-submit-button"},_)},t.prototype.renderError=function(){var e=this.props.pageState.hasFormError;"ON"===this.props.paymentFormErrorsExperiment&&(e=!!this.props.pageState.showBuyClickError);var t=n.default({"form-error":!0,"form-error--enabled":e});return a.default.createElement("p",{className:t,"aria-live":"assertive"},o._("Please correct the form errors and try again"))},t.prototype.render=function(){var e,t,r,i=this.props,l=i.actions,c=i.formData,p=i.showServerViewVersion,h=i.promoSpec,f=this.props.currentTransitionPrices.totalPrice,y=this.props.currentTransitionPrices.currency;f&&(e=f.toString(),t=this.renderTotalPriceElement(e),r=f.formatCurrency(2)),this.props.pageState.useRevenueApi&&(t=this.renderTotalPriceElement(this.props.revenueApiPrice),r=this.props.revenueApiPrice,y=this.props.revenueApiCurrency);var _,g=this.renderTaxElement(),v=this.renderWithheldTaxElement();y&&r&&(_=a.default.createElement(s.TermsOfService,{actions:l,currency:y,formData:c,totalPrice:r,showTrialVersion:this.props.showTrialVersion,showServerViewVersion:p||!1,paymentFormErrorsExperiment:this.props.paymentFormErrorsExperiment}));var S=this.props.loadingPrices||this.props.pageState.submitting,C=n.default({"button-as-link":!0,"order-summary__button":!0,"order-summary__buy-button":!0,grid__item:!0,"order-summary__buy-button-disabled":S,"ProTryServerView__secondary-button":this.props.showServerViewVersion}),b=a.default.createElement("button",{className:C,onClick:this.onClickRedirectToBuy},o.intl.formatMessage(o._("Or buy %(plan)s now"),{plan:this.dropboxPlanName()}));this.props.showServerViewVersion&&(b=a.default.createElement(u.Button,{variant:"borderless",className:"ProTryServerView__secondary-button",onClick:this.onClickRedirectToBuy},o.intl.formatMessage(o._("Buy %(plan)s now"),{plan:this.dropboxPlanName()})));var E=n.default({"ProTryServerView__order-summary":p,"order-summary":!0,grid__container:!0}),P=n.default({"ProTryServerView__order-card":p,"order-summary__card":!this.props.formVariant||"row"===this.props.formVariant,"order-summary__card-no-border":"column"===this.props.formVariant,grid__item:!0}),w="blue";this.props.productPlanType===m.ProductPlanType.PLUS&&(w="black");var F="column"===this.props.formVariant||p?null:a.default.createElement("div",{className:"card-top card-top--"+w+" grid__item"}),N=h&&h.freeMonths&&c.scheduleId.formattedValue===d.ScheduleId.YEARLY?a.default.createElement("div",{className:"promo-highlight"},o.intl.formatMessage(o._("<span>+ %(free_months)s months free</span> with your first year"),{free_months:h.freeMonths,span:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("span",null,e)}})):null;return a.default.createElement("div",{className:E},F,a.default.createElement("div",{className:P},a.default.createElement("div",{className:"order-summary__plan-name grid__item"},this.dropboxPlanName()),a.default.createElement("div",{className:"order-summary__line-items grid__item"},g,v,t,N),_,this.renderCTA(),this.props.showTrialVersion?b:void 0,this.renderError()))},t})(a.default.Component);t.OrderSummary=f})),define("modules/clean/react/payments/buy/components/payments/worldpay_entity_info",["require","exports","tslib","react"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"grid__container payment-entity-info__text"},a.default.createElement("p",null,"Dropbox International Unlimited Company",a.default.createElement("br",null),"One Park Place / Hatch Street Upper / Dublin 2 / Ireland"))},t})((a=r.__importDefault(a)).default.Component);t.WorldPayEntityInfo=n})),define("modules/clean/react/payments/buy/helpers/pricing_value_helper",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,r){"use strict";function a(e,t,r,a){return e.filter((function(e){var n=e.finalSubState.plan,o=e.finalSubState.billingSchedule,i=!!e.finalSubState.addons.skus.length;return n&&n.productType===t&&o&&o.id===r&&i===a})).pop()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisplayPrices=function(e,t,n){var o,i,s,l,u,c;if(e){var p=a(e,t.productPlanType.formattedValue,r.ScheduleId.MONTHLY,!1),d=a(e,t.productPlanType.formattedValue,r.ScheduleId.YEARLY,!1),m=void 0,h=void 0;if(n?(d&&(o=(m=d.tvm).getTotalPrice(),l=m.getBilledPrice()),p&&(i=(h=p.tvm).getTotalPrice(),u=h.getBilledPrice())):(d&&(o=d.nextBillingSummary.base,l=d.nextBillingSummary.total),p&&(i=p.nextBillingSummary.base,u=p.nextBillingSummary.total)),o&&i){var f=i.multiply(12).subtract(o);s=f.amount>0?f:void 0}if(l&&u){var y=u.multiply(12).subtract(l);c=y.amount>0?y:void 0}}return{yearlyPrice:o,monthlyPrice:i,yearlySavings:s,taxInclusiveYearlyPrice:l,taxInclusiveMonthlyPrice:u,taxInclusiveYearlySavings:c}},t.getCurrentTransitionPrices=function(e,t){var r,n,o,i,s,l,u,c;if(e&&(r=a(e,t.productPlanType.formattedValue,t.scheduleId.formattedValue,!!t.evh.rawValue)),r&&r.tvm){var p=r.tvm;n=p.getTotalPrice(),o=p.getTaxCountryCode(),i=p.getTaxPercentage(),s=p.getTaxPrice(),l=p.getCurrency(),u=p.getTotalTaxWithheld(),c=p.getWithheldTaxPercentage()}return{totalPrice:n,taxCountryCode:o,taxPercentage:i,taxAmount:s,currency:l,withheldTaxAmount:u,withheldTaxPercentage:c}}})),define("modules/clean/react/payments/buy/components/payments/ideal_form",["require","exports","tslib","react","modules/clean/react/payments/buy/components/inputs/inputs","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIdealBankChange=function(e){var r=e.value,a=t.props.idealBanks[r];t.props.actions.updateIdealBank({bankId:r,bankName:a})},t.onIdealBankBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["idealBankId"],"IdealBankBlur")},t.idealErrorString=function(){var e=t.props.formData.idealBankId;return!i.FormValueHelper.isValid(e)&&e.showError?o._("Please select your bank."):""},t}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,r=t.formData,i=t.idealBanks,s=o._("Note: We’ll use your bank information provided by iDEAL for all future billing cycles. If your bank is not listed, then please select a different payment method."),l=r.idealBankId.errorState&&r.idealBankId.showError;return"ON"===this.props.paymentFormErrorsExperiment&&(e=this.idealErrorString()),a.default.createElement("div",{className:"ideal-container"},a.default.createElement("div",{className:"ideal-fields"},a.default.createElement(n.LabeledSelectInput,{name:"ideal_bank",labelText:o._("Bank"),value:r.idealBankId.rawValue,onChange:this.onIdealBankChange,onBlur:this.onIdealBankBlur,hasError:Boolean(l),errorText:e},a.default.createElement("option",{value:"",key:"default","aria-selected":""===r.idealBankId.rawValue},o._("Select your bank...")),Object.keys(i).map((function(e){return a.default.createElement("option",{value:e,key:e,"aria-selected":r.idealBankId.rawValue===e},i[e])})))),this.props.locationFields,a.default.createElement("div",{className:"ideal-note"},s))},t})((a=r.__importDefault(a)).default.Component);t.IdealForm=s})),define("modules/clean/react/payments/buy/components/payments/payment_method_input",["require","exports","tslib","react","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/inputs/inputs"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n);var s=(function(e){function t(t){var r=e.call(this,t)||this;return r.focus=function(){null!==r.labeledRadioInput.current&&r.labeledRadioInput.current.focus()},r.onChange=function(){r.props.onSelected(r.props.paymentMethod)},r.getPaymentMethodId=function(e){switch(e){case o.PaymentMethod.CreditCard:return"creditcard";case o.PaymentMethod.PayPal:return"paypal";case o.PaymentMethod.Ideal:return"ideal";case o.PaymentMethod.DirectDeposit:return"debit";default:return e}},r.labeledRadioInput=a.default.createRef(),r}return r.__extends(t,e),t.prototype.render=function(){var e=this.getPaymentMethodId(this.props.paymentMethod);return a.default.createElement("div",{className:n.default({"payment-info__option":!0,"full-width":this.props.fullWidth,"no-margin-bottom":this.props.noMarginBottom,"grid__item--expand":this.props.fullWidth,"grid__item--shrink":!this.props.fullWidth,"grid--y-middle":!0})},a.default.createElement(i.LabeledRadioInput,{ref:this.labeledRadioInput,name:this.props.name,className:"payment-info__payment",inputId:"payment-method-radio#"+e,ariaLabelId:"payment-method-label#"+e,value:this.props.paymentMethod.toString(),checked:this.props.selected,onClickOrChange:this.onChange,labelSpan:a.default.createElement(l,{id:e,textTitle:this.props.textTitle,title:this.props.title,icons:this.props.icons,onClick:this.onChange})}))},t})(a.default.Component);t.PaymentMethodInput=s;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t=this;return a.default.createElement("span",{className:"payment-info__method-label",onClick:this.props.onClick},a.default.createElement("span",{id:"payment-method-label#"+this.props.id,"aria-hidden":"true",className:n.default((e={"ax-visually-hidden":this.props.icons},e[this.props.id]=!this.props.icons,e)),title:this.props.textTitle},this.props.title),this.props.icons&&this.props.icons.map((function(e){return a.default.createElement("span",{key:"payment-method-icon#"+e,className:e,title:t.props.icons&&t.props.icons.length>1?e:t.props.title})})))},t})(a.default.Component)})),define("modules/clean/react/payments/buy/components/payments/payment_method_selector",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/buy/components/payments/payment_method_input"],(function(e,t,r,a,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return r.__extends(t,e),t.prototype.getLabelForMethodId=function(e){if(e===o.PaymentMethod.CreditCard){var t=this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode);return a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.CreditCard,selected:this.props.paymentMethod===o.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:t,fullWidth:this.props.fullWidth,title:n.intl.formatMessage(n._("Credit card. We accept %(payment_methods)s."),{payment_methods:t.join(", ").replace("_","-")})})}if(e===o.PaymentMethod.PayPal)return a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.PayPal,selected:this.props.paymentMethod===o.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],fullWidth:this.props.fullWidth,title:n._("Paypal")});if(e===o.PaymentMethod.DirectDeposit){t=void 0;return this.props.showSepaLogo&&(t=["sepa"]),a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===o.PaymentMethod.DirectDeposit,onSelected:this.onPaymentMethodSelected,icons:t,title:n._("Direct Debit"),fullWidth:this.props.fullWidth})}return e===o.PaymentMethod.Ideal?a.default.createElement(i.PaymentMethodInput,{name:"payment_method",key:"payment-method#"+e,paymentMethod:o.PaymentMethod.Ideal,selected:this.props.paymentMethod===o.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],fullWidth:this.props.fullWidth,title:n._("iDEAL")}):null},t.prototype.render=function(){var e=this,t=this.props,r=t.countryCode,o=t.paymentSpec,i=(t.showTrialVersion?o.only_default_payment_methods():o.available_payment_methods_for_country(r)).map((function(t){return e.getLabelForMethodId(t)}));return a.default.createElement("div",{className:"payment-info__selector grid__container"},a.default.createElement("span",{className:"ax-visually-hidden"},n._("Select a payment method")),i)},t})((a=r.__importDefault(a)).default.Component);t.PaymentMethodSelector=s})),define("modules/clean/react/payments/buy/components/payments/payment_method_survey",["require","exports","tslib","react","spectrum/modal","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/react/payments/buy/components/payments/payment_method_input","modules/clean/payments/payment_form/payment_form_spec"],(function(e,t,r,a,n,o,i,s,l){"use strict";var u,c;Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),(function(e){e[e.Icon=0]="Icon",e[e.Text=1]="Text",e[e.Other=2]="Other"})(c||(c={}));var p=((u={})[l.PaymentMethodSurveyOption.DirectDebit]={type:c.Icon,title:o._("Direct Debit")},u[l.PaymentMethodSurveyOption.ApplePay]={type:c.Icon,title:o._("Apple Pay")},u[l.PaymentMethodSurveyOption.GooglePay]={type:c.Icon,title:o._("Google Pay")},u[l.PaymentMethodSurveyOption.ACH]={type:c.Text,title:o._("ACH / eCheck (Bank transfer)"),textTitle:o._("Pay by bank transfer with your bank account and routing numbers.")},u[l.PaymentMethodSurveyOption.Other]={type:c.Other,title:o._("Other")},u),d=(function(e){function t(t){var r=e.call(this,t)||this;return r.openSurvey=function(){r.props.openSurvey(r.props.surveyOptions[0])},r.closeSurvey=function(){r.state.isSurveySubmitted||r.props.cancelSurvey(r.props.surveyOptions[0])},r.submitSurvey=function(e,t){r.props.submitSurvey(r.props.surveyOptions[0],e,t),r.setState({isSurveySubmitted:!0})},r.state={isSurveySubmitted:!1},r}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"survey-link-container grid__item--expand"},a.default.createElement(m,{isSurveySubmitted:this.state.isSurveySubmitted,openSurvey:this.openSurvey}),a.default.createElement(h,{isSurveyModalOpen:this.props.isSurveyModalOpen,surveyOptions:this.props.surveyOptions,closeSurvey:this.closeSurvey,submitSurvey:this.submitSurvey}))},t})(a.default.Component);t.PaymentMethodSurvey=d;var m=function(e){var t=e.isSurveySubmitted,r=e.openSurvey;return t?a.default.createElement("span",{className:"thanks-msg"},o._("Thanks for your feedback!")):a.default.createElement("button",{className:"button-as-link",onClick:r,type:"button"},o._("Want another way to pay?"))},h=(function(e){function t(t){var r=e.call(this,t)||this;return r.handlePress=function(e){"Enter"===e.key&&e.target instanceof Element&&"INPUT"===e.target.tagName&&(e.preventDefault(),r.submitSurvey())},r.focusOnRadioInput=function(){null!==r.paymentMethodInput.current&&r.paymentMethodInput.current.focus()},r.onModalReady=function(){r.focusOnRadioInput(),document.addEventListener("keypress",r.handlePress);var e=document.querySelector(".survey-modal-overlay .mc-util-modal-body");e instanceof HTMLElement&&(e.tabIndex=-1)},r.closeModal=function(){r.props.closeSurvey(),document.removeEventListener("keypress",r.handlePress)},r.onSelectedValueChange=function(e){r.setState({selectedValue:e})},r.onOtherValueChange=function(e){r.setState({otherValue:e.value})},r.onOtherValueFocus=function(e){r.setState({selectedValue:l.PaymentMethodSurveyOption.Other})},r.submitSurvey=function(){r.props.submitSurvey(r.state.selectedValue,r.state.otherValue)},r.paymentMethodInput=a.default.createRef(),r.state={selectedValue:t.surveyOptions[0],otherValue:""},r}return r.__extends(t,e),t.prototype.render=function(){var e=this;return a.default.createElement(n.UtilityModal,{appElement:document.body,ariaLabel:o._("Payment options feedback"),displayCloseButton:!0,onPrimaryAction:this.submitSurvey,onReady:this.onModalReady,onRequestClose:this.closeModal,onSecondaryAction:this.closeModal,open:this.props.isSurveyModalOpen,overlayClassName:"survey-modal-overlay",overlayClickClose:!0,primaryAction:o._("Submit feedback"),secondaryAction:o._("Cancel"),shouldRequestCloseOnActions:!1,title:o._("We’d love your feedback!")},a.default.createElement("p",null,o._("We’re working to add more payment options to Dropbox in the future. What method works best for you?")),a.default.createElement("form",{className:"payment-info-survey"},this.props.surveyOptions.map((function(t){return a.default.createElement(a.default.Fragment,null,a.default.createElement(s.PaymentMethodInput,{ref:e.state.selectedValue===t?e.paymentMethodInput:void 0,name:"payment_method_survey",key:"payment-method#"+t,paymentMethod:t,selected:e.state.selectedValue===t,onSelected:e.onSelectedValueChange,icons:p[t].type===c.Icon?[t]:void 0,title:p[t].title,fullWidth:!0,noMarginBottom:p[t].type===c.Other,textTitle:p[t].textTitle}),p[t].type===c.Other&&a.default.createElement("div",{className:"other-value-container"},a.default.createElement(i.LabeledTextInput,{containerClassName:"grid__container",className:"other-label",inputClassName:"other-input grid__item--expand grid__item--small--3-4 grid__item--medium--5-8",labelText:o._("Add your preferred payment method"),name:"other_value",value:e.state.otherValue,onChange:e.onOtherValueChange,onFocus:e.onOtherValueFocus})))}))))},t})(a.default.Component)})),define("modules/clean/react/payments/buy/components/payments/tos",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/buy/components/inputs/inputs","modules/clean/payments/skus/constants","modules/clean/server_side_client_view_bridge","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),s=r.__importStar(s);var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTermsAndServiceChange=function(e){t.props.actions.updateTermsAndService(Boolean(!e.checked))},t.onTermsAndServiceBlur=function(e){"ON"===t.props.paymentFormErrorsExperiment&&t.props.actions.showFormFieldErrors(["termsAndService"],"TermsAndServiceBlur")},t.onTOSLabelClick=function(e){var r=t.props.formData.termsAndService.formattedValue;t.props.actions.updateTermsAndService(Boolean(!r))},t.onLinkClick=function(e){t.props.showServerViewVersion&&(e.preventDefault(),e.stopPropagation(),s.OpenUncredentialedBrowserWithDropboxURL(e.currentTarget.getAttribute("href")))},t}return r.__extends(t,e),t.prototype.termsAndServiceErrorString=function(){var e=this.props.formData.termsAndService;return!l.FormValueHelper.isValid(e)&&e.showError?n._("Please agree to the terms of service."):""},t.prototype.componentDidMount=function(){this.props.showServerViewVersion&&s.init()},t.prototype.renderLegalTermsBuy=function(){var e=this,t=this.props,r=t.currency,o=t.formData,s=t.totalPrice;return n.intl.formatMessage(n._("You’ll be charged %(total_price)s %(schedule)s until you <link_cancel>cancel</link_cancel> your subscription. Previous charges <link_refund>won’t be refunded</link_refund> when you cancel <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in %(currency)s."),{total_price:s,schedule:o.scheduleId.rawValue===i.ScheduleId.MONTHLY?n._("monthly"):n._("yearly"),currency:r,link_cancel:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/158",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},link_refund:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/terms",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},link_required:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/help/9069",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)}})},t.prototype.renderLegalTermsTrial=function(){var e=this,t=this.props,r=t.currency,o=t.formData,s=t.totalPrice;return n.intl.formatMessage(n._("Your free trial ends on %(trial_end_date)s. If you don’t <link_cancel>cancel</link_cancel> your free trial by that date, we’ll charge you %(total_price)s %(schedule)s (taxes included) until you cancel your plan. Charges <link_refund>won’t be refunded</link_refund> when you cancel, <link_required>unless it’s legally required</link_required>. Your payment data is encrypted and secure. All amounts shown are in %(currency)s."),{trial_end_date:o.trialEndDate.rawValue,total_price:s,schedule:o.scheduleId.rawValue===i.ScheduleId.MONTHLY?n._("monthly"):n._("yearly"),link_cancel:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"cancel-article",key:"tos-cancel",href:"/help/space/cancel-plus",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},link_refund:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"refund-article",key:"tos-refund",href:"/help/billing/plus-refund",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},link_required:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__link","aria-label":"requirements-article",key:"tos-required",href:"/terms",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},currency:r})},t.prototype.render=function(){var e=this,t=this.props.formData,r=this.props.showTrialVersion?this.renderLegalTermsTrial():this.renderLegalTermsBuy(),i=n.intl.formatMessage(n._("I agree to the <link>Dropbox Terms</link>%(br)sand the <strong>Automatic Renewal Terms</strong> above"),{link:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return a.default.createElement("a",{className:"terms-info__tos--terms-link","aria-label":"terms",key:"link_dbx",href:"/terms",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},t)},br:a.default.createElement("br",null),strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.default.createElement("strong",null,e)}}),s=a.default.createElement("span",{className:"type--copy-small",onClick:this.onTOSLabelClick},i),l=a.default.createElement(o.LabeledCheckboxInput,{checked:t.termsAndService.rawValue,containerClassName:"grid__item terms-info__tos",className:"billing-terms-and-service",errorText:this.termsAndServiceErrorString(),labelText:s,name:"tos_agree",onClick:this.onTermsAndServiceChange,onBlur:this.onTermsAndServiceBlur});return a.default.createElement("div",{className:"terms-info"},a.default.createElement("p",{className:"terms-info__legal"},r),l)},t})(a.default.Component);t.TermsOfService=u})),define("modules/clean/react/payments/common/middleware/captcha_visibility_checker",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){var t=this;this.POLLING_FREQUENCY_MS=500,this.checkCaptchaVisibility=function(){t.isCheckingCaptchaVisibility&&(t.isCaptchaVisible=t.getCaptchaVisibility(),t.isCaptchaVisible?(t.isCheckingCaptchaVisibility=!1,t.onCaptchaVisibility(!0)):setTimeout(t.checkCaptchaVisibility,t.POLLING_FREQUENCY_MS))},this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1,this.onCaptchaVisibility=e,this.wasLastCaptchaSubmitVisible=!1}return e.prototype.triggerCaptcha=function(){this.isCheckingCaptchaVisibility=!0,this.checkCaptchaVisibility()},e.prototype.submitCaptcha=function(){this.isCaptchaVisible||this.onCaptchaVisibility(!1),this.wasLastCaptchaSubmitVisible=this.isCaptchaVisible,this.isCaptchaVisible=!1,this.isCheckingCaptchaVisibility=!1},e.prototype.getCaptchaVisibility=function(){var e=document.querySelector('iframe[src^="https://www.google.com/recaptcha/api2/bframe"]');return null!==e&&null!==e.parentElement&&null!==e.parentElement.parentElement&&"visible"===e.parentElement.parentElement.style.visibility},e})();t.CaptchaVisibilityChecker=r})),define("modules/clean/react/payments/common/middleware/payments_ux_logger",["require","exports","tslib","modules/clean/payments/three_ds_helper","modules/clean/payments/payment_form/payment_form_spec","modules/clean/logging/telemetry","modules/core/exception","modules/clean/logging/hive/schemas/web-payments_ux_analytics","modules/clean/react/payments/common/form_values","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/common/middleware/captcha_visibility_checker"],(function(e,t,r,a,n,o,i,s,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i);var p=new Set(["BlurAccountHolderName","BlurAddress","BlurCity","BlurCpf","BlurIBAN","BlurName","BlurVat","BlurZipCode","UpdateCountryCode","UpdateIdealBank","UpdateMandateSigned","UpdatePaymentMethod"]),d=(function(){function e(e,t){var r=this;this.reduxMiddleware=function(e){return function(t){return function(a){var n=e.getState(),o=t(a);try{var s=e.getState();r.handleAction(a,s,n)}catch(e){i.reportException({err:e,severity:i.SEVERITY.CRITICAL,tags:["payments_ux_logger","payment"]})}return o}}},this.onCaptchaVisibility=function(e){var t={challenge_type:e?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:r.originSubmitSeq.toString()};r.actionSeq++,r.logChallengeStart(t)},this.requestSeq=-1,this.actionSeq=-1,this.originSubmitSeq=0,this.requestId=e,this.logger=new o.HiveLogger,this.captchaVisibilityChecker=new c.CaptchaVisibilityChecker(this.onCaptchaVisibility),this.platform=t||s.PaymentsUxPlatform.Legacy}return e.prototype.handleAction=function(e,t,r){var o,i,l,c;if(this.isPageView(e)){var p=((o={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.formData.paymentMethod.rawValue],o);this.requestSeq++,this.actionSeq=0,this.logPageView(p)}else if(this.isFormFieldChange(e)){null!==(p=this.getFormFieldChangeDetails(e.type,t.formData,r.formData))&&(this.actionSeq++,this.logFormFieldChange(p))}else if(this.isCCFormFieldChange(e)){null!==(p=this.getCCFormFieldChangeDetails(e.creditCardIframeFields))&&(this.actionSeq++,this.logFormFieldChange(p))}else if(this.isShowFormFieldErrors(e)){if(this.isErrorFromSubmitForm(e)){p=this.getFormValidationErrorDetails(t.formData);this.actionSeq++,this.logFormValidationError(p)}}else if(this.isSubmitFormSuccess(e)){p=this.getFormSubmitEventDetails(u.SubmitFormTriggerType.ButtonClick,t.formData,r.pageState.submitSeq);this.actionSeq++,this.logFormSubmitSuccess(p)}else if(this.isSubmitFormStart(e)){p=this.getFormSubmitEventDetails(e.trigger,t.formData,r.pageState.submitSeq);this.actionSeq++,this.logFormSubmit(p)}else if(this.isTriggerCaptcha(e))this.captchaVisibilityChecker.triggerCaptcha();else if(this.isSubmitCaptcha(e)){this.captchaVisibilityChecker.submitCaptcha();p={challenge_type:this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.ChallengeType.ShownCaptcha:s.ChallengeType.SuppressedCaptcha,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(p)}else if(this.isTriggerThreeDsChallenge(e)){p={challenge_type:s.ChallengeType.ThreeDsChallenge,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(p)}else if(this.isTriggerThreeDsFingerprint(e)){p={challenge_type:s.ChallengeType.ThreeDsFingerprint,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeStart(p)}else if(this.isUpdateThreeDsData(e)){if(""!==e.value){var d=JSON.parse(e.value),m=void 0;if(d.resultType===a.ThreeDsResultType.IdentifyShopper)m=s.ChallengeType.ThreeDsFingerprint;else{if(d.resultType!==a.ThreeDsResultType.ChallengeShopper)return;m=s.ChallengeType.ThreeDsChallenge}p={challenge_type:m,origin_submit_seq:this.originSubmitSeq.toString()};this.actionSeq++,this.logChallengeSubmit(p)}}else if(this.isOpenSurvey(e)){p=((i={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,i.defaultValue=e.defaultValue,i);this.actionSeq++,this.logOpenSurvey(p)}else if(this.isCancelSurvey(e)){p=((l={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,l.defaultValue=e.defaultValue,l);this.actionSeq++,this.logCancelSurvey(p)}else if(this.isSubmitSurvey(e)){p=((c={})[s.FormFields.CountryCode]=t.formData.countryCode.rawValue,c.defaultValue=e.defaultValue,c.value=e.value,c.other=e.other,c.email=t.formData.email.rawValue,c);this.actionSeq++,this.logSubmitSurvey(p)}},e.prototype.logPageView=function(e){this.log(s.PaymentsUXEvent.PageView,e)},e.prototype.logFormFieldChange=function(e){this.log(s.PaymentsUXEvent.FormFieldChange,e)},e.prototype.logFormValidationError=function(e){this.log(s.PaymentsUXEvent.FormValidationError,e)},e.prototype.logFormSubmitSuccess=function(e){this.log(s.PaymentsUXEvent.FormSubmitSuccess,e)},e.prototype.logFormSubmit=function(e){this.log(s.PaymentsUXEvent.FormSubmit,e)},e.prototype.logChallengeStart=function(e){this.log(s.PaymentsUXEvent.ChallengeStart,e)},e.prototype.logChallengeSubmit=function(e){this.log(s.PaymentsUXEvent.ChallengeSubmit,e)},e.prototype.logOpenSurvey=function(e){this.log(s.PaymentsUXEvent.OpenSurvey,e)},e.prototype.logCancelSurvey=function(e){this.log(s.PaymentsUXEvent.CancelSurvey,e)},e.prototype.logSubmitSurvey=function(e){this.log(s.PaymentsUXEvent.SubmitSurvey,e)},e.prototype.log=function(e,t){this.logger.log(new s.PaymentsUXAnalyticsRow({event_name:e,event_details:t,request_id:this.requestId,request_seq:this.requestSeq,action_seq:this.actionSeq,platform:this.platform}))},e.prototype.isPageView=function(e){return"UpdateHistory"===e.type},e.prototype.isFormFieldChange=function(e){return p.has(e.type)},e.prototype.isShowFormFieldErrors=function(e){return"ShowFormFieldErrors"===e.type},e.prototype.isErrorFromSubmitForm=function(e){return"SubmitForm"===e.origin},e.prototype.isSubmitFormStart=function(e){return"SubmitFormStart"===e.type},e.prototype.isSubmitFormSuccess=function(e){return"SubmitFormSuccess"===e.type},e.prototype.isTriggerCaptcha=function(e){return"TriggerCaptcha"===e.type},e.prototype.isSubmitCaptcha=function(e){return"SubmitCaptcha"===e.type},e.prototype.isTriggerThreeDsChallenge=function(e){return"TriggerThreeDsChallenge"===e.type},e.prototype.isTriggerThreeDsFingerprint=function(e){return"TriggerThreeDsFingerprint"===e.type},e.prototype.isUpdateThreeDsData=function(e){return"UpdateThreeDsData"===e.type},e.prototype.isOpenSurvey=function(e){return"OpenSurvey"===e.type},e.prototype.isCancelSurvey=function(e){return"CancelSurvey"===e.type},e.prototype.isSubmitSurvey=function(e){return"SubmitSurvey"===e.type},e.prototype.isCCFormFieldChange=function(e){return"BlurCCField"===e.type},e.prototype.getFormFieldChangeDetails=function(e,t,r){switch(e){case"BlurAccountHolderName":return{field:s.FormFields.SepaAccountHolderName,value:t.accountHolderName.rawValue,error_state:l.InputErrorState[t.accountHolderName.errorState],show_error:t.accountHolderName.showError.toString()};case"BlurAddress":return{field:s.FormFields.Address,value:t.address.rawValue,error_state:l.InputErrorState[t.address.errorState],show_error:t.address.showError.toString()};case"BlurCity":return{field:s.FormFields.City,value:t.city.rawValue,error_state:l.InputErrorState[t.city.errorState],show_error:t.city.showError.toString()};case"BlurCpf":return{field:s.FormFields.Cpf,value:t.cpf.rawValue,error_state:l.InputErrorState[t.cpf.errorState],show_error:t.cpf.showError.toString()};case"BlurIBAN":return{field:s.FormFields.Iban,value:t.iban.rawValue,error_state:l.InputErrorState[t.iban.errorState],show_error:t.iban.showError.toString()};case"BlurName":return{field:s.FormFields.CardholderName,value:t.name.rawValue,error_state:l.InputErrorState[t.name.errorState],show_error:t.name.showError.toString()};case"BlurVat":return{field:s.FormFields.Vat,value:t.vat.rawValue,error_state:l.InputErrorState[t.vat.errorState],show_error:t.vat.showError.toString()};case"BlurZipCode":return{field:s.FormFields.ZipCode,value:t.zipCode.rawValue,error_state:l.InputErrorState[t.zipCode.errorState],show_error:t.zipCode.showError.toString()};case"UpdateCountryCode":return r.countryCode.rawValue!==t.countryCode.rawValue?{field:s.FormFields.CountryCode,value:t.countryCode.rawValue,error_state:l.InputErrorState[t.countryCode.errorState],show_error:t.countryCode.showError.toString()}:null;case"UpdateIdealBank":return r.idealBankId.rawValue!==t.idealBankId.rawValue?{field:s.FormFields.IdealBankId,value:t.idealBankId.rawValue,error_state:l.InputErrorState[t.idealBankId.errorState],show_error:t.idealBankId.showError.toString()}:null;case"UpdateMandateSigned":return r.mandateSigned.rawValue!==t.mandateSigned.rawValue?{field:s.FormFields.SepaMandateSigned,value:t.mandateSigned.rawValue.toString(),error_state:l.InputErrorState[t.mandateSigned.errorState],show_error:t.mandateSigned.showError.toString()}:null;case"UpdatePaymentMethod":return r.paymentMethod.rawValue!==t.paymentMethod.rawValue?{field:s.FormFields.PaymentMethod,value:n.PaymentMethod[t.paymentMethod.rawValue],error_state:l.InputErrorState[t.paymentMethod.errorState],show_error:t.paymentMethod.showError.toString()}:null;default:return null}},e.prototype.getCCFormFieldChangeDetails=function(e){return e.ccn?{field:s.FormFields.CreditCardNumber,error_state:l.InputErrorState[e.ccn.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccn.showError.toString()}:e.ccode?{field:s.FormFields.CreditCardCode,error_state:l.InputErrorState[e.ccode.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccode.showError.toString()}:e.ccexp?{field:s.FormFields.CreditCardExpDate,error_state:l.InputErrorState[e.ccexp.isValid?l.InputErrorState.Valid:l.InputErrorState.Invalid],show_error:e.ccexp.showError.toString()}:null},e.prototype.getFormValidationErrorDetails=function(e){var t={};return e.countryCode.showError&&(t[s.FormFields.CountryCode]=l.InputErrorState[e.countryCode.errorState]),e.paymentMethod.showError&&(t[s.FormFields.PaymentMethod]=l.InputErrorState[e.paymentMethod.errorState]),e.zipCode.showError&&(t[s.FormFields.ZipCode]=l.InputErrorState[e.zipCode.errorState]),e.vat.showError&&(t[s.FormFields.Vat]=l.InputErrorState[e.vat.errorState]),e.paymentMethod.formattedValue===n.PaymentMethod.CreditCard?(e.nonce.showError&&(e.nonce.isCCNValid||(t[s.FormFields.CreditCardNumber]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCodeValid||(t[s.FormFields.CreditCardCode]=l.InputErrorState[l.InputErrorState.Invalid]),e.nonce.isCCExpValid||(t[s.FormFields.CreditCardExpDate]=l.InputErrorState[l.InputErrorState.Invalid])),e.cpf.showError&&(t[s.FormFields.Cpf]=l.InputErrorState[e.cpf.errorState]),e.name.showError&&(t[s.FormFields.CardholderName]=l.InputErrorState[e.name.errorState]),e.address.showError&&(t[s.FormFields.Address]=l.InputErrorState[e.address.errorState]),e.city.showError&&(t[s.FormFields.City]=l.InputErrorState[e.city.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.DirectDeposit?(e.mandateSigned.showError&&(t[s.FormFields.SepaMandateSigned]=l.InputErrorState[e.mandateSigned.errorState]),e.accountHolderName.showError&&(t[s.FormFields.SepaAccountHolderName]=l.InputErrorState[e.accountHolderName.errorState]),e.iban.showError&&(t[s.FormFields.Iban]=l.InputErrorState[e.iban.errorState])):e.paymentMethod.formattedValue===n.PaymentMethod.Ideal&&e.idealBankId.showError&&(t[s.FormFields.IdealBankId]=l.InputErrorState[e.idealBankId.errorState]),t},e.prototype.getFormSubmitEventDetails=function(e,t,r){var a;switch(e){case u.SubmitFormTriggerType.ButtonClick:a=s.FormSubmitTrigger.ButtonClick,this.originSubmitSeq=r;break;case u.SubmitFormTriggerType.RecaptchaV2:a=this.captchaVisibilityChecker.wasLastCaptchaSubmitVisible?s.FormSubmitTrigger.ShownCaptcha:s.FormSubmitTrigger.SuppressedCaptcha;break;case u.SubmitFormTriggerType.ThreeDsFingerprint:a=s.FormSubmitTrigger.ThreeDsFingerprint;break;case u.SubmitFormTriggerType.ThreeDsChallenge:a=s.FormSubmitTrigger.ThreeDsChallenge;break;default:a=s.FormSubmitTrigger.Unknown}var o={origin_submit_seq:this.originSubmitSeq.toString(),submit_seq:r.toString(),trigger:a};return a===s.FormSubmitTrigger.ButtonClick&&(o[s.FormFields.CountryCode]=t.countryCode.rawValue,o[s.FormFields.PaymentMethod]=n.PaymentMethod[t.paymentMethod.rawValue],t.paymentMethod.rawValue===n.PaymentMethod.CreditCard&&(o.bin=t.bin.rawValue)),o},e})();t.PaymentsUXLogger=d})),define("modules/clean/logging/hive/schemas/web-payments_ux_analytics",["require","exports","tslib","modules/core/browser"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importStar(a),(function(e){e.PageView="page_view",e.FormFieldChange="form_field_change",e.FormValidationError="form_validation_error",e.FormSubmit="form_submit",e.ChallengeStart="challenge_start",e.ChallengeSubmit="challenge_submit",e.FormSubmitSuccess="form_submit_success",e.OpenSurvey="open_survey",e.CancelSurvey="cancel_survey",e.SubmitSurvey="submit_survey"})(t.PaymentsUXEvent||(t.PaymentsUXEvent={})),(function(e){e.Address="address",e.CardholderName="name",e.City="city",e.CountryCode="country_code",e.Cpf="cpf",e.CreditCardCode="cc_code",e.CreditCardExpDate="cc_exp_date",e.CreditCardNumber="cc_number",e.Iban="iban",e.IdealBankId="bank_id",e.PaymentMethod="payment_method",e.SepaAccountHolderName="owner_name",e.SepaMandateSigned="mandate_signed",e.Vat="vat",e.ZipCode="zip_code"})(t.FormFields||(t.FormFields={})),(function(e){e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint"})(t.ChallengeType||(t.ChallengeType={})),(function(e){e.ButtonClick="button_click",e.SuppressedCaptcha="suppressed_captcha",e.ShownCaptcha="shown_captcha",e.ThreeDsChallenge="three_ds_challenge",e.ThreeDsFingerprint="three_ds_fingerprint",e.Unknown="unknown"})(t.FormSubmitTrigger||(t.FormSubmitTrigger={})),(function(e){e.Legacy="legacy",e.RevenueAPI="revenue_api"})(t.PaymentsUxPlatform||(t.PaymentsUxPlatform={}));var n=function(e){this.category="web-payments_ux_analytics",this.session_id=null,this.user_id=null,this.team_id=null,this.anon_ip=null,this.country=null,this.locale_user_selected=null,this.locale_browser_header=null,this.user_agent=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_os_name=null,this.ua_os_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.event_name=e.event_name,this.event_details=e.event_details,this.url=a.get_href(),this.request_id=e.request_id,this.request_seq=e.request_seq,this.action_seq=e.action_seq,this.platform=e.platform,Object.seal(this)};t.PaymentsUXAnalyticsRow=n})),define("modules/clean/payments/skus/subscription_change_plan_set",["require","exports","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this._subChangePlans=e}return e.deserialize=function(t){return new e(t.map(a.SubscriptionChangePlan.deserialize))},Object.defineProperty(e.prototype,"plans",{get:function(){return this._subChangePlans.slice()},enumerable:!0,configurable:!0}),e.prototype.filter=function(t){return new e(this._subChangePlans.filter(t))},e.prototype.withProductPlanType=function(e){return this.filter((function(t){var r=t.finalSubState.plan;return!!r&&r.productType===e}))},e.prototype.withSchedule=function(e){return this.filter((function(t){var r=t.finalSubState.billingSchedule;return!!r&&r.id===e}))},e.prototype.withSku=function(e){return this.filter((function(t){return t.finalSubState.plan===e}))},e.prototype.monthly=function(){return this.withSchedule(r.ScheduleId.MONTHLY)},e.prototype.yearly=function(){return this.withSchedule(r.ScheduleId.YEARLY)},e})();t.SubscriptionChangePlanSet=n}));var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/payments/common/form/middleware/middleware",["require","exports","modules/core/browser","modules/core/notify","modules/clean/marketing_tracker"],(function(e,t,r,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitFormErrorMiddleware=function(t){return function(t){return function(n){if("SubmitFormError"!==n.type)return t(n);var o=t(n);return n.data.error_message&&a.Notify.error(n.data.error_message),n.data.redirect&&r.redirect(n.data.redirect),"payment_system_down_error"===n.data.error_type&&new Promise((function(t,r){e(["modules/clean/react/payments/checkout/components/payment_down_error_modal"],t,r)})).then(__importStar).then((function(e){e.PaymentDownErrorModalView.showInstance({isTrial:n.data.is_trial})})),o}}},t.marketingEventMiddleware=function(e){return function(t){return function(r){var a=r.additionalData;switch(r.type){case"SubmitFormStart":if(!a||!a.is_pro_buy_form)return t(r);var o={event:"conversionDataReady",tealium_event:"conversionDataReady",product:a.product,licenses:1,billing_cycle:a.billing_schedule,purchase_price:a.expected_price_amount,currency:a.currency,type:a.signup_type};n.MarketingTracker.pushWithDefaults(o);break;case"SubmitFormSuccess":var i=e.getState().pageState;if(i&&i.marketingTracker){var s=i.marketingTracker.onSubmitFormSuccess;s&&n.MarketingTracker.pushEvent(s)}}return t(r)}}}})),define("modules/clean/react/payments/common/form/reducers/reducers",["require","exports","tslib","redux","modules/clean/react/payments/common/form_values","modules/clean/payments/skus/constants","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_factory","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,r,a,n,o,i,s,l){"use strict";function u(e){var t=i.fieldsToServerProps[e];return t?function(a){return function(n,o){switch(o.type){case"ShowFormFieldErrors":var i=o;if(n&&!l.FormValueHelper.isValid(n))for(var s=0,u=i.fieldNames;s<u.length;s++){var c=u[s];if(e===c)return r.__assign(r.__assign({},n),{showError:!0})}return n;case"SubmitFormError":var p=o;return p.data instanceof Object&&p.data.hasOwnProperty("error_fields")&&p.data.error_fields.hasOwnProperty(t)?r.__assign(r.__assign({},n),{showError:!0,serverError:p.data.error_fields[t]}):n;default:return a(n,o)}}}:function(e){return e}}function c(e){return function(t,r){return Object.assign({},t,e(t,r))}}function p(e,t){switch(t.type){case"SubmitFormError":var a=t;if(a.data instanceof Object&&a.data.hasOwnProperty("error_fields")&&a.data.error_fields.hasOwnProperty("email")){var o=a.data.error_fields.email,i=void 0;switch(o){case"empty":i=n.EmailErrorState.Empty;break;case"account":case"email-taken":i=n.EmailErrorState.TakenError;break;default:i=e?e.errorState:n.EmailErrorState.Valid}return r.__assign(r.__assign({},e),{showError:!0,serverError:o,errorState:i})}return a.data instanceof Object&&a.data.hasOwnProperty("error_type")&&"capturable_user"===a.data.error_type.toString()?r.__assign(r.__assign({},e),{showError:!1,isCapturable:!0}):e;case"ShowFormFieldErrors":var u=t;if(e&&!l.FormValueHelper.isValid(e))for(var c=0,p=u.fieldNames;c<p.length;c++){if("email"===p[c])return r.__assign(r.__assign({},e),{showError:!0})}return e;case"UpdateEmail":var d=t;return s.FormValueFactory.createEmail(d.value,e||void 0);default:return e||null}}function d(e,t){if(void 0===e&&(e=null),"SubmitFormSuccess"!==t.type)return null;var r=t;return r.data&&r.data.next_url?r.data.next_url:null}function m(e,t){switch(void 0===e&&(e=null),t.type){case"SubmitFormStart":return"submitting";case"SubmitFormSuccess":return"success";case"SubmitFormError":return"error";default:return e}}function h(e,t){return void 0===e&&(e=null),"SubmitFormStart"===t.type&&null!==e?e+1:e}function f(e,t){switch(void 0===e&&(e=!1),t.type){case"SubmitFormStart":return!0;case"SubmitFormSuccess":case"SubmitFormError":return!1;default:return e}}function y(e,t){switch(t.type){case"UpdateCpfName":return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfName(t.value,e.formData.cpfName)})});case"UpdateFirstName":return e.formData.cpfName.manuallyEdited?e:r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(t.value,e.formData.lastName.rawValue,e.pageState.userInfo.displayName)})});case"UpdateLastName":return e.formData.cpfName.manuallyEdited?e:r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{cpfName:s.FormValueFactory.createCpfNamePrefill(e.formData.firstName.rawValue,t.value,e.pageState.userInfo.displayName)})});default:return e}}function _(e,t){switch(t.type){case"SubmitFormError":var a=t,n="";return a.data&&a.data.error_fields&&(n=a.data.error_fields.product_plan_type),r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{productPlanType:r.__assign(r.__assign({},e.formData.productPlanType),{serverError:n,showError:!0})})});case"ShowFormFieldErrors":var i=t;if(e.formData.productPlanType&&!l.FormValueHelper.isValid(e.formData.productPlanType))for(var u=0,c=i.fieldNames;u<c.length;u++){if("productPlanType"===c[u])return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{productPlanType:r.__assign(r.__assign({},e.formData.productPlanType),{showError:!0})})})}return e;case"UpdateProductPlanType":var p=t,d=p.value,m=d===o.ProductPlanType.ADVANCED?e.pageState.advancedMinNumUsers:e.pageState.standardMinNumUsers,h=d===o.ProductPlanType.ADVANCED?e.pageState.advancedMaxNumUsers:e.pageState.standardMaxNumUsers;return void 0!==e.pageState.teamNumUsers&&(m=Math.max(m,e.pageState.teamNumUsers)),r.__assign(r.__assign({},e),{pageState:r.__assign(r.__assign({},e.pageState),{minNumUsers:m,maxNumUsers:h}),formData:r.__assign(r.__assign({},e.formData),{productPlanType:s.FormValueFactory.createProductPlanType(p.value,e.pricingState.subChangePlans,e.formData.productPlanType)})});default:return e}}function g(e,t){switch(t.type){case"SubmitFormError":var a=t,n="";return a.data&&a.data.error_fields&&(n=a.data.error_fields.team_num_users),r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:r.__assign(r.__assign({},e.formData.numberOfUsers),{serverError:n,showError:!0})})});case"ShowFormFieldErrors":var o=t;if(e.formData.numberOfUsers&&!l.FormValueHelper.isValid(e.formData.numberOfUsers))for(var i=0,u=o.fieldNames;i<u.length;i++){if("numberOfUsers"===u[i])return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:r.__assign(r.__assign({},e.formData.numberOfUsers),{showError:!0})})})}return e;case"UpdateNumberOfUsers":var c=t;return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),{numberOfUsers:s.FormValueFactory.createNumberOfUsers(c.value,e.pageState,e.formData.numberOfUsers,e.formData.numberOfUsers.minLicenseLimit,e.formData.emailsToInvite?e.formData.emailsToInvite.rawValue.length:0)})});default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.companySize=u("companySize")((function(e,t){return"UpdateCompanySize"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.email=p,t.emailsToInvite=u("emailsToInvite")((function(e,t){return"UpdateEmailsToInvite"===t.type?s.FormValueFactory.createEmailsToInvite(t.value,e||void 0):e||null})),t.firstName=u("firstName")((function(e,t){return"UpdateFirstName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.lastName=u("lastName")((function(e,t){return"UpdateLastName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.nextUrl=d,t.password=u("password")((function(e,t){return"UpdatePassword"===t.type?s.FormValueFactory.createPassword(t.value,e||void 0):e||null})),t.schedule=u("schedule")((function(e,t){return"UpdateSchedule"===t.type?s.FormValueFactory.createSchedule(t.value,e||void 0):e||null})),t.submitState=m,t.submitSeq=h,t.submitting=f,t.teamName=u("teamName")((function(e,t){return"UpdateTeamName"===t.type?s.FormValueFactory.createInput(t.value,e||void 0):e||null})),t.teamPhone=u("teamPhone")((function(e,t){return"UpdateTeamPhone"===t.type?s.FormValueFactory.createTeamPhone(t.value,e||void 0):e||null})),t.updateCpfName=y,t.updateProductPlanType=_,t.updateNumberOfUsers=g,t.FormReducer=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(r,a){return t(e(r,a),a)}}))})(y,_,g,a.combineReducers({pricingState:function(e,t){return void 0===e&&(e={}),e},pageState:c(a.combineReducers({nextUrl:d,submitState:m,submitting:f,submitSeq:h})),formData:c(a.combineReducers({companySize:t.companySize,email:p,emailsToInvite:t.emailsToInvite,firstName:t.firstName,lastName:t.lastName,password:t.password,schedule:t.schedule,teamName:t.teamName,teamPhone:t.teamPhone}))}))})),define("modules/clean/react/payments/common/payments/reducers/reducers",["require","exports","tslib","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/form_value_factory"],(function(e,t,r,a,n,o){"use strict";function i(e,t){return r.__assign(r.__assign({},e),{formData:r.__assign(r.__assign({},e.formData),t)})}function s(e){var t=a.fieldsToServerProps[e];return t?function(a){return function(o,s){var l=o.formData[e];switch(s.type){case"ShowFormFieldErrors":for(var u=0,c=s.fieldNames;u<c.length;u++){if(c[u]===e&&void 0!==l&&!n.FormValueHelper.isValid(l)){var p={};return p[e]=r.__assign(r.__assign({},l),{showError:!0}),i(o,p)}}return o;case"SubmitFormError":var d=s;if(!d.data||!d.data.error_fields||!d.data.error_fields[t]||void 0===l)return o;var m={};return m[e]=r.__assign(r.__assign({},l),{showError:!0,serverError:d.data.error_fields[t]}),i(o,m);default:return a(o,s)}}}:function(e){return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.updatePaymentMethod=s("paymentMethod")((function(e,t){if("UpdatePaymentMethod"!==t.type&&"UpdateCountryCode"!==t.type)return e;var r=e.formData,a=e.pageState,n="UpdatePaymentMethod"===t.type?t.value:r.paymentMethod.rawValue,s=r.countryCode.formattedValue;return i(e,{paymentMethod:o.FormValueFactory.createPaymentMethod(n,s,a.paymentFormSpec,r.paymentMethod)})})),t.updateCountryCode=s("countryCode")((function(e,t){return"UpdateCountryCode"!==t.type?e:i(e,{countryCode:o.FormValueFactory.createCountryCode(t.value,e.formData.countryCode)})})),t.updateZipCode=s("zipCode")((function(e,t){return"UpdateZipCode"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{zipCode:o.FormValueFactory.createZipCode("UpdateZipCode"===t.type?t.value:e.formData.zipCode.rawValue,e.formData.countryCode.formattedValue,e.pageState.paymentFormSpec,e.formData.zipCode)})})),t.updateVat=s("vat")((function(e,t){return"UpdateVat"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{vat:o.FormValueFactory.createVat("UpdateVat"===t.type?t.value.toUpperCase():e.formData.vat.rawValue,e.formData.countryCode.formattedValue,e.formData.vat)})})),t.updateCpf=s("cpf")((function(e,t){return"UpdateCpf"!==t.type&&"UpdateCountryCode"!==t.type?e:i(e,{cpf:o.FormValueFactory.createCpf("UpdateCpf"===t.type?t.value.toUpperCase():e.formData.cpf.rawValue,e.formData.cpf)})})),t.updatePhone=s("phone")((function(e,t){return"UpdatePhone"!==t.type?e:i(e,{phone:o.FormValueFactory.createPhone(t.value,e.formData.phone)})})),t.updateAddress=s("address")((function(e,t){return"UpdateAddress"!==t.type?e:i(e,{address:o.FormValueFactory.createAddress(t.value,e.formData.address)})})),t.updateName=s("name")((function(e,t){return"UpdateName"!==t.type?e:i(e,{name:o.FormValueFactory.createName(t.value,e.formData.name)})})),t.updateCity=s("city")((function(e,t){return"UpdateCity"!==t.type?e:i(e,{city:o.FormValueFactory.createCity(t.value,e.formData.city)})})),t.updateCpfName=s("cpfName")((function(e,t){return"UpdateCpfName"!==t.type?e:i(e,{cpfName:o.FormValueFactory.createCpfName(t.value,e.formData.cpfName)})})),t.updateNonce=s("nonce")((function(e,t){return"UpdateNonce"!==t.type?e:i(e,{nonce:o.FormValueFactory.createNonce(t.value,t.creditCardIframeFields,e.formData.nonce)})})),t.updatePayPalNonce=s("nonce")((function(e,t){return"UpdatePayPalNonce"!==t.type?e:i(e,{payPalNonce:o.FormValueFactory.createPayPalNonce(t.value,t.email,e.formData.payPalNonce)})})),t.updateAdyenEncryptedCard=s("adyenEncryptedCard")((function(e,t){return"UpdateAdyenEncryptedCard"!==t.type?e:i(e,{adyenEncryptedCard:o.FormValueFactory.createAdyenEncryptedCard(t.value,e.formData.adyenEncryptedCard)})})),t.updateEncryptedCardForNetworkToken=s("encryptedCardForNetworkToken")((function(e,t){return"UpdateEncryptedCardForNetworkToken"!==t.type?e:i(e,{encryptedCardForNetworkToken:o.FormValueFactory.createEncryptedCardForNetworkToken(t.cardType,t.encryptedCard,e.formData.encryptedCardForNetworkToken)})})),t.updateBIN=s("bin")((function(e,t){return"UpdateBIN"!==t.type?e:i(e,{bin:o.FormValueFactory.createBIN(t.value,e.formData.bin)})})),t.updateBrowserInfo=s("browserInfo")((function(e,t){return"UpdateBrowserInfo"!==t.type?e:i(e,{browserInfo:o.FormValueFactory.createBrowserInfo(t.value,e.formData.browserInfo)})})),t.updateThreeDsData=s("threeDsData")((function(e,t){return"UpdateThreeDsData"!==t.type?e:i(e,{threeDsData:o.FormValueFactory.createThreeDsData(t.value)})})),t.updateAccountHolderName=s("accountHolderName")((function(e,t){return"UpdateAccountHolderName"!==t.type?e:i(e,{accountHolderName:o.FormValueFactory.createInput(t.value,e.formData.accountHolderName)})})),t.updateIBAN=s("iban")((function(e,t){return"UpdateIBAN"!==t.type?e:i(e,{iban:o.FormValueFactory.createIBAN(t.value,e.formData.iban)})})),t.updateMandateSigned=s("mandateSigned")((function(e,t){return"UpdateMandateSigned"!==t.type?e:i(e,{mandateSigned:o.FormValueFactory.createCheckbox(t.value,e.formData.mandateSigned)})})),t.updateTermsAndService=s("termsAndService")((function(e,t){return"UpdateTermsAndService"!==t.type?e:i(e,{termsAndService:o.FormValueFactory.createCheckbox(t.value,e.formData.termsAndService)})})),t.updateIdealBank=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(r,a){return t(e(r,a),a)}}))})(s("idealBankId")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankId:o.FormValueFactory.createIdealBankId(t.value.bankId,e.formData.idealBankId)})})),s("idealBankName")((function(e,t){return"UpdateIdealBank"!==t.type?e:i(e,{idealBankName:o.FormValueFactory.createIdealBankName(t.value.bankName,e.formData.idealBankName)})}))),t.PaymentMethodReducers=[t.updateCountryCode,t.updatePaymentMethod,t.updateZipCode,t.updateVat,t.updateCpf,t.updateCpfName,t.updateNonce,t.updateAdyenEncryptedCard,t.updateEncryptedCardForNetworkToken,t.updateBIN,t.updateBrowserInfo,t.updateThreeDsData,t.updateAccountHolderName,t.updateIBAN,t.updateMandateSigned,t.updateIdealBank,t.updateCity,t.updateAddress,t.updatePhone,t.updateName,t.updatePayPalNonce],t.TermsAndServiceReducers=[t.updateTermsAndService]})),define("modules/clean/react/payments/common/payments/state/store_creator",["require","exports","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form_value_factory"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPaymentPricingState=function(e){return{countryCode:a.FormValueFactory.createCountryCode(e.countryCode).formattedValue,countryCodeLoading:void 0,hasCurrencyChanged:!1,hasTaxChangedWithinCountry:!1,loadingPrices:!1,recentLoadEvent:!1,requestToken:-1}},t.createPaymentPageState=function(e){return{paymentFormSpec:new r.PaymentFormSpec(e.serializedPaymentFormSpec),requestId:e.requestId,submitSeq:0,paypalEmail:""}},t.createPaymentFormData=function(e,t,r){var n=e.countryCode,o=e.userInfo,i=e.vat,s=t.paymentFormSpec.default_payment_method_for_country(n);return{city:a.FormValueFactory.createCity(""),phone:a.FormValueFactory.createPhone(""),name:a.FormValueFactory.createName(""),address:a.FormValueFactory.createAddress(""),paymentMethod:a.FormValueFactory.createPaymentMethod(s,n,t.paymentFormSpec),countryCode:a.FormValueFactory.createCountryCode(n),zipCode:a.FormValueFactory.createZipCode("",n,t.paymentFormSpec),vat:a.FormValueFactory.createVat(i||"",n),cpf:a.FormValueFactory.createCpf(""),cpfName:a.FormValueFactory.createCpfNamePrefill("","",o.displayName),nonce:a.FormValueFactory.createNonce(""),payPalNonce:a.FormValueFactory.createPayPalNonce("",""),adyenEncryptedCard:a.FormValueFactory.createAdyenEncryptedCard(""),encryptedCardForNetworkToken:a.FormValueFactory.createEncryptedCardForNetworkToken("",""),bin:a.FormValueFactory.createBIN(""),browserInfo:a.FormValueFactory.createBrowserInfo(""),threeDsData:a.FormValueFactory.createThreeDsData(""),accountHolderName:a.FormValueFactory.createInput(""),iban:a.FormValueFactory.createIBAN(""),mandateSigned:a.FormValueFactory.createCheckbox(!1),termsAndService:a.FormValueFactory.createCheckbox(!1),idealBankId:a.FormValueFactory.createIdealBankId(""),idealBankName:a.FormValueFactory.createIdealBankName("")}}})),define("modules/clean/react/payments/common/pricing/reducers/reducers",["require","exports","tslib","modules/clean/payments/skus/subscription_change_plan_set"],(function(e,t,r,a){"use strict";function n(e,t){if("PrepareToUpdateTransitions"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{loadingPrices:!0,recentLoadEvent:!0});return r.__assign(r.__assign({},e),{pricingState:a})}function o(e,t){if("UpdateRecentLoadEventStatus"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{recentLoadEvent:t.recentLoadEventStatus});return r.__assign(r.__assign({},e),{pricingState:a})}function i(e,t){if("UpdateTransitionsStart"!==t.type)return e;var a=r.__assign(r.__assign({},e.pricingState),{countryCodeLoading:e.formData.countryCode.formattedValue,loadingPrices:!0,recentLoadEvent:!0});return r.__assign(r.__assign({},e),{pricingState:a})}function s(e,t){if("UpdateTransitionsSuccess"!==t.type)return e;var n,o="N/A",i=!1,s=!1;if(t.subChangePlans&&(n=t.subChangePlans,e.pricingState.subChangePlans.plans.length>0)){var l=e.pricingState.subChangePlans.plans[0],u=n[0],c=l.tvm,p=u.tvm,d=c&&c.getCurrency(),m=p&&p.getCurrency();i=(o="N/A"===e.pricingState.originalCurrency?d:e.pricingState.originalCurrency)!==m;var h=l.nextBillingSummary.taxRate,f=h===u.nextBillingSummary.taxRate&&(0===h||d===m);s=e.pricingState.hasTaxChangedWithinCountry||!f,e.pricingState.countryCode!==e.pricingState.countryCodeLoading&&(s=!1)}var y=r.__assign(r.__assign({},e.pricingState),{countryCode:e.pricingState.countryCodeLoading,countryCodeLoading:void 0,hasCurrencyChanged:i,hasTaxChangedWithinCountry:s,loadingPrices:!1,originalCurrency:o,recentLoadEvent:!0,subChangePlans:new a.SubscriptionChangePlanSet(t.subChangePlans),baseSubChangePlans:new a.SubscriptionChangePlanSet(t.subChangePlans)});return r.__assign(r.__assign({},e),{pricingState:y})}Object.defineProperty(t,"__esModule",{value:!0}),t.TransitionManagementReducers=[n,o,i,s],t.prepareToUpdateTransitions=n,t.updateRecentLoadEventStatus=o,t.updateTransitionsStart=i,t.updateTransitionsSuccess=s})),define("modules/clean/react/payments/pro/components/inputs/inputs",["require","exports","tslib","react","react-dom","classnames"],(function(e,t,r,a,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importDefault(n),o=r.__importDefault(o);var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=o.default({input__label:!0,"input__label--before":Boolean(!this.props.labelAfterElement),"input__label--errormodal":Boolean(this.props.errorText)},this.props.className),t=this.props.containerClassName,r=a.default.createElement("label",{className:e,htmlFor:this.props.htmlFor},this.props.labelText),n=null;this.props.labelAfterElement&&(n=r,r=null);var i,s=null;this.props.secondaryLabel&&(s=a.default.createElement("label",{className:"input__label input__label--secondary",htmlFor:this.props.htmlFor},this.props.secondaryLabel)),this.props.errorText&&(i=this.props.errorText);var l=a.default.createElement("label",{className:"input__label--error",htmlFor:this.props.htmlFor},i);return a.default.createElement("div",{className:t},r,this.props.children,n,s,l)},t})(a.default.Component);t.LabeledInput=i;var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(n.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.autocomplete,s=t.className,l=t.disabled,u=t.labelText,c=t.secondaryLabel,p=t.errorText,d=t.hasError,m=t.value,h=t.maxLength,f=t.containerClassName,y=t.placeholder,_=this.props.type||"text",g=o.default({input__text:!0,"input__text--error":Boolean(p)||d},this.props.inputClassName);return a.default.createElement(i,{className:s,containerClassName:f,labelText:u,htmlFor:r,errorText:p,secondaryLabel:c},a.default.createElement("input",{className:g,type:_,autoComplete:n,placeholder:y,name:r,id:r,ref:function(t){e.input=t},value:m,disabled:l,onChange:this.onChange,onBlur:this.onBlur,maxLength:h}))},t})(a.default.Component);t.LabeledTextInput=s;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCheckboxChange=function(e){t.props.onClick&&("click"!==e.type&&"Enter"!==e.key&&13!==e.charCode||(t.props.onClick(n.default.findDOMNode(t.input)),e.preventDefault()))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onClick){var e=n.default.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onClick(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,s=t.containerClassName,l=t.disabled,u=t.labelText,c=t.labelClassName,p=t.errorText,d=t.checked,m=o.default({input__checkbox:!0,"input__checkbox--valid":d,"input__checkbox--disabled":Boolean(l)},n);return a.default.createElement(i,{containerClassName:s,className:c,errorText:p,htmlFor:r,labelAfterElement:!0,labelText:u},a.default.createElement("div",{"aria-labelledby":r,tabIndex:0,role:"checkbox",className:m,onClick:this.handleCheckboxChange,onKeyUp:this.handleCheckboxChange}),a.default.createElement("input",{tabIndex:-1,checked:d,disabled:l,id:r,name:r,ref:function(t){e.input=t},type:"checkbox"}))},t})(a.default.Component);t.LabeledCheckboxInput=l;var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleRadioChange=function(e){t.props.disabled?e.stopPropagation():t.props.onClick&&("click"!==e.type&&"Enter"!==e.key&&13!==e.charCode||(t.props.onClick(e,t.props.name,t.props.value),e.preventDefault()))},t}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,r=t.id,n=t.name,s=t.ariaLabel,l=t.disabled,u=t.value,c=t.checked,p=t.onChange,d=t.labelText,m=t.labelClassName,h=o.default({input__radio:!0,"input__radio--valid":Boolean(c),"input__radio--disabled":Boolean(l)},this.props.className),f=o.default(((e={})[this.props.containerClassName+"--valid"]=!!this.props.containerClassName&&Boolean(c),e),this.props.containerClassName);return a.default.createElement(i,{containerClassName:f,className:m,labelText:d,htmlFor:n,labelAfterElement:!0},a.default.createElement("div",{"aria-label":s||n,role:"radio",tabIndex:0,className:h,onClick:this.handleRadioChange,onKeyUp:this.handleRadioChange}),a.default.createElement("input",{id:r,tabIndex:-1,ref:"radio",type:"radio",name:n,value:u,checked:c,onChange:p,disabled:l}))},t})(a.default.Component);t.LabeledRadioInput=u;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){t.props.onChange&&t.props.onChange(n.default.findDOMNode(t.input))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=n.default.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,r=t.name,n=t.className,s=t.containerClassName,l=t.labelClassName,u=t.labelText,c=t.errorText,p=o.default({input__select:!0},n);return a.default.createElement(i,{containerClassName:s,className:l,errorText:c,htmlFor:r,labelText:u},a.default.createElement("select",{className:p,id:r,name:r,onChange:this.onChange,value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(a.default.Component);t.LabeledSelectInput=c;var p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:this.props.className},this.props.children,this.props.errors&&this.props.errors.map((function(e){return a.default.createElement("div",{className:e.className},a.default.createElement("label",{className:"input__label--error",htmlFor:e.name},e.text))})))},t})(a.default.Component);t.LabeledInputRow=p}));
//# sourceMappingURL=pkg-purchase-form.min.js-vflUjGBxg.map